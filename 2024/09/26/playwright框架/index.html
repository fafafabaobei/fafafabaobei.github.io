<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Playwright框架 | fafafabaobei</title><meta name="author" content="fafafa"><meta name="copyright" content="fafafa"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="框架介绍和安装Playwright是一个开源的自动化库，由Microsoft开发，用于自动化基于Chromium，Firefox，和WebKit的浏览器。它支持多种语言，包括Python，并能在Windows,Linux,和macos上运行。支持同步和异步执行。 playwright 与 selenium 区别 selenium WebDriver 的底层实现是通过调用浏览器驱动程序与浏览器交互来">
<meta property="og:type" content="article">
<meta property="og:title" content="Playwright框架">
<meta property="og:url" content="https://fafafabaobei.github.io/2024/09/26/playwright%E6%A1%86%E6%9E%B6/index.html">
<meta property="og:site_name" content="fafafabaobei">
<meta property="og:description" content="框架介绍和安装Playwright是一个开源的自动化库，由Microsoft开发，用于自动化基于Chromium，Firefox，和WebKit的浏览器。它支持多种语言，包括Python，并能在Windows,Linux,和macos上运行。支持同步和异步执行。 playwright 与 selenium 区别 selenium WebDriver 的底层实现是通过调用浏览器驱动程序与浏览器交互来">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg">
<meta property="article:published_time" content="2024-09-26T14:29:59.000Z">
<meta property="article:modified_time" content="2024-09-26T14:29:59.000Z">
<meta property="article:author" content="fafafa">
<meta property="article:tag" content="自动化测试">
<meta property="article:tag" content="playwright">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg"><link rel="shortcut icon" href="/img/blog.png"><link rel="canonical" href="https://fafafabaobei.github.io/2024/09/26/playwright%E6%A1%86%E6%9E%B6/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><link rel="stylesheet" href="/css/index.css?v=4.14.0-b3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.35/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>(()=>{
      const saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
      
      window.btf = {
        saveToLocal: saveToLocal,
        getScript: (url, attr = {}) => new Promise((resolve, reject) => {
          const script = document.createElement('script')
          script.src = url
          script.async = true
          script.onerror = reject
          script.onload = script.onreadystatechange = function() {
            const loadState = this.readyState
            if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
            script.onload = script.onreadystatechange = null
            resolve()
          }

          Object.keys(attr).forEach(key => {
            script.setAttribute(key, attr[key])
          })

          document.head.appendChild(script)
        }),

        getCSS: (url, id = false) => new Promise((resolve, reject) => {
          const link = document.createElement('link')
          link.rel = 'stylesheet'
          link.href = url
          if (id) link.id = id
          link.onerror = reject
          link.onload = link.onreadystatechange = function() {
            const loadState = this.readyState
            if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
            link.onload = link.onreadystatechange = null
            resolve()
          }
          document.head.appendChild(link)
        }),

        addGlobalFn: (key, fn, name = false, parent = window) => {
          const pjaxEnable = false
          if (!pjaxEnable && key.startsWith('pjax')) return

          const globalFn = parent.globalFn || {}
          const keyObj = globalFn[key] || {}
    
          if (name && keyObj[name]) return
    
          name = name || Object.keys(keyObj).length
          keyObj[name] = fn
          globalFn[key] = keyObj
          parent.globalFn = globalFn
        }
      }
    
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode
      
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })()</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":true,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Playwright框架',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2024-09-26 22:29:59'
}</script><meta name="generator" content="Hexo 7.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    btf.addGlobalFn('pjaxSend', () => { preloader.initLoading() }, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', () => { preloader.endLoading() }, 'preloader_end')
  }
})()</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/fafafa.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">56</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">47</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 其他</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg')"><nav id="nav"><span id="blog-info"><a href="/" title="fafafabaobei"><img class="site-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/blog.png" alt="Logo"/><span class="site-name">fafafabaobei</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 其他</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Playwright框架<a class="post-edit-link" href="null_posts/playwright框架.md" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2024-09-26T14:29:59.000Z" title="发表于 2024-09-26 22:29:59">2024-09-26</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2024-09-26T14:29:59.000Z" title="更新于 2024-09-26 22:29:59">2024-09-26</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B5%8B%E8%AF%95/">测试</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95-python/">自动化测试_python</a><i class="fas fa-angle-right post-meta-separator"></i><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/%E6%B5%8B%E8%AF%95/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95-python/playwright/">playwright</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">14.1k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>56分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Playwright框架"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h3 id="框架介绍和安装"><a href="#框架介绍和安装" class="headerlink" title="框架介绍和安装"></a>框架介绍和安装</h3><p>Playwright是一个开源的自动化库，由Microsoft开发，用于自动化基于Chromium，Firefox，和WebKit的浏览器。它支持多种语言，包括Python，并能在Windows,Linux,和macos上运行。<br>支持同步和异步执行。</p>
<h4 id="playwright-与-selenium-区别"><a href="#playwright-与-selenium-区别" class="headerlink" title="playwright 与 selenium 区别"></a>playwright 与 selenium 区别</h4><ul>
<li><p>selenium</p>
<p>WebDriver 的底层实现是通过调用浏览器驱动程序与浏览器交互来实现的。具体来说，下面是 WebDriver 底层实现的一般步骤：</p>
<ol>
<li>用户编写测试脚本或代码，调用 Selenium 提供的 API。</li>
<li>测试脚本通过 Selenium 提供的 WebDriver API（如 <code>find_element_by_xpath()</code>、<code>click()</code>、<code>send_keys()</code> 等）发送命令。</li>
<li>WebDriver 接收到命令后，根据命令的内容，调用相应的浏览器驱动程序。</li>
<li>浏览器驱动程序将命令转换为对应浏览器支持的实际操作，如打开网页、定位元素、模拟用户输入等。</li>
<li>浏览器驱动程序通过浏览器提供的接口来与浏览器进行通信，在浏览器中执行相应的操作。</li>
<li>浏览器执行完操作后，将结果返回给 WebDriver。</li>
<li>WebDriver 将结果返回给测试脚本，测试脚本根据返回的结果进行进一步操作或断言。</li>
</ol>
<p>流程： python代码调用selenium - webdriver - 浏览器驱动控制浏览器 - 信息返回给webdriver - 返回给python代码</p>
</li>
<li><p>playwright</p>
<p>Playwright 的底层实现是通过对不同浏览器的原生 API 进行封装和封装，并通过自定义协议与浏览器通信来实现。playwright是直接操作浏览器，所以playwright会比selenium快<br>!!!playwright自带有驱动，本机可以不用下载浏览器</p>
<ol>
<li>启动浏览器实例：<ul>
<li>首先，通过 Playwright 提供的 API 创建并启动所需浏览器实例，例如 Chromium、Firefox 或 WebKit。</li>
</ul>
</li>
<li>发送指令与浏览器交互：<ul>
<li>使用 Playwright 提供的方法，向浏览器发送指令以执行测试脚本中的操作，例如打开链接、定位元素、模拟用户行为等。</li>
</ul>
</li>
<li>执行测试脚本：<ul>
<li>通过浏览器实例执行测试脚本，执行操作并获取结果，例如页面元素状态、网络请求信息等。</li>
</ul>
</li>
<li>关闭浏览器实例：<ul>
<li>当测试脚本执行完成后，通过 Playwright 提供的 API 关闭浏览器实例，释放资源。</li>
</ul>
</li>
</ol>
</li>
</ul>
<h4 id="环境安装"><a href="#环境安装" class="headerlink" title="环境安装"></a>环境安装</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ pip install playwright</span><br></pre></td></tr></table></figure>

<h4 id="playwright自带浏览器驱动安装"><a href="#playwright自带浏览器驱动安装" class="headerlink" title="playwright自带浏览器驱动安装"></a>playwright自带浏览器驱动安装</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 安装 firefox、webkit、chromium</span></span><br><span class="line">playwright install</span><br><span class="line"></span><br><span class="line"><span class="comment"># 单独安装</span></span><br><span class="line">	<span class="comment"># firefox</span></span><br><span class="line">playwright install firefox</span><br><span class="line">	<span class="comment"># webkit</span></span><br><span class="line">playwright install webkit</span><br><span class="line">	<span class="comment"># chromium</span></span><br><span class="line">playwright install chromium</span><br></pre></td></tr></table></figure>



<h4 id="脚本录制功能"><a href="#脚本录制功能" class="headerlink" title="脚本录制功能"></a>脚本录制功能</h4><h5 id="启用录制工具命令"><a href="#启用录制工具命令" class="headerlink" title="启用录制工具命令"></a>启用录制工具命令</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">$ playwright codegen</span><br></pre></td></tr></table></figure>





<h4 id="使用内置支持浏览器类型"><a href="#使用内置支持浏览器类型" class="headerlink" title="使用内置支持浏览器类型"></a>使用内置支持浏览器类型</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用firefox</span></span><br><span class="line"><span class="keyword">with</span> sync_playwright() <span class="keyword">as</span> p:</span><br><span class="line">    firefox_browser = p.firefox</span><br><span class="line"><span class="comment"># 使用webkit</span></span><br><span class="line"><span class="keyword">with</span> sync_playwright() <span class="keyword">as</span> p:</span><br><span class="line">    webkit_browser = p.webkit</span><br><span class="line"><span class="comment"># 使用chromium</span></span><br><span class="line"><span class="keyword">with</span> sync_playwright() <span class="keyword">as</span> p:</span><br><span class="line">    chromium_browser = p.chromium</span><br></pre></td></tr></table></figure>

<h4 id="使用方法-本地执行"><a href="#使用方法-本地执行" class="headerlink" title="使用方法 - 本地执行"></a>使用方法 - 本地执行</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 同步api</span></span><br><span class="line"><span class="comment"># 创建一个playwright上下文管理器</span></span><br><span class="line"><span class="keyword">from</span> playwright.sync_api <span class="keyword">import</span> sync_playwright</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;上下文方式&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">with</span> sync_playwright() <span class="keyword">as</span> p:</span><br><span class="line">    <span class="comment"># 启动浏览器并启动</span></span><br><span class="line">    browser = p.chromium.launch(headless=<span class="literal">False</span>)</span><br><span class="line">    <span class="comment"># 创建浏览器的上下文</span></span><br><span class="line">    context = browser.new_context()</span><br><span class="line">    <span class="comment"># 创建一个页面</span></span><br><span class="line">    page = context.new_page()</span><br><span class="line">    <span class="comment"># or 使用browser创建</span></span><br><span class="line">    page = browser.new_page()</span><br><span class="line">    <span class="comment"># 打开页面</span></span><br><span class="line">    page.goto(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line">    browser.close()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提供异步api</span></span><br><span class="line"><span class="keyword">from</span> playwright.async_api <span class="keyword">import</span> async_playwright</span><br><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> sync_playwright() <span class="keyword">as</span> p:</span><br><span class="line">        <span class="comment"># 启动浏览器</span></span><br><span class="line">        browser = p.chromium.launch(headless=<span class="literal">False</span>)</span><br><span class="line">        <span class="comment"># 创建浏览器的上下文</span></span><br><span class="line">        context = browser.new_context()</span><br><span class="line">        <span class="comment"># 创建一个页面</span></span><br><span class="line">        page = context.new_page()</span><br><span class="line">        <span class="comment"># 打开页面</span></span><br><span class="line">        page.goto(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line">        browser.close()</span><br><span class="line"></span><br><span class="line">asyncio.run(main())</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;不用上下文方式的同步写法&#x27;&#x27;&#x27;</span></span><br><span class="line">p = sync_playwright().start()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">sync_playwright()方法返回一个 Playwright 对象，表示同步 API 的入口。</span></span><br><span class="line"><span class="string">start()方法用于启动 Playwright，并返回一个 Playwright 对象，该对象可以用于启动不同类型的浏览器。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 启动浏览器</span></span><br><span class="line">browser = p.chromium.launch(headless=<span class="literal">False</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">p.chromium 表示使用 Chromium 浏览器。</span></span><br><span class="line"><span class="string">launch(headless=False) 方法启动一个 Chromium 浏览器实例，其中 headless=False 表示以有界面的方式启动浏览器，如果要以无界面方式启动，可以将 headless=True。</span></span><br><span class="line"><span class="string">返回一个 Browser 对象，表示一个浏览器实例。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 创建浏览器的上下文</span></span><br><span class="line">context = browser.new_context()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">browser.new_context() 方法在创建一个新的浏览器上下文，上下文包含页面集合、网络请求拦截器等。一个浏览器可以包含多个上下文。</span></span><br><span class="line"><span class="string">返回一个 BrowserContext 对象，表示浏览器上下文。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 创建一个页面</span></span><br><span class="line">page = context.new_page()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">context.new_page() 方法在当前上下文中创建一个新的页面。</span></span><br><span class="line"><span class="string">返回一个 Page 对象，表示新创建的页面。可以在这个页面中进行网页操作和页面交互。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 打开页面</span></span><br><span class="line">page.goto(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line"><span class="comment"># 需要自行终止程序</span></span><br><span class="line"><span class="comment"># 用于关闭单个页面，释放页面占用的资源</span></span><br><span class="line">page.close()</span><br><span class="line"><span class="comment"># 用于关闭浏览器上下文，关闭上下文将关闭其中的所有页面并释放上下文占用的资源。</span></span><br><span class="line">context.close()</span><br><span class="line"><span class="comment"># 用于关闭整个浏览器实例，关闭浏览器将关闭包含的所有上下文和页面，并释放浏览器占用的资源。</span></span><br><span class="line">browser.close()</span><br><span class="line"></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h4 id="远程执行"><a href="#远程执行" class="headerlink" title="远程执行"></a>远程执行</h4><p><code>connect(options)</code>: 在远程计算机上连接浏览器实例</p>
<blockquote>
<p>在远程计算机上安装Playwright，并通过终端命令 <code>npx playwright serve --port=8585</code> 启动Playwright Server。<br>在本地计算机上可以通过以下方式连接到远程浏览器实例</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> playwright.sync_api <span class="keyword">as</span> p  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建浏览器对象并连接到远程浏览器实例</span></span><br><span class="line">browser = p.chromium.connect(&#123;  </span><br><span class="line">    <span class="string">&quot;wsEndpoint&quot;</span>: <span class="string">&quot;ws://[远程计算机IP]:8585&quot;</span>,  </span><br><span class="line">&#125;)  </span><br><span class="line"><span class="comment"># 创建一个新的页面  </span></span><br><span class="line">page = browser.new_page()  </span><br><span class="line"><span class="comment"># 在新页面加载并展示百度网站  </span></span><br><span class="line">page.goto(<span class="string">&quot;https://www.baidu.com&quot;</span>)  </span><br><span class="line"><span class="comment"># 关闭浏览器  </span></span><br><span class="line">browser.close() </span><br></pre></td></tr></table></figure>



<h4 id="等待-且注意事项"><a href="#等待-且注意事项" class="headerlink" title="等待 - 且注意事项"></a>等待 - 且注意事项</h4><blockquote>
<p>由于Playwright底层是基于异步实现的，使用time.sleep()会导致代码阻塞，而Playwright的操作可能会在时间等待期间进行异步操作，这样就会导致程序出现错误或不可预测的行为。会导致出错</p>
</blockquote>
<h5 id="强制等待-page-wait-for-timeout-1000-单位：ms"><a href="#强制等待-page-wait-for-timeout-1000-单位：ms" class="headerlink" title="强制等待 - page.wait_for_timeout(1000)  - 单位：ms"></a>强制等待 - <code>page.wait_for_timeout(1000)</code>  - 单位：ms</h5><p>如果要使用强制等待可以使用这个代替</p>
<h5 id="page-wait-for-selector-selector-options"><a href="#page-wait-for-selector-selector-options" class="headerlink" title="page.wait_for_selector(selector, options?)"></a><code>page.wait_for_selector(selector, options?)</code></h5><ul>
<li><p>参数</p>
<ul>
<li>options - [“attached”, “detached”, “hidden”, “visible”]  默认visible</li>
</ul>
</li>
<li><p>等待指定选择器匹配的元素出现在页面上</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.wait_for_selector(<span class="string">&#x27;#myElement&#x27;</span>)  </span><br></pre></td></tr></table></figure>

<ul>
<li>等待元素消失</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.wait_for_selector(<span class="string">&#x27;#myElement&#x27;</span>, state=<span class="string">&#x27;hidden&#x27;</span>)  </span><br></pre></td></tr></table></figure>

<h5 id="wait-for-function-page-function"><a href="#wait-for-function-page-function" class="headerlink" title=" wait_for_function(page_function)"></a><code> wait_for_function(page_function)</code></h5><p>等待js函数返回ture</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.wait_for_function(<span class="string">&#x27;document.querySelector(&quot;#myElement&quot;).textContent === &quot;Hello&quot;&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="wait-for-event-target-event"><a href="#wait-for-event-target-event" class="headerlink" title=" wait_for_event(target, event)"></a><code> wait_for_event(target, event)</code></h5><p>等待指定事件在目标对象上触发。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.wait_for_event(<span class="string">&#x27;domcontentloaded&#x27;</span>) </span><br></pre></td></tr></table></figure>

<h5 id="wait-for-navigation"><a href="#wait-for-navigation" class="headerlink" title="wait_for_navigation()"></a><code>wait_for_navigation()</code></h5><p>等待页面导航完成（例如页面加载或页面跳转）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.wait_for_navigation(state, timeout) </span><br></pre></td></tr></table></figure>

<h5 id="page-wait-for-load-state-load"><a href="#page-wait-for-load-state-load" class="headerlink" title="page.wait_for_load_state(&quot;load&quot;) "></a><code>page.wait_for_load_state(&quot;load&quot;) </code></h5><p>page对象的方法，用于等待页面加载到指定状态</p>
<ul>
<li>参数<ul>
<li>state<ul>
<li>domcontentloaded - 等到加载DOMContentLoaded事件</li>
<li>load - 等到加载load事件</li>
<li>networkidle - 等到500 ms没有网络请求交互</li>
</ul>
</li>
<li>timeout</li>
</ul>
</li>
</ul>
<h5 id="wait-for-request-url-or-predicate"><a href="#wait-for-request-url-or-predicate" class="headerlink" title="wait_for_request(url_or_predicate)"></a><code>wait_for_request(url_or_predicate)</code></h5><p>等待一个网络请求触发，并匹配给定的 URL 或谓词函数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.wait_for_request(<span class="string">&#x27;https://example.com/data.json&#x27;</span>)  </span><br></pre></td></tr></table></figure>

<h5 id="wait-for-response-url-or-predicate"><a href="#wait-for-response-url-or-predicate" class="headerlink" title="wait_for_response(url_or_predicate)"></a><code>wait_for_response(url_or_predicate)</code></h5><p>等待一个网络响应返回，并匹配给定的 URL 或谓词函数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.wait_for_response(<span class="string">&#x27;https://example.com/data.json&#x27;</span>)  </span><br></pre></td></tr></table></figure>

<h5 id="wait-for-url"><a href="#wait-for-url" class="headerlink" title="wait_for_url()"></a>wait_for_url()</h5><p>等待页面跳转某个url</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.wait_for_url(<span class="string">&#x27;https://www.baidu.com&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="locator-waitFor"><a href="#locator-waitFor" class="headerlink" title="locator().waitFor()"></a>locator().waitFor()</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 等待元素消失</span></span><br><span class="line">page.locator(<span class="string">&#x27;#my-id&#x27;</span>).waitFor(&#123; state: <span class="string">&#x27;detached&#x27;</span> &#125;)</span><br><span class="line"><span class="comment"># 等待元素隐藏</span></span><br><span class="line">page.locator(<span class="string">&#x27;#my-id&#x27;</span>).waitFor(&#123; state: <span class="string">&#x27;hidden&#x27;</span> &#125;)</span><br><span class="line"><span class="comment"># 等待元素显示</span></span><br><span class="line">page.locator(<span class="string">&#x27;#my-id&#x27;</span>).waitFor(&#123; state: <span class="string">&#x27;visible&#x27;</span> &#125;)</span><br><span class="line"><span class="comment"># 等待元素可编辑</span></span><br><span class="line">page.locator(<span class="string">&#x27;#my-id&#x27;</span>).waitFor(&#123; state: <span class="string">&#x27;editable&#x27;</span> &#125;)</span><br><span class="line"><span class="comment"># 等待元素被选中</span></span><br><span class="line">page.locator(<span class="string">&#x27;#my-id&#x27;</span>).waitFor(&#123; state: <span class="string">&#x27;checked&#x27;</span> &#125;)</span><br><span class="line"></span><br></pre></td></tr></table></figure>




<h4 id="Browser-浏览器对象"><a href="#Browser-浏览器对象" class="headerlink" title="Browser(浏览器对象)"></a>Browser(浏览器对象)</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> playwright.sync_api <span class="keyword">import</span> sync_playwright</span><br><span class="line"></span><br><span class="line">p = sync_playwright().start()</span><br><span class="line"><span class="comment"># 生成浏览器对象并执行</span></span><br><span class="line">browser = p.chromium.launch(headless=<span class="literal">False</span>)</span><br></pre></td></tr></table></figure>

<h5 id="创建浏览器上下文-browser-new-context"><a href="#创建浏览器上下文-browser-new-context" class="headerlink" title="创建浏览器上下文 - browser.new_context()"></a>创建浏览器上下文 - browser.new_context()</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建上下文</span></span><br><span class="line"><span class="comment"># 创建一个新的浏览器上下文。它不会与其他浏览器上下文共享 Cookie/缓存。</span></span><br><span class="line">context = browser.new_context()</span><br></pre></td></tr></table></figure>

<h5 id="获取所有浏览器上下文对象-browser-contexts"><a href="#获取所有浏览器上下文对象-browser-contexts" class="headerlink" title="获取所有浏览器上下文对象 - browser.contexts"></a>获取所有浏览器上下文对象 - browser.contexts</h5>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取浏览器所有上下文对象，列表形式展示</span></span><br><span class="line">contexts = browser.contexts</span><br></pre></td></tr></table></figure>

<h5 id="创建页面实例-browser-new-page"><a href="#创建页面实例-browser-new-page" class="headerlink" title="创建页面实例 - browser.new_page()"></a>创建页面实例 - browser.new_page()</h5>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建页面，这里会弹出页面窗口</span></span><br><span class="line">page = browser.new_page()</span><br></pre></td></tr></table></figure>

<h5 id="获取浏览器所属的浏览器类型-browser-browser-type"><a href="#获取浏览器所属的浏览器类型-browser-browser-type" class="headerlink" title="获取浏览器所属的浏览器类型 - browser.browser_type"></a>获取浏览器所属的浏览器类型 - browser.browser_type</h5>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取浏览器上下文对象类型 - BrowserType 对象</span></span><br><span class="line">bType = browser.browser_type</span><br><span class="line"><span class="comment"># 也可以通过 p.chromium、p.firefox、p.webkit 等方式来获取对应的 BrowserType 对象。</span></span><br></pre></td></tr></table></figure>

<ul>
<li><p>额外方法</p>
<ul>
<li><p>方法：</p>
<ul>
<li><p><code>launch(options)</code>: 通过指定的选项启动一个指定类型的浏览器实例。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 根据 BrowserType 对象 启动一个新的想通浏览器实例  </span></span><br><span class="line">new_browser = chromium_browser_type.launch(headless=<span class="literal">False</span>)  </span><br></pre></td></tr></table></figure>
</li>
<li><p><code>connect(options)</code>: 连接到一个远程浏览器实例，可以在不同的计算机上控制同一个浏览器实例。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取 Chromium 浏览器类型对象  </span></span><br><span class="line">chromium_browser_type = p.chromium  </span><br><span class="line"><span class="comment"># 连接到一个远程 Chromium 浏览器实例  </span></span><br><span class="line">browser = chromium_browser_type.connect(&#123;  </span><br><span class="line">    <span class="string">&quot;wsEndpoint&quot;</span>: <span class="string">&quot;ws://[远程计算机IP]:8585&quot;</span>,  </span><br><span class="line">&#125;)  </span><br><span class="line"><span class="comment"># 创建一个新的页面  </span></span><br><span class="line">page = browser.new_page()  </span><br><span class="line"><span class="comment"># 在新页面加载并展示百度网站  </span></span><br><span class="line">page.goto(<span class="string">&quot;https://www.baidu.com&quot;</span>)  </span><br><span class="line"><span class="comment"># 关闭浏览器  </span></span><br><span class="line">browser.close()  </span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
</li>
</ul>
<h5 id="判断浏览器对象是否连接-browser-is-connected"><a href="#判断浏览器对象是否连接-browser-is-connected" class="headerlink" title="判断浏览器对象是否连接 - browser.is_connected()"></a>判断浏览器对象是否连接 - browser.is_connected()</h5>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 用于检查浏览器实例是否连接到 Playwright 服务器</span></span><br><span class="line"><span class="comment"># 检查浏览器实例是否连接到 Playwright 服务器  </span></span><br><span class="line">connected = browser.is_connected()  </span><br><span class="line"><span class="keyword">if</span> connected:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Browser is connected to Playwright server.&quot;</span>)  </span><br><span class="line"><span class="keyword">else</span>:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Browser is not connected to Playwright server.&quot;</span>)  </span><br></pre></td></tr></table></figure>

<h5 id="客户端调试协议（CDP）会话-browser-new-browser-cdp-session"><a href="#客户端调试协议（CDP）会话-browser-new-browser-cdp-session" class="headerlink" title="客户端调试协议（CDP）会话 - browser.new_browser_cdp_session()"></a>客户端调试协议（CDP）会话 - browser.new_browser_cdp_session()</h5><blockquote>
<p>用于创建一个与浏览器实例关联的新的浏览器客户端调试协议（CDP）会话, 返回CDPsession实例</p>
</blockquote>
<p>  CDP（Chrome DevTools Protocol）会话在 Playwright 中的作用主要体现在以下几个方面：</p>
<ol>
<li><strong>执行高级的浏览器操作</strong>：通过 CDP 会话，您可以执行一些高级的浏览器操作，比如模拟用户输入、网络请求拦截、执行 JavaScript 等操作。这些高级操作通常是通过 CDP 提供的接口实现的，可以实现更灵活和定制化的功能。</li>
<li><strong>调试浏览器</strong>：CDP 会话可以用于调试浏览器，包括检查 DOM 结构、网络请求、性能指标等。您可以通过 CDP 会话与浏览器进行交互，查看浏览器的内部状态。</li>
<li><strong>监控浏览器性能</strong>：通过 CDP 会话，您可以监控浏览器的性能指标，如内存占用、CPU 使用率、页面加载时间等。这对于性能优化和调试非常有帮助。</li>
</ol>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> playwright.sync_api <span class="keyword">as</span> p  </span><br><span class="line"><span class="comment"># 启动一个本地 Chrome 浏览器实例  </span></span><br><span class="line">browser = p.chromium.launch()  </span><br><span class="line"><span class="comment"># 创建一个与浏览器实例关联的新的浏览器 CDP 会话  </span></span><br><span class="line">browser_cdp_session = browser.new_browser_cdp_session()  </span><br><span class="line"><span class="comment"># 通过 CDP 会话执行一些高级的浏览器操作  </span></span><br><span class="line">browser_cdp_session.send(<span class="string">&#x27;Runtime.evaluate&#x27;</span>, &#123;<span class="string">&#x27;expression&#x27;</span>: <span class="string">&#x27;console.log(&quot;Hello from CDP&quot;)&#x27;</span>&#125;)  </span><br><span class="line"><span class="comment"># 关闭 CDP 会话  </span></span><br><span class="line">browser_cdp_session.close()  </span><br><span class="line"><span class="comment"># 关闭浏览器  </span></span><br><span class="line">browser.close()</span><br></pre></td></tr></table></figure>

<h5 id="事件监听-browser-on"><a href="#事件监听-browser-on" class="headerlink" title="事件监听 - browser.on()"></a>事件监听 - browser.on()</h5><p>  绑定监听器，给浏览器对象操作绑定一个函数，当操作执行时会被监听到，触发该函数</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义事件处理函数  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_broswer_closed</span>():  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Browser is closed.&quot;</span>)  </span><br><span class="line"><span class="comment"># 启动一个本地 Chrome 浏览器实例  </span></span><br><span class="line">browser = p.chromium.launch()  </span><br><span class="line"><span class="comment"># 注册 close 事件监听器  </span></span><br><span class="line">browser.on(<span class="string">&quot;disconnected&quot;</span>, on_broswer_closed)  </span><br><span class="line"><span class="comment"># 关闭浏览器  </span></span><br><span class="line">browser.close()</span><br></pre></td></tr></table></figure>

<h5 id="一次性事件监听-browser-once"><a href="#一次性事件监听-browser-once" class="headerlink" title="一次性事件监听 - browser.once()"></a>一次性事件监听 - browser.once()</h5><p>  用于为浏览器实例注册一次性事件监听器。只会被处罚一次，并在执行后自动移除，不会重复执行。</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定义事件处理函数  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_browser_closed</span>():  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;Browser is closed.&quot;</span>)  </span><br><span class="line"><span class="comment"># 启动一个本地 Chrome 浏览器实例  </span></span><br><span class="line">browser = p.chromium.launch()  </span><br><span class="line"><span class="comment"># 注册 close 事件的一次性监听器  </span></span><br><span class="line">browser.once(<span class="string">&quot;disconnected&quot;</span>, on_browser_closed)  </span><br><span class="line"><span class="comment"># 关闭浏览器  </span></span><br><span class="line">browser.close()  </span><br><span class="line"><span class="comment"># 再次触发 close 事件，但不会再次执行监听器中的代码  </span></span><br><span class="line">browser.close()  </span><br></pre></td></tr></table></figure>

<h5 id="移除监听-browser-remove-listener"><a href="#移除监听-browser-remove-listener" class="headerlink" title="移除监听 - browser.remove_listener()"></a>移除监听 - browser.remove_listener()</h5><p>  用于移除先前使用<code>browser.on()</code> 方法添加的事件监听器。</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 添加 close 事件监听器  </span></span><br><span class="line">browser.on(<span class="string">&quot;disconnected&quot;</span>, on_browser_closed)  </span><br><span class="line"><span class="comment"># 关闭浏览器时触发 close 事件  </span></span><br><span class="line">browser.close()  <span class="comment"># 输出: Browser is closed.  </span></span><br><span class="line"><span class="comment"># 移除 close 事件监听器  </span></span><br><span class="line">browser.remove_listener(<span class="string">&quot;disconnected&quot;</span>, on_browser_closed) </span><br></pre></td></tr></table></figure>

<h5 id="开启性能跟踪-browser-start-tracing-path-screenshots-browser-stop-tracing"><a href="#开启性能跟踪-browser-start-tracing-path-screenshots-browser-stop-tracing" class="headerlink" title="开启性能跟踪 - browser.start_tracing(path, screenshots) &amp; browser.stop_tracing()"></a>开启性能跟踪 - browser.start_tracing(path, screenshots) &amp; browser.stop_tracing()</h5><p>  用于开始对浏览器实例进行性能追踪。如网络请求、JavaScript 执行时间、内存占用等信息，以便分析和优化页面性能。</p>
<ul>
<li>参数<ul>
<li><code>path=&quot;trace.json&quot;</code>: 指定保存性能追踪数据的文件路径。在这个示例中，性能追踪数据将被保存在名为 <code>trace.json</code> 的文件中。</li>
<li><code>screenshots=True</code>: 如果将此参数设置为 <code>True</code>，则在性能追踪过程中还会捕获页面截图。这对于分析页面加载过程中的视觉表现非常有用，可以帮助进一步了解页面的性能情况。</li>
</ul>
</li>
</ul>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动一个本地 Chrome 浏览器实例  </span></span><br><span class="line">browser = p.chromium.launch()  </span><br><span class="line"><span class="comment"># 开始对浏览器进行性能追踪  </span></span><br><span class="line">browser.start_tracing(path=<span class="string">&quot;trace.json&quot;</span>, screenshots=<span class="literal">True</span>)  </span><br><span class="line"><span class="comment"># 访问页面并执行一些操作  </span></span><br><span class="line">page = browser.new_page()  </span><br><span class="line">page.goto(<span class="string">&quot;https://www.example.com&quot;</span>)  </span><br><span class="line"><span class="comment"># 在这里执行其他操作...  </span></span><br><span class="line"><span class="comment"># 停止性能追踪  </span></span><br><span class="line"><span class="comment"># 调用 trace.stop() 方法来停止性能追踪，此时会生成一个包含追踪数据的 JSON 文件 trace.json。</span></span><br><span class="line">browser.stop_tracing()</span><br></pre></td></tr></table></figure>

<h5 id="获取当前浏览器版本号-browser-version"><a href="#获取当前浏览器版本号-browser-version" class="headerlink" title="获取当前浏览器版本号 - browser.version"></a>获取当前浏览器版本号 - browser.version</h5><p>  获取当前浏览器版本</p>
  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">brVerion = browser.version</span><br><span class="line"><span class="built_in">print</span>(brVerion) <span class="comment"># 129.0.6668.29</span></span><br></pre></td></tr></table></figure>

<h5 id="关闭-browser-close"><a href="#关闭-browser-close" class="headerlink" title="关闭 - browser.close()"></a>关闭 - browser.close()</h5>  <figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 退出上下文</span></span><br><span class="line">context = browser.new_context()</span><br></pre></td></tr></table></figure>



<h4 id="context-浏览器上下文"><a href="#context-浏览器上下文" class="headerlink" title="context(浏览器上下文)"></a>context(浏览器上下文)</h4><p>浏览器上下文提供了一种操作多个独立浏览器会话的方法。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> playwright.sync_api <span class="keyword">import</span> sync_playwright</span><br><span class="line"></span><br><span class="line">p = sync_playwright().start()</span><br><span class="line"><span class="comment"># 生成浏览器对象并执行</span></span><br><span class="line">browser = p.chromium.launch(headless=<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># 创建浏览器的上下文</span></span><br><span class="line">context = browser.new_context()</span><br></pre></td></tr></table></figure>

<h5 id="添加cookie-context-add-cookie"><a href="#添加cookie-context-add-cookie" class="headerlink" title="添加cookie - context.add_cookie()"></a>添加cookie - context.add_cookie()</h5><p>将 Cookie 添加到此浏览器上下文。此上下文中的所有页面都将安装这些 Cookie。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动一个本地 Chromium 浏览器实例  </span></span><br><span class="line">browser = p.chromium.launch()  </span><br><span class="line"><span class="comment"># 创建浏览器的上下文  </span></span><br><span class="line">context = browser.new_context()  </span><br><span class="line"><span class="comment"># 定义要添加的 cookie 数据，name,value,url(domain) 是必须项</span></span><br><span class="line">cookie = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;session&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;value&#x27;</span>: <span class="string">&#x27;123456&#x27;</span>,</span><br><span class="line">    <span class="string">&#x27;url&#x27;</span>: <span class="string">&#x27;https://www.example.com&#x27;</span>  <span class="comment"># 设置Cookie的URL</span></span><br><span class="line">&#125;</span><br><span class="line"><span class="comment"># 向上下文中添加 cookie</span></span><br><span class="line">context.add_cookies([cookie])</span><br></pre></td></tr></table></figure>

<h5 id="获取cookie-context-cookies"><a href="#获取cookie-context-cookies" class="headerlink" title="获取cookie - context.cookies()"></a>获取cookie - context.cookies()</h5><p>此方法将返回所有 Cookie。如果指定了 URL，则仅返回影响这些 URL 的 Cookie(cookie受跨域影响)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取cookie</span></span><br><span class="line">browser_context.cookies()</span><br><span class="line"><span class="comment"># [&#123;&#x27;name&#x27;: &#x27;session&#x27;, &#x27;value&#x27;: &#x27;123456&#x27;, &#x27;domain&#x27;: &#x27;www.example.com&#x27;, &#x27;path&#x27;: &#x27;/&#x27;, &#x27;expires&#x27;: -1, &#x27;httpOnly&#x27;: False, &#x27;secure&#x27;: True, &#x27;sameSite&#x27;: &#x27;Lax&#x27;&#125;]</span></span><br></pre></td></tr></table></figure>

<h5 id="清除cookie记录-context-clear-cookies"><a href="#清除cookie记录-context-clear-cookies" class="headerlink" title="清除cookie记录 - context.clear_cookies"></a>清除cookie记录 - context.clear_cookies</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context.clear_cookies()</span><br></pre></td></tr></table></figure>

<h5 id="浏览器授权-context-grant-permissions"><a href="#浏览器授权-context-grant-permissions" class="headerlink" title="浏览器授权 - context.grant_permissions()"></a>浏览器授权 - context.grant_permissions()</h5><p>向浏览器上下文授予指定的权限。如果指定，则仅向给定来源授予相应的权限，可以模拟浏览器环境中向页面添加例如摄像头、麦克风、通知等权限。</p>
<ul>
<li>环境光传感器 - ambient-light-sensor</li>
<li>相机 - camera</li>
<li>地理位置 - geolocation</li>
<li>陀螺 - gyroscope</li>
<li>麦克风 - microphone</li>
<li>通知 - notifications</li>
<li>存储访问 - storage-access</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动一个浏览器实例  </span></span><br><span class="line">browser = p.chromium.launch()  </span><br><span class="line"><span class="comment"># 创建一个新页面  </span></span><br><span class="line">page = browser.new_page()  </span><br><span class="line"><span class="comment"># 向页面授予摄像头和麦克风权限  </span></span><br><span class="line">page.grant_permissions([<span class="string">&#x27;camera&#x27;</span>, <span class="string">&#x27;microphone&#x27;</span>])  </span><br><span class="line"><span class="comment"># 访问一个需要摄像头和麦克风权限的网站  </span></span><br><span class="line">page.goto(<span class="string">&#x27;https://www.example.com&#x27;</span>)  </span><br><span class="line"><span class="comment"># 进行其他操作...  </span></span><br><span class="line"><span class="comment"># 关闭浏览器  </span></span><br><span class="line">browser.close()  </span><br></pre></td></tr></table></figure>

<h5 id="清除权限-context-clear-permissions"><a href="#清除权限-context-clear-permissions" class="headerlink" title="清除权限 - context.clear_permissions"></a>清除权限 - context.clear_permissions</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context.clear_permissions()</span><br></pre></td></tr></table></figure>

<h5 id="关闭浏览器上下文context-close-str"><a href="#关闭浏览器上下文context-close-str" class="headerlink" title="关闭浏览器上下文context.close(str)"></a>关闭浏览器上下文context.close(str)</h5><p>关闭浏览器上下文。属于该浏览器上下文的所有页面(page)都将关闭。</p>
<ul>
<li><p>参数</p>
</li>
<li><p>str(可选) - 要报告给被上下文关闭中断的操作的原因 (添加于：v1.40)</p>
</li>
<li><p>context.add_init_script()</p>
<p>用于向浏览器上下文（Context）中添加自定义的初始化脚本（init script）。这个初始化脚本会在每次新页面被打开前执行，可以用来注入自定义的 JavaScript 代码，从而在页面加载前执行特定操作或修改页面行为。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建初始化脚本，用于在每次新页面加载前输出一条信息  </span></span><br><span class="line">init_script = <span class="string">&quot;&quot;&quot;  </span></span><br><span class="line"><span class="string">console.log(&#x27;Custom init script executed!&#x27;);  </span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span>  </span><br><span class="line"><span class="comment"># 启动一个本地 Chromium 浏览器实例  </span></span><br><span class="line">browser = p.chromium.launch()  </span><br><span class="line"><span class="comment"># 创建浏览器的上下文  </span></span><br><span class="line">context = browser.new_context()  </span><br><span class="line"><span class="comment"># 向上下文中添加初始化脚本  </span></span><br><span class="line">context.add_init_script(init_script)  </span><br><span class="line"><span class="comment"># 在上下文中创建新页面  </span></span><br><span class="line">page = context.new_page()  </span><br><span class="line"><span class="comment"># 在新页面中访问网站  </span></span><br><span class="line">page.goto(<span class="string">&quot;https://example.com&quot;</span>)  </span><br><span class="line"><span class="comment"># 等待页面加载完成  </span></span><br><span class="line">page.wait_for_load_state(<span class="string">&quot;load&quot;</span>)  </span><br></pre></td></tr></table></figure></li>
</ul>
<h5 id="监听等待特定事件触发-expect-event"><a href="#监听等待特定事件触发-expect-event" class="headerlink" title="监听等待特定事件触发 - expect_event()"></a>监听等待特定事件触发 - expect_event()</h5><p>用于在页面监听并等待特定事件的方法。通过 <code>expect_event</code> 方法，您可以设置条件来监听页面中触发的特定事件，并在事件发生时进行断言验证或执行其他操作。</p>
<h5 id="等待给定的-event-触发-wait-for-event"><a href="#等待给定的-event-触发-wait-for-event" class="headerlink" title="等待给定的 event 触发 - wait_for_event()"></a>等待给定的 <code>event</code> 触发 - wait_for_event()</h5><h5 id="context-new-cdp-session"><a href="#context-new-cdp-session" class="headerlink" title="context.new_cdp_session()"></a>context.new_cdp_session()</h5><p>返回新创建的会话</p>
<h5 id="创建一个页面-context-new-page"><a href="#创建一个页面-context-new-page" class="headerlink" title="创建一个页面 - context.new_page()"></a>创建一个页面 - context.new_page()</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">browser = p.chromium.launch(headless=<span class="literal">False</span>)</span><br><span class="line">context = browser.new_context()</span><br><span class="line">page = context.new_page() <span class="comment"># 默认访问about:blank 返回一个页面对象page</span></span><br></pre></td></tr></table></figure>

<h5 id="用于浏览器上下文捕获网络请求的功能-context-route"><a href="#用于浏览器上下文捕获网络请求的功能-context-route" class="headerlink" title="用于浏览器上下文捕获网络请求的功能 - context.route()"></a>用于浏览器上下文捕获网络请求的功能 - context.route()</h5><p>启用路由后，与 URL 模式匹配的每个请求都将暂停</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">browser = p.chromium.launch(headless=<span class="literal">False</span>)</span><br><span class="line">context = browser.new_context()</span><br><span class="line">context.route() <span class="comment"># 默认访问about:blank 返回一个页面对象page</span></span><br></pre></td></tr></table></figure>

<h5 id="清除router捕获功能-unroute"><a href="#清除router捕获功能-unroute" class="headerlink" title="清除router捕获功能 - unroute()"></a>清除router捕获功能 - unroute()</h5><h5 id="清除使用-browser-context-route-和-browser-context-route-from-har-创建的所有路由规则-unroute-all"><a href="#清除使用-browser-context-route-和-browser-context-route-from-har-创建的所有路由规则-unroute-all" class="headerlink" title="清除使用 browser_context.route()和 browser_context.route_from_har()创建的所有路由规则 - unroute_all()"></a>清除使用 browser_context.route()和 browser_context.route_from_har()创建的所有路由规则 - unroute_all()</h5><h5 id="从-HAR-文件创建虚拟的路由-route-from-har"><a href="#从-HAR-文件创建虚拟的路由-route-from-har" class="headerlink" title="从 HAR 文件创建虚拟的路由 - route_from_har"></a>从 HAR 文件创建虚拟的路由 - route_from_har</h5><p>pass</p>
<h5 id="统一设置超时时间-set-default-navigation-timeout-timeout"><a href="#统一设置超时时间-set-default-navigation-timeout-timeout" class="headerlink" title="统一设置超时时间 - set_default_navigation_timeout(timeout)"></a>统一设置超时时间 - set_default_navigation_timeout(timeout)</h5><ul>
<li><p>超时生效的方法</p>
<ul>
<li><p>page.go_back()</p>
</li>
<li><p>page.go_forward()</p>
</li>
<li><p>page.goto()</p>
</li>
<li><p>page.reload()</p>
</li>
<li><p>page.set_content()</p>
</li>
<li><p>page.expect_navigation()</p>
</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 设置默认的页面导航超时时间为10秒（10000毫秒）  </span></span><br><span class="line">context.set_default_navigation_timeout(<span class="number">10000</span>) </span><br></pre></td></tr></table></figure>

<h5 id="设置所有超时时间-set-default-timeout-timeout"><a href="#设置所有超时时间-set-default-timeout-timeout" class="headerlink" title="设置所有超时时间 - set_default_timeout(timeout)"></a>设置所有超时时间 - set_default_timeout(timeout)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context.set_default_timeout(timeout)</span><br></pre></td></tr></table></figure>

<h5 id="设置请求头-set-extra-http-headers"><a href="#设置请求头-set-extra-http-headers" class="headerlink" title="设置请求头 - set_extra_http_headers()"></a>设置请求头 - set_extra_http_headers()</h5><p>设置该上下文请求时发送的，如果相同参数，将使用页面特定的标头值而不是浏览器上下文标头值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context.set_extra_http_headers(headers)</span><br></pre></td></tr></table></figure>

<h5 id="设置地理位置-set-geolocation"><a href="#设置地理位置-set-geolocation" class="headerlink" title="设置地理位置 - set_geolocation()"></a>设置地理位置 - set_geolocation()</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">context.set_geolocation(&#123;<span class="string">&quot;latitude&quot;</span>: <span class="number">59.95</span>, <span class="string">&quot;longitude&quot;</span>: <span class="number">30.31667</span>&#125;)</span><br><span class="line"><span class="comment"># latitude float 纬度，介于 -90 和 90 之间。</span></span><br><span class="line"><span class="comment"># longitude float 经度，介于 -180 和 180 之间。</span></span><br></pre></td></tr></table></figure>

<h5 id="模拟网络离线状态-set-offline"><a href="#模拟网络离线状态-set-offline" class="headerlink" title="模拟网络离线状态 - set_offline()"></a>模拟网络离线状态 - set_offline()</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context.set_offline(offline)</span><br></pre></td></tr></table></figure>

<h5 id="获取浏览器缓存数据-storage-state"><a href="#获取浏览器缓存数据-storage-state" class="headerlink" title="获取浏览器缓存数据 - storage_state()"></a>获取浏览器缓存数据 - storage_state()</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">context.storage_state(path)</span><br><span class="line"><span class="comment"># path 文件保存路径，可选参数。如果未提供路径，则仍将返回存储状态，但不会保存到磁盘。</span></span><br></pre></td></tr></table></figure>

<h5 id="获取上下文中所有现有的后台页面-background-pages"><a href="#获取上下文中所有现有的后台页面-background-pages" class="headerlink" title="获取上下文中所有现有的后台页面 - background_pages"></a>获取上下文中所有现有的后台页面 - background_pages</h5><p>用于获取当前浏览器上下文（Context）关联的所有后台页面（background pages）。后台页面是指在后台运行的页面，通常是一些扩展或插件创建的页面，独立于当前活动页面，可以在后台执行一些任务或逻辑。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 启动一个本地 Chromium 浏览器实例  </span></span><br><span class="line">browser = p.chromium.launch()  </span><br><span class="line"><span class="comment"># 创建浏览器的上下文  </span></span><br><span class="line">context = browser.new_context()  </span><br><span class="line"><span class="comment"># 在上下文中创建新页面  </span></span><br><span class="line">page = context.new_page()  </span><br><span class="line"><span class="comment"># 在新页面中打开一个后台页面，模拟一个插件或扩展操作  </span></span><br><span class="line">page.evaluate(<span class="string">&#x27;window.open(&quot;about:blank&quot;, &quot;_background&quot;)&#x27;</span>)  </span><br><span class="line"><span class="comment"># 获取当前上下文关联的所有后台页面  </span></span><br><span class="line">background_pages = context.background_pages  </span><br><span class="line"><span class="comment"># 输出后台页面数量和相关信息  </span></span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&quot;Total background pages: <span class="subst">&#123;<span class="built_in">len</span>(background_pages)&#125;</span>&quot;</span>)  </span><br><span class="line"><span class="keyword">for</span> bg_page <span class="keyword">in</span> background_pages:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Background page ID: <span class="subst">&#123;bg_page.<span class="built_in">id</span>&#125;</span>&quot;</span>)  </span><br></pre></td></tr></table></figure>

<h5 id="获取上下文所有打开的页面-pages"><a href="#获取上下文所有打开的页面-pages" class="headerlink" title="获取上下文所有打开的页面 - pages"></a>获取上下文所有打开的页面 - pages</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context.pages</span><br></pre></td></tr></table></figure>

<h5 id="发起请求-request"><a href="#发起请求-request" class="headerlink" title="发起请求 - request"></a>发起请求 - request</h5><p>使用此 API 发出的请求将使用上下文 Cookie。</p>
<h4 id="context相关事件"><a href="#context相关事件" class="headerlink" title="context相关事件"></a>context相关事件</h4><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2024/09/26/playwright%E6%A1%86%E6%9E%B6/context%E4%BA%8B%E4%BB%B6.png" alt="image-20241007165739866"></p>
<h5 id="on-“backgroundpage”"><a href="#on-“backgroundpage”" class="headerlink" title="on(“backgroundpage”)"></a>on(“backgroundpage”)</h5><blockquote>
<p>适用于 Chromium 浏览器的持久上下文</p>
</blockquote>
<p>在上下文中创建新的后台页面时发出</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">background_page = context.wait_for_event(<span class="string">&quot;backgroundpage&quot;</span>)</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">browser_context.on(<span class="string">&quot;backgroundpage&quot;</span>, handler)</span><br></pre></td></tr></table></figure>

<h5 id="on-“close”"><a href="#on-“close”" class="headerlink" title="on(“close”)"></a>on(“close”)</h5><p>在浏览器上下文关闭时发出</p>
<ul>
<li>浏览器上下文已关闭。</li>
<li>浏览器应用程序已关闭或崩溃。</li>
<li>已调用 browser.close()方法。</li>
</ul>
<h5 id="on-“console”"><a href="#on-“console”" class="headerlink" title="on(“console”)"></a>on(“console”)</h5><p>当页面中的 JavaScript 调用某个控制台 API 方法（例如 <code>console.log</code> 或 <code>console.dir</code>）时发出</p>
<h5 id="on-“dialog”"><a href="#on-“dialog”" class="headerlink" title="on(“dialog”)"></a>on(“dialog”)</h5><p>当出现 JavaScript 对话框（例如 <code>alert</code>、<code>prompt</code>、<code>confirm</code> 或 <code>beforeunload</code>）时发出。侦听器<strong>必须</strong> dialog.accept()或 dialog.dismiss()对话框 - 否则页面将 冻结等待对话框，并且像单击之类的操作将永远不会完成</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context.on(<span class="string">&quot;dialog&quot;</span>, <span class="keyword">lambda</span> dialog: dialog.accept())</span><br></pre></td></tr></table></figure>

<h5 id="on-“page”"><a href="#on-“page”" class="headerlink" title="on(“page”)"></a>on(“page”)</h5><p>在 BrowserContext 中创建新页面时发出该事件。该页面可能仍在加载中。弹出页面也会触发该事件</p>
<h5 id="on-“request”"><a href="#on-“request”" class="headerlink" title="on(“request”)"></a>on(“request”)</h5><p>从通过此上下文创建的任何页面发出请求时发出。 request 对象是只读的。要仅侦听来自特定页面的请求，请使用 page.on(“request”)</p>
<h5 id="on-“requestfailed”"><a href="#on-“requestfailed”" class="headerlink" title="on(“requestfailed”)"></a>on(“requestfailed”)</h5><p>请求失败时发出，例如超时。如果仅侦听来自特定页面的失败请求，请使用 page.on(“requestfailed”)。</p>
<h5 id="on-“requestfinished”"><a href="#on-“requestfinished”" class="headerlink" title="on(“requestfinished”)"></a>on(“requestfinished”)</h5><p>在下载响应正文后请求成功完成时发出。对于成功的响应，事件顺序为 request、response 和 requestfinished。要侦听来自特定页面的成功请求，请使用 page.on(“requestfinished”)。</p>
<h5 id="on-“response”"><a href="#on-“response”" class="headerlink" title="on(“response”)"></a>on(“response”)</h5><p>当收到请求的 响应 状态和标头时发出。对于成功的响应，事件顺序为 request、response 和 requestfinished。要监听来自特定页面的响应事件，请使用 page.on(“response”)。</p>
<h5 id="on-“serviceworker”"><a href="#on-“serviceworker”" class="headerlink" title="on(“serviceworker”)"></a>on(“serviceworker”)</h5><blockquote>
<p>仅基于 Chromium 的浏览器支持 Service Worker。</p>
</blockquote>
<p>当在上下文中创建新的服务工作线程时发出。</p>
<h5 id="on-“weberror”"><a href="#on-“weberror”" class="headerlink" title="on(“weberror”)"></a>on(“weberror”)</h5><p>当此上下文中任何页面的异常未处理时发出。要监听来自特定页面的错误，请改用 page.on(“pageerror”)。</p>
<h4 id="page元素定位"><a href="#page元素定位" class="headerlink" title="page元素定位"></a>page元素定位</h4><h5 id="定位器-page-Locator-方法"><a href="#定位器-page-Locator-方法" class="headerlink" title="定位器 - page.Locator() 方法"></a>定位器 - page.Locator() 方法</h5><p>定位器（Locator）是 Playwright 的自动等待和重试能力的核心部分。定位器是一种随时在网页上查找元素的方法，用于在元素上执行诸如 .click、.fill 之类的操作。可以使用 page.locator(selector, **kwargs) 方法创建自定义定位器。支持css、xpath。返回一个定位器;Locator 对象的主要优点是它们可以自动等待元素出现在页面上</p>
<h6 id="参数讲解-locator-selector-kwargs"><a href="#参数讲解-locator-selector-kwargs" class="headerlink" title="参数讲解 locator(selector, **kwargs)"></a>参数讲解 locator(selector, **kwargs)</h6><p><strong>selector</strong> - 用于解析 DOM 元素的选择器。</p>
<h6 id="定位器返回单个元素-page-locator"><a href="#定位器返回单个元素-page-locator" class="headerlink" title="定位器返回单个元素 - page.locator()"></a>定位器返回单个元素 - <code>page.locator()</code></h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过特定选择器查找</span></span><br><span class="line">loc = page.locator(<span class="string">&#x27;button[type=&quot;submit&quot;]&#x27;</span>) <span class="comment"># 定位所有button下的DOM的type=&quot;submit&quot;</span></span><br><span class="line">loc = page.locator(<span class="string">&#x27;input[name=&quot;username&quot;][type=&quot;text&quot;]&#x27;</span>)  <span class="comment"># 查找 name 为 &quot;username&quot; 且 type 为 &quot;text&quot; 的 input 元素   # 组合多个查找条件</span></span><br><span class="line"><span class="comment"># 通过id查找</span></span><br><span class="line">loc = page.locator(<span class="string">&#x27;#kw&#x27;</span>)</span><br><span class="line"><span class="comment"># 通过classname查找元素</span></span><br><span class="line">loc = page.locator(<span class="string">&#x27;.class&#x27;</span>)</span><br><span class="line">loc = page.locator(<span class="string">&#x27;.class1.class2.class3&#x27;</span>) <span class="comment">#多个classname属性</span></span><br><span class="line"><span class="comment"># 通过 XPath 表达式查找元素</span></span><br><span class="line">loc = page.locator(<span class="string">&#x27;//div[@id=&quot;myDiv&quot;]/span&#x27;</span>)</span><br><span class="line">loc = page.locator(<span class="string">&#x27;//div[@class=&quot;myClass&quot;]&#x27;</span>)</span><br><span class="line">loc = page.locator(<span class="string">&#x27;//input[@name=&quot;myInput&quot;]&#x27;</span>)</span><br><span class="line">loc = page.locator(<span class="string">&#x27;//input[@name=&quot;myInput&quot; and @type=&quot;text&quot;]&#x27;</span>) <span class="comment"># 多个属性</span></span><br><span class="line"><span class="comment"># 通过文本内容查找元素</span></span><br><span class="line">loc = page.locator(<span class="string">&#x27;//span[text()=&quot;Sign In&quot;]&#x27;</span>) </span><br><span class="line">loc = page.locator(<span class="string">&#x27;:text(&quot;Hello, World!&quot;)&#x27;</span>)</span><br><span class="line"><span class="comment"># 通过标签查找定位</span></span><br><span class="line">loc = page.locator(<span class="string">&#x27;div&#x27;</span>)</span><br><span class="line"><span class="comment"># 通过属性值模糊匹配查找元素</span></span><br><span class="line">loc = page.locator(<span class="string">&#x27;input[name^=&quot;user&quot;]&#x27;</span>)  <span class="comment"># 匹配 name 属性值以 &quot;user&quot; 开头的input元素</span></span><br><span class="line"><span class="comment"># 通过索引查找元素集合中的特定元素：</span></span><br><span class="line">loc = page.locator(<span class="string">&#x27;input&#x27;</span>)[<span class="number">0</span>]  <span class="comment"># 获取第一个 input 元素 与.nth()类似</span></span><br></pre></td></tr></table></figure>

<h6 id="page-locator-方法返回一个元素定位器-Locator"><a href="#page-locator-方法返回一个元素定位器-Locator" class="headerlink" title="page.locator() 方法返回一个元素定位器 Locator"></a><code>page.locator()</code> 方法返回一个元素定位器 Locator</h6><p>所以通过<code>page.locator()</code> 返回的对象可以继续使用<code>.locator()</code>进行内部子元素定位</p>
<p><strong>链式调用</strong></p>
<p><code>page.locator()</code> 的返回值本身也有 <code>locator()</code> 方法，这意味着你可以链式地定位元素。例如，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">page.locator(<span class="string">&#x27;.my-class&#x27;</span>).locator(<span class="string">&#x27;.my-subclass&#x27;</span>)</span><br><span class="line"><span class="comment"># 会定位到所有具有 &quot;my-class&quot; 类的元素中，再次具有 &quot;my-subclass&quot; 类的元素。</span></span><br></pre></td></tr></table></figure>

<h6 id="返回全部元素-locator-all"><a href="#返回全部元素-locator-all" class="headerlink" title="返回全部元素 - locator.all()"></a>返回全部元素 - locator.all()</h6><blockquote>
<p>locator.all() 不会等待元素匹配定位器，而是立即返回页面中存在的内容。</p>
</blockquote>
<p>当定位器指向元素列 表时，这将返回一个定位器数组，指向它们各自的元素。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查找所有带有 class 为 &#x27;example&#x27; 的元素  </span></span><br><span class="line">elements = page.locator(<span class="string">&#x27;.example&#x27;</span>).<span class="built_in">all</span>()  <span class="comment"># []</span></span><br></pre></td></tr></table></figure>

<h6 id="返回全部匹配元素的数量-locator-count"><a href="#返回全部匹配元素的数量-locator-count" class="headerlink" title="返回全部匹配元素的数量 - locator.count()"></a>返回全部匹配元素的数量 - locator.count()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查找所有带有 class 为 &#x27;example&#x27; 的元素，并返回数量</span></span><br><span class="line">elements = page.locator(<span class="string">&#x27;.example&#x27;</span>).count() <span class="comment"># int</span></span><br></pre></td></tr></table></figure>

<h6 id="匹配元素的文本内容-locator-all-inner-texts"><a href="#匹配元素的文本内容-locator-all-inner-texts" class="headerlink" title="匹配元素的文本内容 - locator.all_inner_texts()"></a>匹配元素的文本内容 - locator.all_inner_texts()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取文本内容</span></span><br><span class="line">page.get_by_role(<span class="string">&#x27;.example&#x27;</span>).all_inner_texts()</span><br><span class="line">page.get_by_role(<span class="string">&#x27;.example&#x27;</span>).inner_text()</span><br><span class="line"><span class="comment"># 获取元素的文本内容 </span></span><br><span class="line">page.locator(<span class="string">&#x27;.example&#x27;</span>).textContent()</span><br><span class="line"><span class="comment"># 获取元素的html内容 </span></span><br><span class="line">page.locator(<span class="string">&#x27;.example&#x27;</span>).innerHTML()</span><br><span class="line"><span class="comment"># 获取元素外部的html内容 </span></span><br><span class="line">page.locator(<span class="string">&#x27;.example&#x27;</span>).outerHTML()</span><br></pre></td></tr></table></figure>

<h6 id="获取元素的DOM-locator-inner-html"><a href="#获取元素的DOM-locator-inner-html" class="headerlink" title="获取元素的DOM - locator.inner_html()"></a>获取元素的DOM - locator.inner_html()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.get_by_role(<span class="string">&quot;link&quot;</span>).inner_html()</span><br></pre></td></tr></table></figure>

<h6 id="获取元素的文本内容-locator-inner-text"><a href="#获取元素的文本内容-locator-inner-text" class="headerlink" title="获取元素的文本内容 - locator.inner_text()"></a>获取元素的文本内容 - locator.inner_text()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.get_by_role(<span class="string">&quot;link&quot;</span>).inner_text()</span><br></pre></td></tr></table></figure>

<h6 id="获取元素DOM属性值-locator-get-attribute"><a href="#获取元素DOM属性值-locator-get-attribute" class="headerlink" title="获取元素DOM属性值 - locator.get_attribute()"></a>获取元素DOM属性值 - locator.get_attribute()</h6><p>用于从匹配的元素中获取指定属性的值。您可以指定要获取的属性名称，并返回相应的属性值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 选择要获取属性值的元素  </span></span><br><span class="line">element_locator = page.locator(<span class="string">&#x27;input[type=&quot;text&quot;]&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取元素的 &quot;value&quot; 属性值  </span></span><br><span class="line">value_attribute = element_locator.get_attribute(<span class="string">&#x27;value&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">f&#x27;The value attribute of the element: <span class="subst">&#123;value_attribute&#125;</span>&#x27;</span>)  </span><br></pre></td></tr></table></figure>

<h6 id="匹配多种元素"><a href="#匹配多种元素" class="headerlink" title="匹配多种元素"></a>匹配多种元素</h6><ul>
<li><p>and_()</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 匹配两种or多种元素定位</span></span><br><span class="line">button = page.get_by_role(<span class="string">&quot;button&quot;</span>).and_(page.getByTitle(<span class="string">&quot;Subscribe&quot;</span>))</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用多种元素匹配</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 查找具有 role 为 &#x27;button&#x27; 和 title 为 &#x27;Subscribe&#x27; 的元素</span></span><br><span class="line">button = page.query_selector(<span class="string">&#x27;[role=&quot;button&quot;][title=&quot;Subscribe&quot;]&#x27;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
<h6 id="设置字段值locator-fill"><a href="#设置字段值locator-fill" class="headerlink" title="设置字段值locator.fill()"></a>设置字段值locator.fill()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 为输入字段设置值</span></span><br><span class="line">page.get_by_role(<span class="string">&quot;textbox&quot;</span>).fill(<span class="string">&quot;example value&quot;</span>)</span><br></pre></td></tr></table></figure>

<h6 id="输入框聚焦-locator-focus"><a href="#输入框聚焦-locator-focus" class="headerlink" title="输入框聚焦 - locator.focus()"></a>输入框聚焦 - locator.focus()</h6><p>用于将页面上匹配的元素（通过定位器选择）设置为焦点。这可以模拟用户手动点击元素以使其聚焦的操作。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 选择要设置焦点的输入框元素  </span></span><br><span class="line">input_locator = page.locator(<span class="string">&#x27;input[type=&quot;text&quot;]&#x27;</span>)  </span><br><span class="line"><span class="comment"># 将输入框元素设置为焦点  </span></span><br><span class="line">input_locator.focus()  </span><br></pre></td></tr></table></figure>

<h6 id="输入框焦点-locator-blur"><a href="#输入框焦点-locator-blur" class="headerlink" title="输入框焦点 - locator.blur()"></a>输入框焦点 - locator.blur()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定位到一个输入框元素  </span></span><br><span class="line">input_element = page.locator(<span class="string">&#x27;input[type=&quot;text&quot;]&#x27;</span>)  </span><br><span class="line"><span class="comment"># 输入文本到输入框并使其失去焦点  </span></span><br><span class="line">input_element.focus()  <span class="comment"># 将焦点设置在指定的输入元素</span></span><br><span class="line">input_element.fill(<span class="string">&#x27;Hello, Playwright!&#x27;</span>)  <span class="comment"># 输入内容</span></span><br><span class="line">input_element.blur()  <span class="comment"># 将焦点从指定的输入元素移除</span></span><br></pre></td></tr></table></figure>

<h6 id="获取定位属性的元素的边界框信息-locator-bounding-box"><a href="#获取定位属性的元素的边界框信息-locator-bounding-box" class="headerlink" title="获取定位属性的元素的边界框信息 - locator.bounding_box()"></a>获取定位属性的元素的边界框信息 - locator.bounding_box()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取具有 role 为 &#x27;button&#x27; 的元素的边界框信息  &#123;横坐标, 纵坐标, 宽, 高&#125;</span></span><br><span class="line">bounding_box = page.locator(<span class="string">&#x27;[role=&quot;button&quot;]&#x27;</span>).bounding_box()  </span><br><span class="line"><span class="built_in">print</span>(bounding_box) <span class="comment"># &#123;&#x27;x&#x27;: 0, &#x27;y&#x27;: 0, &#x27;width&#x27;: 1280, &#x27;height&#x27;: 60&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取的信息可以通过模拟鼠标进行点击</span></span><br><span class="line">page.mouse.click(box[<span class="string">&quot;x&quot;</span>] + box[<span class="string">&quot;width&quot;</span>] / <span class="number">2</span>, box[<span class="string">&quot;y&quot;</span>] + box[<span class="string">&quot;height&quot;</span>] / <span class="number">2</span>)</span><br><span class="line"><span class="comment"># 除以2是因为，点击目标元素的中心位置</span></span><br></pre></td></tr></table></figure>

<h6 id="选中选框-按钮元素-locator-check"><a href="#选中选框-按钮元素-locator-check" class="headerlink" title="选中选框&#x2F;按钮元素 - locator.check()"></a>选中选框&#x2F;按钮元素 - locator.check()</h6><p>确保选中复选框或单选按钮元素, 如果不是，则此方法会抛出异常。如果元素已选中，则此方法立即返回。注意：需要将元素滚动到视图中。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定位带有 role 为 &#x27;checkbox&#x27; 的元素并选中它  </span></span><br><span class="line">checkbox_element = page.locator(<span class="string">&#x27;input[type=&quot;checkbox&quot;]&#x27;</span>)  </span><br><span class="line"><span class="comment"># 判断复选框当前是否未选中，然后选中它  </span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> checkbox_element.is_checked():  </span><br><span class="line">    checkbox_element.check()  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;复选框已选中&quot;</span>)  </span><br><span class="line"><span class="keyword">else</span>:  </span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;复选框已处于选中状态&quot;</span>)  </span><br></pre></td></tr></table></figure>

<h6 id="清除选中元素-locator-clear"><a href="#清除选中元素-locator-clear" class="headerlink" title="清除选中元素- locator.clear()"></a>清除选中元素- locator.clear()</h6><p>此方法会等待 可操作性 检查，聚焦元素，清除其内容并在清除后触发 input 事件。</p>
<p>如果目标元素不是 <code>&lt;input&gt;</code>、<code>&lt;textarea&gt;</code> 或 [contenteditable] 元素，则此方法会抛出错误。但是，如果元素位于具有关联 控件 的 <code>&lt;label&gt;</code> 元素内，则将清除该控件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">input_locator = page.locator(<span class="string">&#x27;input[type=&quot;text&quot;]&#x27;</span>)  <span class="comment"># 替换成您要操作的输入框的选择器  </span></span><br><span class="line">input_locator.fill(<span class="string">&quot;Hello, World!&quot;</span>)  <span class="comment"># 填充文本框内容  </span></span><br><span class="line"><span class="comment"># 清空输入框中的内容  </span></span><br><span class="line">input_locator.clear()  </span><br></pre></td></tr></table></figure>

<h6 id="点击选中元素-locator-click"><a href="#点击选中元素-locator-click" class="headerlink" title="点击选中元素 - locator.click()"></a>点击选中元素 - locator.click()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过 CSS 选择器定位具有 role 为 &#x27;button&#x27; 的元素并点击  </span></span><br><span class="line">button_element = page.locator(<span class="string">&#x27;[role=&quot;button&quot;]&#x27;</span>)</span><br><span class="line">button_element.click()</span><br></pre></td></tr></table></figure>

<h6 id="双击选中元素-locator-dblclick"><a href="#双击选中元素-locator-dblclick" class="headerlink" title="双击选中元素 - locator.dblclick()"></a>双击选中元素 - locator.dblclick()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 双击选中元素，参数与click()一致</span></span><br><span class="line">button_element = page.locator(<span class="string">&#x27;[role=&quot;button&quot;]&#x27;</span>)</span><br><span class="line">button_element.dblclick()</span><br></pre></td></tr></table></figure>

<h6 id="locator-dispatch-event"><a href="#locator-dispatch-event" class="headerlink" title="locator.dispatch_event()"></a>locator.dispatch_event()</h6><p>以编程方式在匹配的元素上调度事件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过 CSS 选择器定位需要模拟点击事件的元素  </span></span><br><span class="line">button_locator = page.locator(<span class="string">&#x27;button&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用 evaluate 方法来执行 JavaScript 代码模拟触发点击事件  </span></span><br><span class="line">button_locator.evaluate(<span class="string">&#x27;(element) =&gt; element.click()&#x27;</span>)  </span><br></pre></td></tr></table></figure>

<h6 id="元素拖动-locator-drag-to"><a href="#元素拖动-locator-drag-to" class="headerlink" title="元素拖动 - locator.drag_to()"></a>元素拖动 - locator.drag_to()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 选择要拖动的源元素和目标元素  </span></span><br><span class="line">source_locator = page.locator(<span class="string">&#x27;source_element_selector&#x27;</span>)  </span><br><span class="line">target_locator = page.locator(<span class="string">&#x27;target_element_selector&#x27;</span>)  </span><br><span class="line"><span class="comment"># 将源元素拖动到目标元素位置  </span></span><br><span class="line">source_locator.drag_to(target_locator)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将target目标元素从某位置移动到特定位置</span></span><br><span class="line">source.drag_to(</span><br><span class="line">  target,</span><br><span class="line">  source_position=&#123;<span class="string">&quot;x&quot;</span>: <span class="number">34</span>, <span class="string">&quot;y&quot;</span>: <span class="number">7</span>&#125;,</span><br><span class="line">  target_position=&#123;<span class="string">&quot;x&quot;</span>: <span class="number">10</span>, <span class="string">&quot;y&quot;</span>: <span class="number">20</span>&#125;</span><br><span class="line">)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<h6 id="执行js代码-locator-evaluate"><a href="#执行js代码-locator-evaluate" class="headerlink" title="执行js代码 - locator.evaluate()"></a>执行js代码 - locator.evaluate()</h6><p>执行 JavaScript 代码，并将结果返回给 Python 程序。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 evaluate 方法获取页面中某个节点的 innerText  </span></span><br><span class="line">inner_text = page.evaluate(<span class="string">&#x27;(node) =&gt; node.innerText&#x27;</span>) <span class="comment">#[,&#x27;selector_of_the_node&#x27;)]</span></span><br><span class="line"><span class="built_in">print</span>(inner_text) </span><br></pre></td></tr></table></figure>

<h6 id="执行js代码-locator-evaluate-all"><a href="#执行js代码-locator-evaluate-all" class="headerlink" title="执行js代码  - locator.evaluate_all()"></a>执行js代码  - locator.evaluate_all()</h6><p>这个方法用于在页面上下文中对所有匹配的元素执行JavaScript代码，并返回一个包含所有结果的数组。它对于处理多个匹配元素非常有用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">elements = page.locator(<span class="string">&#x27;div&#x27;</span>).evaluate_all(<span class="string">&#x27;(elements) =&gt; elements.map(el =&gt; el.textContent)&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(elements)</span><br></pre></td></tr></table></figure>

<h6 id="执行js代码-locator-evaluate-handle"><a href="#执行js代码-locator-evaluate-handle" class="headerlink" title="执行js代码  - locator.evaluate_handle()"></a>执行js代码  - locator.evaluate_handle()</h6><p>这个方法用于在页面上下文中执行JavaScript代码，返回一个 Promise，用于在后续的操作中获取结果。并使用结果返回一个远程对象（evaluateHandle对象），可通过调用<code>evaluateHandle.dispose()</code>方法显式地释放。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">handle = page.locator(<span class="string">&#x27;button&#x27;</span>).evaluate_handle(<span class="string">&#x27;(buttons) =&gt; buttons[0]&#x27;</span>)  </span><br><span class="line">result = handle.evaluate(<span class="string">&#x27;button =&gt; button.textContent&#x27;</span>)  </span><br><span class="line"><span class="built_in">print</span>(result)  </span><br><span class="line">handle.dispose()</span><br></pre></td></tr></table></figure>

<h6 id="过滤器-locator-filter"><a href="#过滤器-locator-filter" class="headerlink" title="过滤器 - locator.filter()"></a>过滤器 - locator.filter()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">row_locator = page.locator(<span class="string">&quot;tr&quot;</span>)</span><br><span class="line"><span class="comment"># 通过locator进一步过滤 </span></span><br><span class="line">row_locator.<span class="built_in">filter</span>(has_text=<span class="string">&quot;text in column 1&quot;</span>).<span class="built_in">filter</span>(</span><br><span class="line">    has=page.get_by_role(<span class="string">&quot;button&quot;</span>, name=<span class="string">&quot;column 2 button&quot;</span>)</span><br><span class="line">).screenshot()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过js语句进一步过滤</span></span><br><span class="line"><span class="comment"># 过滤出包含特定文本的链接元素  </span></span><br><span class="line">filtered_links_locator = links_locator.<span class="built_in">filter</span>(<span class="string">&#x27;(element) =&gt; element.textContent.includes(&quot;example&quot;)&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取满足条件的链接元素数量  </span></span><br><span class="line">num_filtered_links = filtered_links_locator.count()  </span><br></pre></td></tr></table></figure>

<h6 id="切换iframe-locator-frame-locator"><a href="#切换iframe-locator-frame-locator" class="headerlink" title="切换iframe - locator.frame_locator()"></a>切换iframe - locator.frame_locator()</h6><p>用于在定位器的上下文中查找嵌套的 iframe 元素。在页面上有嵌套的 iframe 结构时，可以使用该方法来选择 iframe 元素并返回一个新的定位器,该定位器指向iframe</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 选择页面中包含 iframe 的元素  </span></span><br><span class="line">frame_element_locator = page.locator(<span class="string">&#x27;iframe#iframe_id&#x27;</span>)  </span><br><span class="line"><span class="comment"># 在 iframe 元素的上下文中查找内部元素  </span></span><br><span class="line">inner_element_locator = frame_element_locator.frame_locator(<span class="string">&#x27;selector_inside_iframe&#x27;</span>)  </span><br><span class="line"><span class="comment"># 对内部元素执行操作  </span></span><br><span class="line">inner_element_locator.click()  </span><br></pre></td></tr></table></figure>

<h6 id="高亮显示选中元素-element-highlight"><a href="#高亮显示选中元素-element-highlight" class="headerlink" title="高亮显示选中元素 - element.highlight()"></a>高亮显示选中元素 - element.highlight()</h6><p>对选中的元素，进行高亮显示</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">element = page.locator().get_by_text(<span class="string">&quot;新闻&quot;</span>)</span><br><span class="line">element.highlight()</span><br></pre></td></tr></table></figure>

<h6 id="鼠标悬停-element-hover"><a href="#鼠标悬停-element-hover" class="headerlink" title="鼠标悬停 - element.hover()"></a>鼠标悬停 - element.hover()</h6><p>将鼠标悬停在匹配的元素上。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.get_by_role(<span class="string">&quot;link&quot;</span>).hover()</span><br></pre></td></tr></table></figure>

<h6 id="获取元素的value属性值-locator-input-value"><a href="#获取元素的value属性值-locator-input-value" class="headerlink" title="获取元素的value属性值 - locator.input_value()"></a>获取元素的value属性值 - locator.input_value()</h6><p>返回匹配的 <code>&lt;input&gt;</code> 或 <code>&lt;textarea&gt;</code> 或 <code>&lt;select&gt;</code> 元素的值。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">value = page.get_by_role(<span class="string">&quot;textbox&quot;</span>).input_value()</span><br></pre></td></tr></table></figure>

<h6 id="返回定位元素是否选中-locator-is-checked"><a href="#返回定位元素是否选中-locator-is-checked" class="headerlink" title="返回定位元素是否选中 - locator.is_checked()"></a>返回定位元素是否选中 - locator.is_checked()</h6><p>返回该元素是否被选中。 如果该元素不是复选框或单选按钮输入，则抛出异常</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">checked = page.get_by_role(<span class="string">&quot;checkbox&quot;</span>).is_checked()</span><br></pre></td></tr></table></figure>

<h6 id="返回该元素是否被禁用-locator-is-disabled"><a href="#返回该元素是否被禁用-locator-is-disabled" class="headerlink" title="返回该元素是否被禁用 - locator.is_disabled()"></a>返回该元素是否被禁用 - locator.is_disabled()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">disabled = page.get_by_role(<span class="string">&quot;button&quot;</span>).is_disabled()</span><br></pre></td></tr></table></figure>

<h6 id="判断元素是否可编辑-locator-is-editable"><a href="#判断元素是否可编辑-locator-is-editable" class="headerlink" title="判断元素是否可编辑 - locator.is_editable()"></a>判断元素是否可编辑 - locator.is_editable()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">editable = page.get_by_role(<span class="string">&quot;textbox&quot;</span>).is_editable()</span><br></pre></td></tr></table></figure>

<h6 id="判断元素是否启用-locator-is-enabled"><a href="#判断元素是否启用-locator-is-enabled" class="headerlink" title="判断元素是否启用 - locator.is_enabled()"></a>判断元素是否启用 - locator.is_enabled()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">enabled = page.get_by_role(<span class="string">&quot;button&quot;</span>).is_enabled()</span><br></pre></td></tr></table></figure>

<h6 id="判断元素是否隐藏-locator-is-hidden"><a href="#判断元素是否隐藏-locator-is-hidden" class="headerlink" title="判断元素是否隐藏 - locator.is_hidden()"></a>判断元素是否隐藏 - locator.is_hidden()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">hidden = page.get_by_role(<span class="string">&quot;button&quot;</span>).is_hidden()</span><br></pre></td></tr></table></figure>

<h6 id="判断元素是否可见-locator-is-visible"><a href="#判断元素是否可见-locator-is-visible" class="headerlink" title="判断元素是否可见 - locator.is_visible()"></a>判断元素是否可见 - locator.is_visible()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">visible = page.get_by_role(<span class="string">&quot;button&quot;</span>).is_visible()</span><br></pre></td></tr></table></figure>

<h6 id="按下元素-locator-press"><a href="#按下元素-locator-press" class="headerlink" title="按下元素 - locator.press()"></a>按下元素 - locator.press()</h6><p>类似聚焦匹配的元素并按下的组合键</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line">page.locator(<span class="string">&#x27;a&#x27;</span>).press(<span class="string">&quot;Backspace&quot;</span>)</span><br><span class="line"><span class="string">&#x27;Backspace&#x27;</span> - 回退键</span><br><span class="line"><span class="string">&#x27;ArrowLeft&#x27;</span> - 左方向键</span><br><span class="line"><span class="string">&#x27;ArrowRight&#x27;</span> - 右方向键</span><br><span class="line"><span class="string">&#x27;ArrowUp&#x27;</span> - 上方向键</span><br><span class="line"><span class="string">&#x27;ArrowDown&#x27;</span> - 下方向键</span><br><span class="line"><span class="string">&#x27;Enter&#x27;</span> - 回车键</span><br><span class="line"><span class="string">&#x27;Escape&#x27;</span> - Esc 键</span><br><span class="line"><span class="string">&#x27;Tab&#x27;</span> - Tab 键</span><br><span class="line"><span class="string">&#x27;Space&#x27;</span> - 空格键</span><br><span class="line"><span class="string">&#x27;Delete&#x27;</span> - 删除键</span><br><span class="line"><span class="string">&#x27;Shift&#x27;</span> - Shift 键</span><br><span class="line"><span class="string">&#x27;Control&#x27;</span> - Ctrl 键</span><br><span class="line"><span class="string">&#x27;Alt&#x27;</span> - Alt 键</span><br><span class="line"><span class="string">&#x27;Meta&#x27;</span> - Meta (Windows 徽标键或 Command 键)</span><br><span class="line"><span class="string">&#x27;F1&#x27;</span> - F1 键（对应到 F12 键）</span><br><span class="line"><span class="comment"># mac电脑特殊功能键</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">Delete键：用于删除光标后的字符。在 Playwright 中可通过传递 &quot;Delete&quot; 给 press 方法来模拟按下 Delete 键。</span></span><br><span class="line"><span class="string">Command键（⌘）：作为快捷键的一部分，通常用于复制、粘贴等操作，但不是一个普通字符键。在 Playwright 中可通过传递 &quot;Meta&quot; 给 press 方法来模拟按下 Command 键。</span></span><br><span class="line"><span class="string">Option键（⌥）：用于输入特殊字符、标点符号等。在 Playwright 中可通过传递 &quot;Alt&quot; 给 press 方法来模拟按下 Option 键。</span></span><br><span class="line"><span class="string">Control键（⌃）：用于快捷键操作，在 Playwright 中可通过传递 &quot;Control&quot; 给 press 方法来模拟按下 Control 键。</span></span><br><span class="line"><span class="string">Shift键（⇧）：用于切换大小写、输入符号等。在 Playwright 中可通过传递 &quot;Shift&quot; 给 press 方法来模拟按下 Shift 键。</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h6 id="滚动元素至可见-locator-scroll-into-view-if-needed"><a href="#滚动元素至可见-locator-scroll-into-view-if-needed" class="headerlink" title="滚动元素至可见 - locator.scroll_into_view_if_needed()"></a>滚动元素至可见 - locator.scroll_into_view_if_needed()</h6><p>将滚动到元素可见。这个方法会检查元素是否在视窗内，如果不在的话会自动滚动到元素可见。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用locator定位需要操作的元素  </span></span><br><span class="line">element_locator = page.locator(<span class="string">&#x27;button&#x27;</span>)  </span><br><span class="line"><span class="comment"># 滚动到元素可见  </span></span><br><span class="line">element_locator.scroll_into_view_if_needed()  </span><br><span class="line"><span class="comment"># 进行其他操作，如点击等  </span></span><br><span class="line">element_locator.click()</span><br></pre></td></tr></table></figure>

<h6 id="选择单个或多个select-element-select-option"><a href="#选择单个或多个select-element-select-option" class="headerlink" title="选择单个或多个select - element.select_option()"></a>选择单个或多个select - element.select_option()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot; html</span></span><br><span class="line"><span class="string">&lt;select multiple&gt;</span></span><br><span class="line"><span class="string">  &lt;option value=&quot;red&quot;&gt;Red&lt;/div&gt;</span></span><br><span class="line"><span class="string">  &lt;option value=&quot;green&quot;&gt;Green&lt;/div&gt;</span></span><br><span class="line"><span class="string">  &lt;option value=&quot;blue&quot;&gt;Blue&lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;/select&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">element = page.locator(<span class="string">&#x27;select&#x27;</span>)</span><br><span class="line"><span class="comment"># 单个选项值或标签</span></span><br><span class="line">element.select_option(<span class="string">&quot;blue&quot;</span>)</span><br><span class="line">element.select_option(label=<span class="string">&quot;blue&quot;</span>)</span><br><span class="line"><span class="comment"># 多个选项值或标签</span></span><br><span class="line">element.select_option(value=[<span class="string">&quot;red&quot;</span>, <span class="string">&quot;green&quot;</span>, <span class="string">&quot;blue&quot;</span>])</span><br></pre></td></tr></table></figure>

<h6 id="设置单选框或复选框状态-locator-set-checked"><a href="#设置单选框或复选框状态-locator-set-checked" class="headerlink" title="设置单选框或复选框状态 - locator.set_checked()"></a>设置单选框或复选框状态 - locator.set_checked()</h6><p>设置复选框或单选按钮元素状态。<br>确保匹配的元素是复选框或单选按钮输入<br>将元素滚动到视图中-</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.get_by_role(<span class="string">&quot;checkbox&quot;</span>).set_checked(<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h6 id="获取单选框或复选框状态-locator-is-checked"><a href="#获取单选框或复选框状态-locator-is-checked" class="headerlink" title="获取单选框或复选框状态 - locator.is_checked()"></a>获取单选框或复选框状态 - locator.is_checked()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.get_by_role(<span class="string">&quot;checkbox&quot;</span>).is_checked() <span class="comment"># 返回布尔值</span></span><br></pre></td></tr></table></figure>



<h6 id="取消选中-locator-uncheck"><a href="#取消选中-locator-uncheck" class="headerlink" title="取消选中 - locator.uncheck()"></a>取消选中 - locator.uncheck()</h6><p>确保复选框或单选按钮元素未被选中。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.get_by_role(<span class="string">&quot;checkbox&quot;</span>).uncheck()</span><br></pre></td></tr></table></figure>

<h6 id="等待-locator-wait-for"><a href="#等待-locator-wait-for" class="headerlink" title="等待 - locator.wait_for()"></a>等待 - locator.wait_for()</h6><p>当定位器指定的元素满足 <code>state</code> 选项时返回。<br>如果目标元素已满足条件，则该方法立即返回。否则，将最多等待 <code>timeout</code> 毫秒，直到满足条件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">order_sent = page.locator(<span class="string">&quot;#order-sent&quot;</span>)</span><br><span class="line">order_sent.wait_for()</span><br></pre></td></tr></table></figure>

<h6 id="文件上传-locator-set-input-files"><a href="#文件上传-locator-set-input-files" class="headerlink" title="文件上传 - locator.set_input_files()"></a>文件上传 - locator.set_input_files()</h6><p>将文件或多个文件上传到 <code>&lt;input type=file&gt;</code>。对于具有 <code>[webkitdirectory]</code> 属性的输入，仅支持单个目录路径</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># Select one file</span></span><br><span class="line">page.get_by_label(<span class="string">&quot;Upload file&quot;</span>).set_input_files(<span class="string">&#x27;myfile.pdf&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Select multiple files</span></span><br><span class="line">page.get_by_label(<span class="string">&quot;Upload files&quot;</span>).set_input_files([<span class="string">&#x27;file1.txt&#x27;</span>, <span class="string">&#x27;file2.txt&#x27;</span>])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Select a directory</span></span><br><span class="line">page.get_by_label(<span class="string">&quot;Upload directory&quot;</span>).set_input_files(<span class="string">&#x27;mydir&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># Remove all the selected files</span></span><br><span class="line">page.get_by_label(<span class="string">&quot;Upload file&quot;</span>).set_input_files([])</span><br><span class="line"></span><br><span class="line"><span class="comment"># Upload buffer from memory</span></span><br><span class="line">page.get_by_label(<span class="string">&quot;Upload file&quot;</span>).set_input_files(</span><br><span class="line">    files=[</span><br><span class="line">        &#123;<span class="string">&quot;name&quot;</span>: <span class="string">&quot;test.txt&quot;</span>, <span class="string">&quot;mimeType&quot;</span>: <span class="string">&quot;text/plain&quot;</span>, <span class="string">&quot;buffer&quot;</span>: <span class="string">b&quot;this is a test&quot;</span>&#125;</span><br><span class="line">    ],</span><br><span class="line">)</span><br></pre></td></tr></table></figure>

<h6 id="点击选择器元素-locator-tap"><a href="#点击选择器元素-locator-tap" class="headerlink" title="点击选择器元素 - locator.tap()"></a>点击选择器元素 - locator.tap()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.locator(<span class="string">&#x27;a&#x27;</span>).tap()</span><br></pre></td></tr></table></figure>

<h6 id="返回选择器的第一个元素-locator-first"><a href="#返回选择器的第一个元素-locator-first" class="headerlink" title="返回选择器的第一个元素 - locator.first"></a>返回选择器的第一个元素 - locator.first</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.locator(<span class="string">&#x27;a&#x27;</span>).first</span><br></pre></td></tr></table></figure>

<h6 id="返回选择器的最后一个元素-locator-last"><a href="#返回选择器的最后一个元素-locator-last" class="headerlink" title="返回选择器的最后一个元素 - locator.last"></a>返回选择器的最后一个元素 - locator.last</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.locator(<span class="string">&#x27;a&#x27;</span>).last</span><br></pre></td></tr></table></figure>

<h6 id="获取第n个元素-locator-nth"><a href="#获取第n个元素-locator-nth" class="headerlink" title="获取第n个元素 - locator.nth()"></a>获取第n个元素 - locator.nth()</h6><p>返回第 n 个匹配元素的定位器。它是从零开始的，<code>nth(0)</code> 选择第一个元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.locator(<span class="string">&#x27;a&#x27;</span>).nth(<span class="number">2</span>) <span class="comment"># 返回定位的所有a标签的3个元素</span></span><br></pre></td></tr></table></figure>

<h6 id="返回当前元素页面信息-locator-page"><a href="#返回当前元素页面信息-locator-page" class="headerlink" title="返回当前元素页面信息 - locator.page"></a>返回当前元素页面信息 - locator.page</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.locator(<span class="string">&#x27;a&#x27;</span>).page</span><br></pre></td></tr></table></figure>



<p>选择器（Selector）是用于创建定位器的字符串。Playwright 支持许多不同的选择器，比如 Text、CSS、XPath 等。阅读 in-depth guide 文档，了解更多关于可用的选择器以及如何进行选择的信息。</p>
<h5 id="page-select-下拉选项"><a href="#page-select-下拉选项" class="headerlink" title="page.select() 下拉选项"></a>page.select() 下拉选项</h5><p>它可以根据 option 元素的值、文本内容或索引来选择下拉列表中的选项。</p>
<h6 id="基本使用"><a href="#基本使用" class="headerlink" title="基本使用"></a>基本使用</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过值选择选项  </span></span><br><span class="line">page.select(<span class="string">&#x27;select#fruits&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过文本内容选择选项  </span></span><br><span class="line">page.select(<span class="string">&#x27;select#fruits&#x27;</span>, &#123; label: <span class="string">&#x27;Banana&#x27;</span> &#125;)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过索引选择选项  </span></span><br><span class="line">page.select(<span class="string">&#x27;select#fruits&#x27;</span>, &#123; index: <span class="number">2</span> &#125;)</span><br><span class="line"></span><br><span class="line"><span class="keyword">await</span> page.selectOption(<span class="string">&#x27;select#fruits&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h6 id="多选下拉列表"><a href="#多选下拉列表" class="headerlink" title="多选下拉列表"></a>多选下拉列表</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.select(<span class="string">&#x27;select#fruits&#x27;</span>, [<span class="string">&#x27;apple&#x27;</span>, <span class="string">&#x27;banana&#x27;</span>])</span><br></pre></td></tr></table></figure>

<h6 id="超时设置"><a href="#超时设置" class="headerlink" title="超时设置"></a>超时设置</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.select(<span class="string">&#x27;select#fruits&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>, timeout=<span class="number">5000</span>)</span><br></pre></td></tr></table></figure>

<h6 id="联动选择"><a href="#联动选择" class="headerlink" title="联动选择"></a>联动选择</h6><p>在某些情况下，下拉列表的选项会受到先前的选择而改变。可以使用<code>waitForElementState</code>方法来等待元素变为可选择状态。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">await</span> page.waitForElementState(<span class="string">&#x27;select#fruits&#x27;</span>, <span class="string">&#x27;visible&#x27;</span>)  </span><br><span class="line"><span class="keyword">await</span> page.select(<span class="string">&#x27;select#fruits&#x27;</span>, <span class="string">&#x27;apple&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h5 id="内置定位器"><a href="#内置定位器" class="headerlink" title="内置定位器"></a>内置定位器</h5><h6 id="page-get-by-role-通过显式和隐式可访问性属性进行定位。role属性"><a href="#page-get-by-role-通过显式和隐式可访问性属性进行定位。role属性" class="headerlink" title="page.get_by_role()通过显式和隐式可访问性属性进行定位。role属性"></a><code>page.get_by_role()</code>通过显式和隐式可访问性属性进行定位。<em>role属性</em></h6><p>用于根据 role 属性来定位元素。<br>ARIA(无障碍开发) role属性, 有些元素隐式存在role属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot; html</span></span><br><span class="line"><span class="string">&lt;label&gt;</span></span><br><span class="line"><span class="string">  &lt;input type=&quot;checkbox&quot; /&gt; Subscribe</span></span><br><span class="line"><span class="string">&lt;/label&gt;</span></span><br><span class="line"><span class="string">&lt;br/&gt;</span></span><br><span class="line"><span class="string">&lt;button&gt;Submit&lt;/button&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">page.get_by_role(<span class="string">&quot;checkbox&quot;</span>, name=<span class="string">&quot;Subscribe&quot;</span>).check()</span><br><span class="line">page.get_by_role(<span class="string">&quot;button&quot;</span>, name=re.<span class="built_in">compile</span>(<span class="string">&quot;submit&quot;</span>, re.IGNORECASE)).click()</span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">role: &quot;alert&quot; | &quot;alertdialog&quot; | &quot;application&quot; | &quot;article&quot; | &quot;banner&quot; | &quot;blockquote&quot; | &quot;button&quot; | &quot;caption&quot; | &quot;cell&quot; | &quot;checkbox&quot; | &quot;code&quot; | &quot;columnheader&quot; | &quot;combobox&quot; | &quot;complementary&quot; | &quot;contentinfo&quot; | &quot;definition&quot; | &quot;deletion&quot; | &quot;dialog&quot; | &quot;directory&quot; | &quot;document&quot; | &quot;emphasis&quot; | &quot;feed&quot; | &quot;figure&quot; | &quot;form&quot; | &quot;generic&quot; | &quot;grid&quot; | &quot;gridcell&quot; | &quot;group&quot; | &quot;heading&quot; | &quot;img&quot; | &quot;insertion&quot; | &quot;link&quot; | &quot;list&quot; | &quot;listbox&quot; | &quot;listitem&quot; | &quot;log&quot; | &quot;main&quot; | &quot;marquee&quot; | &quot;math&quot; | &quot;meter&quot; | &quot;menu&quot; | &quot;menubar&quot; | &quot;menuitem&quot; | &quot;menuitemcheckbox&quot; | &quot;menuitemradio&quot; | &quot;navigation&quot; | &quot;none&quot; | &quot;note&quot; | &quot;option&quot; | &quot;paragraph&quot; | &quot;presentation&quot; | &quot;progressbar&quot; | &quot;radio&quot; | &quot;radiogroup&quot; | &quot;region&quot; | &quot;row&quot; | &quot;rowgroup&quot; | &quot;rowheader&quot; | &quot;scrollbar&quot; | &quot;search&quot; | &quot;searchbox&quot; | &quot;separator&quot; | &quot;slider&quot; | &quot;spinbutton&quot; | &quot;status&quot; | &quot;strong&quot; | &quot;subscript&quot; | &quot;superscript&quot; | &quot;switch&quot; | &quot;tab&quot; | &quot;table&quot; | &quot;tablist&quot; | &quot;tabpanel&quot; | &quot;term&quot; | &quot;textbox&quot; | &quot;time&quot; | &quot;timer&quot; | &quot;toolbar&quot; | &quot;tooltip&quot; | &quot;tree&quot; | &quot;treegrid&quot; | &quot;treeitem&quot;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>

<h6 id="page-get-by-text-通过文本内容定位。"><a href="#page-get-by-text-通过文本内容定位。" class="headerlink" title="page.get_by_text()通过文本内容定位。"></a><code>page.get_by_text()</code>通过文本内容定位。</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot; html</span></span><br><span class="line"><span class="string">&lt;div&gt;Hello &lt;span&gt;world&lt;/span&gt;&lt;/div&gt;</span></span><br><span class="line"><span class="string">&lt;div&gt;Hello&lt;/div&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="comment"># 匹配 &lt;span&gt;</span></span><br><span class="line">page.get_by_text(<span class="string">&quot;world&quot;</span>)</span><br><span class="line"><span class="comment"># 匹配第一个 &lt;div&gt;</span></span><br><span class="line">page.get_by_text(<span class="string">&quot;Hello world&quot;</span>)</span><br><span class="line"><span class="comment"># 匹配第二个 &lt;div&gt;</span></span><br><span class="line">page.get_by_text(<span class="string">&quot;Hello&quot;</span>, exact=<span class="literal">True</span>)</span><br><span class="line"><span class="comment"># 匹配多个 &lt;div&gt;</span></span><br><span class="line">page.get_by_text(re.<span class="built_in">compile</span>(<span class="string">&quot;Hello&quot;</span>))</span><br><span class="line"><span class="comment"># 匹配第二个 &lt;div&gt;</span></span><br><span class="line">page.get_by_text(re.<span class="built_in">compile</span>(<span class="string">&quot;^hello$&quot;</span>, re.IGNORECASE))</span><br></pre></td></tr></table></figure>

<h6 id="page-get-by-label-通过关联标签的文本定位表单控件。"><a href="#page-get-by-label-通过关联标签的文本定位表单控件。" class="headerlink" title="page.get_by_label()通过关联标签的文本定位表单控件。"></a><code>page.get_by_label()</code>通过关联标签的文本定位表单控件。</h6><p>用于根据标签文本来定位元素。<br>允许通过关联的 <code>&lt;label&gt;</code> 或 <code>aria-labelledby</code> 元素的文本，或通过 <code>aria-label</code> 属性来定位输入元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot; html</span></span><br><span class="line"><span class="string">&lt;input aria-label=&quot;Username&quot;&gt;</span></span><br><span class="line"><span class="string">&lt;label for=&quot;password-input&quot;&gt;Password:&lt;/label&gt;</span></span><br><span class="line"><span class="string">&lt;input id=&quot;password-input&quot;&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">page.get_by_label(<span class="string">&quot;Username&quot;</span>).fill(<span class="string">&quot;john&quot;</span>)</span><br><span class="line">page.get_by_label(<span class="string">&quot;Password&quot;</span>).fill(<span class="string">&quot;secret&quot;</span>)</span><br></pre></td></tr></table></figure>

<h6 id="page-get-by-placeholder-按占位符定位输入。"><a href="#page-get-by-placeholder-按占位符定位输入。" class="headerlink" title="page.get_by_placeholder()按占位符定位输入。"></a><code>page.get_by_placeholder()</code>按占位符定位输入。</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;input type=&quot;email&quot; placeholder=&quot;请输入账号&quot;/&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">page.get_by_placeholder(<span class="string">&quot;请输入账号&quot;</span>)</span><br></pre></td></tr></table></figure>

<h6 id="page-get-by-alt-text-通过替代文本定位元素，通常是图像。"><a href="#page-get-by-alt-text-通过替代文本定位元素，通常是图像。" class="headerlink" title="page.get_by_alt_text()通过替代文本定位元素，通常是图像。"></a><code>page.get_by_alt_text()</code>通过替代文本定位元素，通常是图像。</h6><p>用于根据元素的 <code>alt</code> 属性文本值来定位元素的内置方法是<code>page.locator()</code>结合<code>image</code>标签的<code>alt</code>属性，或结合<code>aria-label</code>属性等</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot; html</span></span><br><span class="line"><span class="string">&lt;img alt=&#x27;Playwright logo&#x27;&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">image1 = page.locator.get_by_alt_text(<span class="string">&#x27;Playwright logo&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h6 id="page-get-by-title-通过标题属性定位元素。"><a href="#page-get-by-title-通过标题属性定位元素。" class="headerlink" title="page.get_by_title()通过标题属性定位元素。"></a><code>page.get_by_title()</code>通过标题属性定位元素。</h6><p>允许根据元素的 title 属性定位元素</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot; html</span></span><br><span class="line"><span class="string">&lt;span title=&#x27;Issues count&#x27;&gt;25 issues&lt;/span&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">expect(page.get_by_title(<span class="string">&quot;Issues count&quot;</span>)).to_have_text(<span class="string">&quot;25 issues&quot;</span>)</span><br></pre></td></tr></table></figure>

<h6 id="page-get-by-test-id-根据data-testid属性定位元素可以配置其他属性）"><a href="#page-get-by-test-id-根据data-testid属性定位元素可以配置其他属性）" class="headerlink" title="page.get_by_test_id()根据data-testid属性定位元素可以配置其他属性）"></a><code>page.get_by_test_id()</code>根据data-testid属性定位元素可以配置其他属性）</h6><p>按测试 ID 定位元素。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot; html</span></span><br><span class="line"><span class="string">&lt;button data-testid=&quot;directions&quot;&gt;Itinéraire&lt;/button&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">page.get_by_test_id(<span class="string">&quot;directions&quot;</span>).click()</span><br></pre></td></tr></table></figure>



<h6 id="locator-get-by-placeholder-通过占位符文本定位输入元素。"><a href="#locator-get-by-placeholder-通过占位符文本定位输入元素。" class="headerlink" title="locator.get_by_placeholder( )  通过占位符文本定位输入元素。"></a>locator.get_by_placeholder( )  通过占位符文本定位输入元素。</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&quot;&quot;&quot; html</span></span><br><span class="line"><span class="string">&lt;input type=&quot;email&quot; placeholder=&quot;name@example.com&quot; /&gt;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">page.get_by_placeholder(<span class="string">&quot;name@example.com&quot;</span>).fill(<span class="string">&quot;playwright@microsoft.com&quot;</span>)</span><br></pre></td></tr></table></figure>

<h4 id="page操作"><a href="#page操作" class="headerlink" title="page操作"></a>page操作</h4><h5 id="方法"><a href="#方法" class="headerlink" title="方法"></a>方法</h5><h6 id="打开页面-page-goto"><a href="#打开页面-page-goto" class="headerlink" title="打开页面 - page.goto()"></a>打开页面 - <code>page.goto()</code></h6><ul>
<li><p>参数</p>
<ul>
<li><p><code>url</code> - 跳转或打开的url</p>
</li>
<li><p><code>referer</code> - 设置页面导航的引用url，模拟用户从某个特定页面跳转过来</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.goto(url, referer=<span class="string">&quot;https://example.com&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>timeout</code> - 超时时间， 单位毫秒</p>
</li>
<li><p><code>wait_until</code> - 等待条件</p>
<ul>
<li>load : 等待页面完全加载</li>
<li>domcontentloaded : 等待DOM内容加载完成</li>
<li>network：等待所有请求完毕</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.goto(url, wait_until=[<span class="string">&#x27;load&#x27;</span>, <span class="string">&#x27;domcontentloaded&#x27;</span>])</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h6 id="获取标题名称-page-title"><a href="#获取标题名称-page-title" class="headerlink" title="获取标题名称 - page.title()"></a>获取标题名称 - <code>page.title()</code></h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取页面标题  </span></span><br><span class="line">title = page.title()  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Page title:&quot;</span>, title)  </span><br></pre></td></tr></table></figure>

<h6 id="获取页面html内容-page-content"><a href="#获取页面html内容-page-content" class="headerlink" title="获取页面html内容 - page.content()"></a>获取页面<code>html</code>内容 - <code>page.content()</code></h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 获取页面的HTML内容,包括文档类型声明</span></span><br><span class="line">content = page.content()  </span><br><span class="line"><span class="built_in">print</span>(<span class="string">&quot;Page content:&quot;</span>, content)  </span><br></pre></td></tr></table></figure>

<h6 id="关闭页面-page-close"><a href="#关闭页面-page-close" class="headerlink" title="关闭页面 - page.close()"></a>关闭页面 - <code>page.close()</code></h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.close()</span><br></pre></td></tr></table></figure>

<h6 id="判断页面是否关闭-page-is-closed"><a href="#判断页面是否关闭-page-is-closed" class="headerlink" title="判断页面是否关闭 - page.is_closed()"></a>判断页面是否关闭 - page.is_closed()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 判断页面是否关闭</span></span><br><span class="line"><span class="keyword">if</span> <span class="keyword">not</span> page.is_closed():</span><br></pre></td></tr></table></figure>

<h6 id="刷新页面-page-reload"><a href="#刷新页面-page-reload" class="headerlink" title="刷新页面 - page.reload()"></a>刷新页面 - <code>page.reload()</code></h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 刷新当前页面</span></span><br><span class="line">page.reload()</span><br></pre></td></tr></table></figure>

<h6 id="返回上一页历史-page-go-back"><a href="#返回上一页历史-page-go-back" class="headerlink" title="返回上一页历史 - page.go_back()"></a>返回上一页历史 - <code>page.go_back()</code></h6><p>如果有多个重定向，则导航将使用最后一个重定向的响应进行解析。如果无法前进，则返回 <code>null</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.go_back()</span><br></pre></td></tr></table></figure>

<h6 id="跳转下一页历史-page-go-forward"><a href="#跳转下一页历史-page-go-forward" class="headerlink" title="跳转下一页历史 - page.go_forward()"></a>跳转下一页历史 - <code>page.go_forward()</code></h6><p>如果有多个重定向，则导航将使用最后一个重定向的响应进行解析。如果无法前进，则返回 <code>null</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.go_forward()</span><br></pre></td></tr></table></figure>

<h6 id="页面截图-page-screenshot-options"><a href="#页面截图-page-screenshot-options" class="headerlink" title="页面截图 - page.screenshot(options)"></a>页面截图 - <code>page.screenshot(options)</code></h6><ul>
<li><p>options</p>
<ul>
<li><p>path</p>
<p>保存路径及截图名</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.screenshot(path=<span class="string">&quot;./images/a.png&quot;</span>)</span><br></pre></td></tr></table></figure></li>
</ul>
</li>
</ul>
<h6 id="等待页面元素加载成功-page-wait-for-selector-selector-timeout-1000"><a href="#等待页面元素加载成功-page-wait-for-selector-selector-timeout-1000" class="headerlink" title="等待页面元素加载成功 - page.wait_for_selector(selector, timeout=1000)"></a>等待页面元素加载成功 - <code>page.wait_for_selector(selector, timeout=1000)</code></h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在页面上等待直到出现具有 class 为 &#x27;example&#x27; 的元素  </span></span><br><span class="line">element = page.wait_for_selector(<span class="string">&#x27;.example&#x27;</span>, timeout=<span class="number">1000</span>)  </span><br><span class="line"><span class="keyword">if</span> element:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;找到了具有 class 为 &#x27;example&#x27; 的元素&quot;</span>)  </span><br><span class="line">    <span class="comment"># 对找到的元素进行操作  </span></span><br><span class="line"><span class="keyword">else</span>:  </span><br><span class="line">	<span class="built_in">print</span>(<span class="string">&quot;超时：未找到匹配的元素&quot;</span>)</span><br></pre></td></tr></table></figure>

<h6 id="在页面中执行-JavaScript-代码-page-evaluate-script"><a href="#在页面中执行-JavaScript-代码-page-evaluate-script" class="headerlink" title="在页面中执行 JavaScript 代码 - page.evaluate(script)"></a>在页面中执行 JavaScript 代码 - <code>page.evaluate(script)</code></h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用 evaluate 方法执行 JavaScript 代码，结果返回js代码的返回值</span></span><br><span class="line">result = page.evaluate(<span class="string">&#x27;&#x27;&#x27;() =&gt; &#123;  </span></span><br><span class="line"><span class="string">        return 2 + 3;  </span></span><br><span class="line"><span class="string">    &#125;&#x27;&#x27;&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(result) <span class="comment"># 输出结果为 5  </span></span><br></pre></td></tr></table></figure>

<h6 id="设置页面视口大小-page-set-viewport-size-width-height"><a href="#设置页面视口大小-page-set-viewport-size-width-height" class="headerlink" title="设置页面视口大小 - page.set_viewport_size(width, height)"></a>设置页面视口大小 - <code>page.set_viewport_size(width, height)</code></h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">要实现窗口最大化，且适应所有设备，需要使用 p.__class__.screen 来动态获取窗口宽高达到适应所有设备</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">from</span> playwright.sync_api <span class="keyword">import</span> sync_playwright  </span><br><span class="line"></span><br><span class="line">playwright = sync_playwright().start() </span><br><span class="line"><span class="comment"># 获取设备宽高</span></span><br><span class="line">screen = playwright.__class__.screen  </span><br><span class="line">screen_primary = screen.screen_primary()  </span><br><span class="line">width = screen_primary.available_width  </span><br><span class="line">height = screen_primary.available_height  </span><br><span class="line"><span class="comment"># 启动浏览器</span></span><br><span class="line">browser = p.chromium.launch(headless=<span class="literal">False</span>)</span><br><span class="line"><span class="comment"># 创建浏览器的上下文</span></span><br><span class="line">context = browser.new_context()</span><br><span class="line"><span class="comment"># 创建一个页面</span></span><br><span class="line">page = context.new_page()</span><br><span class="line"><span class="comment"># 打开页面</span></span><br><span class="line">page.goto(<span class="string">&quot;https://www.baidu.com&quot;</span>)</span><br><span class="line"><span class="comment"># 全屏</span></span><br><span class="line">page.set_viewport_size(width, height)</span><br><span class="line">page.close()</span><br><span class="line">context.close()</span><br><span class="line">browser.close()</span><br></pre></td></tr></table></figure>

<h6 id="模拟键盘输入-page-type-selector-text"><a href="#模拟键盘输入-page-type-selector-text" class="headerlink" title="模拟键盘输入 - page.type(selector, text)"></a>模拟键盘输入 - <code>page.type(selector, text)</code></h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">page.<span class="built_in">type</span>(<span class="string">&#x27;#kw&#x27;</span>, <span class="string">&#x27;asdf&#x27;</span>)</span><br><span class="line"><span class="comment"># 也可以在定位器后面操作</span></span><br><span class="line">page.locator(<span class="string">&#x27;#kw&#x27;</span>).<span class="built_in">type</span>(<span class="string">&#x27;asdf&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h6 id="模拟键盘输入-page-fill-selector-text"><a href="#模拟键盘输入-page-fill-selector-text" class="headerlink" title="模拟键盘输入 - page.fill(selector, text)"></a>模拟键盘输入 - <code>page.fill(selector, text)</code></h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">page.fill(<span class="string">&#x27;#kw&#x27;</span>, <span class="string">&#x27;asdf&#x27;</span>)</span><br><span class="line"><span class="comment"># 也可以在定位后面操作</span></span><br><span class="line">page.locator(<span class="string">&#x27;#kw&#x27;</span>).fill(<span class="string">&#x27;asdf&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h6 id="清空输入框内容-page-clear"><a href="#清空输入框内容-page-clear" class="headerlink" title="清空输入框内容 - page.clear()"></a>清空输入框内容 - page.clear()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.locator(<span class="string">&#x27;#kw&#x27;</span>).clear()</span><br></pre></td></tr></table></figure>

<h6 id="模拟鼠标点击-page-click-selector"><a href="#模拟鼠标点击-page-click-selector" class="headerlink" title="模拟鼠标点击 - page.click(selector)"></a>模拟鼠标点击 - <code>page.click(selector)</code></h6><ul>
<li>参数<ul>
<li>button - left(左键)、right(右键)、middle(中键)、默认left</li>
<li>click_count - 点击次数，默认为1</li>
<li>delay - 按下、释放间隔时间</li>
<li>modifiers - 同时要按下的修饰键：’Alt’ | ‘Control’ | ‘ControlOrMeta’ | ‘Meta’ | ‘Shift’</li>
<li>position - 点击的坐标位置：{x:10, y:20}</li>
<li>timeout - 等待元素可点击时间，超过即超时</li>
<li>force - 释放绕过可操作性检查</li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">page.fill(<span class="string">&#x27;#kw&#x27;</span>)</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">page.locator(<span class="string">&#x27;#kw&#x27;</span>).click()</span><br></pre></td></tr></table></figure>

<h6 id="模拟鼠标双击-page-dblclick-selector"><a href="#模拟鼠标双击-page-dblclick-selector" class="headerlink" title="模拟鼠标双击 - page.dblclick(selector)"></a>模拟鼠标双击 - page.dblclick(selector)</h6><p>参考click()</p>
<h6 id="模拟鼠标悬停-page-hover-selector"><a href="#模拟鼠标悬停-page-hover-selector" class="headerlink" title="模拟鼠标悬停 - page.hover(selector)"></a>模拟鼠标悬停 - page.hover(selector)</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.locator(<span class="string">&#x27;#kw&#x27;</span>).hover</span><br></pre></td></tr></table></figure>

<h6 id="获取页面上的所有链接-page-query-selector-all-a"><a href="#获取页面上的所有链接-page-query-selector-all-a" class="headerlink" title="获取页面上的所有链接 - page.query_selector_all(&#39;a&#39;)"></a>获取页面上的所有链接 - <code>page.query_selector_all(&#39;a&#39;)</code></h6><p>返回所有page中’a’标签，返回JSHandle对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">element1 = page.querySelector(<span class="string">&#x27;button&#x27;</span>)</span><br><span class="line">element2 = page.query_selector_all(<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(element1, element2)</span><br></pre></td></tr></table></figure>

<h6 id="设置单选框或复选框的状态-page-set-checked"><a href="#设置单选框或复选框的状态-page-set-checked" class="headerlink" title="设置单选框或复选框的状态 - page.set_checked()"></a>设置单选框或复选框的状态 - <code>page.set_checked()</code></h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.get_by_role(<span class="string">&quot;checkbox&quot;</span>).set_checked(<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h6 id="取消选中的单选框-page-uncheck"><a href="#取消选中的单选框-page-uncheck" class="headerlink" title="取消选中的单选框 - page.uncheck()"></a>取消选中的单选框 - <code>page.uncheck()</code></h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.get_by_role(<span class="string">&quot;checkbox&quot;</span>).uncheck()</span><br></pre></td></tr></table></figure>

<h6 id="select下拉框选项-page-select-option"><a href="#select下拉框选项-page-select-option" class="headerlink" title="select下拉框选项 - page.select_option()"></a>select下拉框选项 - <code>page.select_option()</code></h6><ul>
<li><p>选中一个值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.locator(<span class="string">&#x27;#city&#x27;</span>).selector_option(<span class="string">&#x27;shenzhen&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>选中多个值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.locator(<span class="string">&#x27;#city&#x27;</span>).selector_option(value=[<span class="string">&#x27;shenzhen&#x27;</span>,<span class="string">&#x27;guangzhou&#x27;</span>,<span class="string">&#x27;dongguan&#x27;</span>])</span><br></pre></td></tr></table></figure></li>
</ul>
<h6 id="文件上传-page-set-input-files"><a href="#文件上传-page-set-input-files" class="headerlink" title="文件上传 - page.set_input_files()"></a>文件上传 - <code>page.set_input_files()</code></h6><ul>
<li><p>单文件上传</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.locator(<span class="string">&#x27;#upload&#x27;</span>).set_input_files(<span class="string">&#x27;myfile.pdf&#x27;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>上传多个文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.locator(<span class="string">&#x27;#upload&#x27;</span>).set_input_files([<span class="string">&#x27;myfile1.pdf&#x27;</span>, <span class="string">&#x27;myfile2.pdf&#x27;</span>])</span><br></pre></td></tr></table></figure></li>
</ul>
<h6 id="元素拖拽-page-drag-and-drop"><a href="#元素拖拽-page-drag-and-drop" class="headerlink" title="元素拖拽 - page.drag_and_drop()"></a>元素拖拽 - <code>page.drag_and_drop()</code></h6><ul>
<li><p><strong>参数</strong></p>
<ul>
<li><p><code>source</code> </p>
<p>用于搜索要拖动元素的选择器。如果有多个元素满足选择器，则将使用第一个元素。</p>
</li>
<li><p><code>target</code></p>
<p>用于搜索要放置元素的选择器。如果有多个元素满足选择器，则将使用第一个元素。</p>
</li>
<li><p><code>source_position</code> （可选）相对于元素填充框的左上角单击此点上的源元素。如果未指定，则使用元素的某个可见点。</p>
<ul>
<li><code>x</code> </li>
<li><code>y</code></li>
</ul>
</li>
<li><p><code>target_position</code>（可选）相对于元素填充框的左上角放置在目标元素上的此点。如果未指定，则使用元素的某个可见点。</p>
<ul>
<li><code>x</code> </li>
<li><code>y</code></li>
</ul>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">source = page.locator(<span class="string">&#x27;#source&#x27;</span>)</span><br><span class="line">target = page.locator(<span class="string">&#x27;#target&#x27;</span>)</span><br><span class="line">page.drag_and_drop(<span class="string">&quot;#source&quot;</span>, <span class="string">&quot;#target&quot;</span>)</span><br><span class="line"><span class="comment"># or specify exact positions relative to the top-left corners of the elements:</span></span><br><span class="line">page.drag_and_drop(</span><br><span class="line">  <span class="string">&quot;#source&quot;</span>,</span><br><span class="line">  <span class="string">&quot;#target&quot;</span>,</span><br><span class="line">  source_position=&#123;<span class="string">&quot;x&quot;</span>: <span class="number">34</span>, <span class="string">&quot;y&quot;</span>: <span class="number">7</span>&#125;,</span><br><span class="line">  target_position=&#123;<span class="string">&quot;x&quot;</span>: <span class="number">10</span>, <span class="string">&quot;y&quot;</span>: <span class="number">20</span>&#125;</span><br><span class="line">)</span><br></pre></td></tr></table></figure></li>
</ul>
<h6 id="聚焦元素-page-focus"><a href="#聚焦元素-page-focus" class="headerlink" title="聚焦元素 - page.focus()"></a>聚焦元素 - <code>page.focus()</code></h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.locator(<span class="string">&quot;#source&quot;</span>).focus()</span><br></pre></td></tr></table></figure>

<h6 id="用于模拟按下和释放键盘按键的操作-press"><a href="#用于模拟按下和释放键盘按键的操作-press" class="headerlink" title="用于模拟按下和释放键盘按键的操作 - press()"></a>用于模拟按下和释放键盘按键的操作 - press()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模拟按下回车键  </span></span><br><span class="line">page.press(<span class="string">&#x27;Enter&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h6 id="对话框"><a href="#对话框" class="headerlink" title="对话框"></a>对话框</h6><ul>
<li>page.on()</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用page.on监听dialog事件，监听并处理弹窗  </span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">handle_dialog</span>(<span class="params">dialog</span>):  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;Dialog message: <span class="subst">&#123;dialog.message&#125;</span>&#x27;</span>)  </span><br><span class="line">        <span class="keyword">if</span> dialog.<span class="built_in">type</span> == <span class="string">&#x27;alert&#x27;</span>:  </span><br><span class="line">            dialog.accept()  </span><br><span class="line">        <span class="keyword">elif</span> dialog.<span class="built_in">type</span> == <span class="string">&#x27;confirm&#x27;</span>:  </span><br><span class="line">            dialog.dismiss()  <span class="comment"># 或者 dialog.accept() 来接受弹窗  </span></span><br><span class="line"></span><br><span class="line">    page.on(<span class="string">&#x27;dialog&#x27;</span>, handle_dialog)  </span><br></pre></td></tr></table></figure>

<ul>
<li><p><strong>dialog方法&amp;属性 解析</strong></p>
</li>
<li><p>dialog 方法</p>
<ul>
<li><p>dialog.accept(prompt_text)</p>
<p>prompt_text 指要在提示中输入的文本。如果对话框的 <code>type</code> 不是提示，则不会产生任何效果</p>
</li>
<li><p>dialog.dismiss()</p>
<p>在关闭对话框后返回。</p>
</li>
</ul>
</li>
<li><p>dialog 属性</p>
<ul>
<li><p>dialog.default_value</p>
<p>如果对话框是提示，则返回默认提示值。否则，返回空字符串。</p>
</li>
<li><p>dialog.message</p>
<p>对话框中显示的消息。</p>
</li>
<li><p>dialog.page</p>
<p>启动此对话框的页面</p>
</li>
<li><p>dialog.type</p>
<p>返回对话框的类型，可以是 <code>alert</code>、<code>beforeunload</code>、<code>confirm</code> 或 <code>prompt</code> 之一。</p>
</li>
</ul>
</li>
</ul>
<h6 id="下载"><a href="#下载" class="headerlink" title="下载"></a>下载</h6><ul>
<li><p>page.on(filename)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">browser = p.chromium.launch()  </span><br><span class="line">   page = browser.new_page()  </span><br><span class="line"></span><br><span class="line">   <span class="comment"># 监听并处理下载  </span></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">handle_download</span>(<span class="params">download</span>):  </span><br><span class="line">       download_path = <span class="string">f&quot;/path/to/save/<span class="subst">&#123;download.suggested_filename&#125;</span>&quot;</span>  </span><br><span class="line">       download.path = download_path  </span><br><span class="line">       <span class="built_in">print</span>(<span class="string">f&quot;Download started: <span class="subst">&#123;download.url&#125;</span>, saving to <span class="subst">&#123;download_path&#125;</span>&quot;</span>)  </span><br><span class="line">   <span class="comment"># 添加下载监听</span></span><br><span class="line">   page.on(<span class="string">&quot;download&quot;</span>, handle_download)  </span><br><span class="line">   <span class="comment"># 打开一个页面，包含下载链接  </span></span><br><span class="line">   page.goto(<span class="string">&#x27;https://www.example.com&#x27;</span>)  </span><br><span class="line">   <span class="comment"># 点击触发下载的链接  </span></span><br><span class="line">   page.click(<span class="string">&#x27;a#download-btn&#x27;</span>)  </span><br><span class="line">   <span class="comment"># 等待下载完成  </span></span><br><span class="line">   <span class="keyword">with</span> page.expect_download() <span class="keyword">as</span> download_info:  </span><br><span class="line">       download_info.save_as(<span class="string">&#x27;/path/to/save/file.txt&#x27;</span>)  </span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>download方法&amp;属性 解析</strong></p>
</li>
<li><p>download 方法</p>
<ul>
<li>download.cancel()</li>
</ul>
<p>取消下载。如果下载已经完成或取消，则不会失败。成功取消后，<code>download.failure()</code> 将解析为 <code>&#39;canceled&#39;</code>。</p>
<ul>
<li>download.delete()</li>
</ul>
<p>删除已下载的文件。如有必要，将等待下载完成。</p>
<ul>
<li>download.failure()</li>
</ul>
<p>如果存在下载错误，则返回该错误。如有必要，将等待下载完成。</p>
<ul>
<li>download.path()</li>
</ul>
<p>返回成功下载的已下载文件路径，如果下载失败&#x2F;取消，则抛出异常。如有必要，该方法将等待下载完成。</p>
<ul>
<li>download.save_as(“&#x2F;path&#x2F;to&#x2F;save&#x2F;at&#x2F;“ + download.suggested_filename)</li>
</ul>
<p>另存外方法。下载仍在进行中时，可以安全地调用此方法。</p>
</li>
<li><p>download 属性</p>
<ul>
<li><p>download.page</p>
<p>获取下载所属的页面。</p>
</li>
<li><p>download.suggested_filename</p>
<p>返回此下载的建议文件名。</p>
</li>
<li><p>download.url</p>
<p>返回下载的网址。</p>
</li>
</ul>
</li>
</ul>
<h6 id="文件上传"><a href="#文件上传" class="headerlink" title="文件上传"></a>文件上传</h6><ul>
<li><p>page.on(“filechooser”, handle_file_chooser)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">handle_file_chooser</span>(<span class="params">file_chooser</span>):  </span><br><span class="line">        <span class="comment"># 上传文件，file_chooser.accept([&quot;绝对路径文件名&quot;])  </span></span><br><span class="line">        file_chooser.accept([<span class="string">&quot;/path/to/file.txt&quot;</span>])  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;File uploaded successfully&quot;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 监听文件选择器事件  </span></span><br><span class="line">page.on(<span class="string">&quot;filechooser&quot;</span>, handle_file_chooser)  </span><br><span class="line">page.goto(<span class="string">&#x27;https://www.example.com&#x27;</span>)  </span><br><span class="line"><span class="comment"># 找到上传文件的input元素  </span></span><br><span class="line">upload_input = page.locator(<span class="string">&#x27;input[type=&quot;file&quot;]&#x27;</span>)  </span><br><span class="line"><span class="comment"># 触发文件选择器并上传文件  </span></span><br><span class="line">upload_input.set_input_files(<span class="string">&quot;/path/to/file.txt&quot;</span>)  </span><br></pre></td></tr></table></figure>
</li>
<li><p>方法</p>
<ul>
<li><p>file_chooser.set_files(files)</p>
<p>设置此选择器关联的文件输入的值</p>
</li>
</ul>
</li>
<li><p>属性</p>
<ul>
<li><p>file_chooser.element</p>
<p>返回与此文件选择器关联的输入元素。</p>
</li>
<li><p>file_chooser.is_multiple()</p>
<p>返回此文件选择器是否接受多个文件。</p>
</li>
<li><p>file_chooser.page</p>
<p>返回此文件选择器所属的页面。</p>
</li>
</ul>
</li>
</ul>
<h6 id="iframe"><a href="#iframe" class="headerlink" title="iframe"></a>iframe</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">browser = p.chromium.launch()  </span><br><span class="line">page = browser.new_page()  </span><br><span class="line"></span><br><span class="line">page.goto(<span class="string">&#x27;https://www.example.com&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 找到包含 iframe 的元素  </span></span><br><span class="line">iframe_element = page.locator(<span class="string">&#x27;iframe#my-iframe&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 进入 iframe 内部  </span></span><br><span class="line">frame = iframe_element.content_frame()  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 iframe 内部执行操作，比如查找元素并进行点击  </span></span><br><span class="line">frame.click(<span class="string">&#x27;button#submit-button&#x27;</span>)  </span><br><span class="line"></span><br><span class="line">browser.close()  </span><br></pre></td></tr></table></figure>

<h6 id="注册自定义的定位器处理程序-page-add-locator-handler"><a href="#注册自定义的定位器处理程序-page-add-locator-handler" class="headerlink" title="注册自定义的定位器处理程序 - page.add_locator_handler()"></a>注册自定义的定位器处理程序 - page.add_locator_handler()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 自定义的定位器处理程序，用于根据元素的文本内容来定位元素  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">text_locator_handler</span>(<span class="params">page, text</span>):  </span><br><span class="line">    <span class="keyword">return</span> page.locator(<span class="string">f&#x27;//*[text()=&quot;<span class="subst">&#123;text&#125;</span>&quot;]&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> sync_playwright() <span class="keyword">as</span> p:  </span><br><span class="line">    browser = p.chromium.launch()  </span><br><span class="line">    page = browser.new_page()  </span><br><span class="line"></span><br><span class="line">    <span class="comment"># 注册自定义的定位器处理程序  </span></span><br><span class="line">    page.add_locator_handler(<span class="string">&#x27;text&#x27;</span>, text_locator_handler)  </span><br><span class="line"></span><br><span class="line">    page.goto(<span class="string">&#x27;https://www.example.com&#x27;</span>)  </span><br><span class="line"></span><br><span class="line">    <span class="comment"># 使用自定义的文本定位器来定位包含指定文本的元素  </span></span><br><span class="line">    element = page.locator(<span class="string">&#x27;text=Hello World&#x27;</span>)  </span><br><span class="line">    element.click()  </span><br><span class="line"></span><br><span class="line">    browser.close()  </span><br></pre></td></tr></table></figure>

<h6 id="删除自定义定位处理程序-page-remove-locator-handler"><a href="#删除自定义定位处理程序-page-remove-locator-handler" class="headerlink" title="删除自定义定位处理程序 - page.remove_locator_handler()"></a>删除自定义定位处理程序 - page.remove_locator_handler()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.remove_locator_handler(locator)</span><br></pre></td></tr></table></figure>

<h6 id="页面置顶-page-bring-to-front"><a href="#页面置顶-page-bring-to-front" class="headerlink" title="页面置顶 - page.bring_to_front()"></a>页面置顶 - page.bring_to_front()</h6><p>将页面置顶（激活标签页）。</p>
<h6 id="脚本调试-page-pause"><a href="#脚本调试-page-pause" class="headerlink" title="脚本调试 - page.pause()"></a>脚本调试 - page.pause()</h6><p>执行到这一步时，会会弹出playwright调试工具(可以使用playwright定位方法)，打断点；类似于前端<strong>debugger</strong></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://pic3.zhimg.com/v2-c9d916c99639717bdc9fc025b0cde0b0_1440w.jpg" alt="img"></p>
<h6 id="生成pdf-page-pdf-path-”page-pdf”"><a href="#生成pdf-page-pdf-path-”page-pdf”" class="headerlink" title="生成pdf - page.pdf(path&#x3D;”page.pdf”)"></a>生成pdf - page.pdf(path&#x3D;”page.pdf”)</h6><h5 id="属性"><a href="#属性" class="headerlink" title="属性"></a>属性</h5><h6 id="获取页面的-URL-page-url"><a href="#获取页面的-URL-page-url" class="headerlink" title="获取页面的 URL - page.url"></a>获取页面的 URL - <code>page.url</code></h6><h6 id="获取浏览器所属上下文-page-context"><a href="#获取浏览器所属上下文-page-context" class="headerlink" title="获取浏览器所属上下文 - page.context"></a>获取浏览器所属上下文 - <code>page.context</code></h6><h6 id="获取附加页面的所有框架数组-page-frames"><a href="#获取附加页面的所有框架数组-page-frames" class="headerlink" title="获取附加页面的所有框架数组 - page.frames"></a>获取附加页面的所有框架数组 - <code>page.frames</code></h6><h6 id="指示页面已关闭-page-is-closed"><a href="#指示页面已关闭-page-is-closed" class="headerlink" title="指示页面已关闭 - page.is_closed()"></a>指示页面已关闭 - <code>page.is_closed()</code></h6><h6 id="页面的主框架-page-main-frame"><a href="#页面的主框架-page-main-frame" class="headerlink" title="页面的主框架  - page.main_frame"></a>页面的主框架  - <code>page.main_frame</code></h6><h6 id="获取页面宽高-page-viewport-size"><a href="#获取页面宽高-page-viewport-size" class="headerlink" title="获取页面宽高 - page.viewport_size"></a>获取页面宽高 - <code>page.viewport_size</code></h6><h6 id="获取页面关联的视频对象-page-video"><a href="#获取页面关联的视频对象-page-video" class="headerlink" title="获取页面关联的视频对象 - page.video"></a>获取页面关联的视频对象 - page.video</h6><h4 id="鼠标操作"><a href="#鼠标操作" class="headerlink" title="鼠标操作"></a>鼠标操作</h4><blockquote>
<p>每个 页面 对象都有自己的鼠标，可通过 page.mouse 访问。</p>
</blockquote>
<h5 id="移动-mouse-move-x-y"><a href="#移动-mouse-move-x-y" class="headerlink" title="移动 - mouse.move(x, y)"></a>移动 - mouse.move(x, y)</h5><p>调度 <code>mousemove</code> 事件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mouse.move(x, y)</span><br></pre></td></tr></table></figure>

<h5 id="按下-mouse-down"><a href="#按下-mouse-down" class="headerlink" title="按下 - mouse . down()"></a>按下 - mouse . down()</h5><p>调度 <code>mousedown</code> 事件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mouse.down()</span><br></pre></td></tr></table></figure>

<h5 id="抬起-mouse-up"><a href="#抬起-mouse-up" class="headerlink" title="抬起 - mouse.up()"></a>抬起 - mouse.up()</h5><p>调度 <code>mouseup</code> 事件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mouse.up()</span><br></pre></td></tr></table></figure>

<h5 id="滚轮-mouse-whell"><a href="#滚轮-mouse-whell" class="headerlink" title="滚轮 - mouse.whell()"></a>滚轮 - mouse.whell()</h5><p>调度 <code>wheel</code> 事件。此方法通常用于手动滚动页面。有关滚动的其他方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mouse.wheel(delta_x, delta_y)</span><br></pre></td></tr></table></figure>

<h5 id="点击-mouse-click-x-y"><a href="#点击-mouse-click-x-y" class="headerlink" title="点击 - mouse.click(x, y)"></a>点击 - mouse.click(x, y)</h5><p>类似mouse.move(x, y)、mouse.down()、mouse.up() 的快捷方式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mouse.click(x, y)</span><br></pre></td></tr></table></figure>

<h5 id="双击-mouse-dblclick-x-y"><a href="#双击-mouse-dblclick-x-y" class="headerlink" title="双击 - mouse.dblclick(x, y)"></a>双击 - mouse.dblclick(x, y)</h5><p>mouse.move(x, y)、mouse.down()、mouse.up()、mouse.down() 和 mouse.up() 的快捷方式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">mouse.dblclick(x, y)</span><br></pre></td></tr></table></figure>



<h4 id="键盘操作"><a href="#键盘操作" class="headerlink" title="键盘操作"></a>键盘操作</h4><blockquote>
<p>在大多数情况下，您应该使用 locator.fill() 代替。只有在页面上有特殊的键盘处理时才需要逐个按键</p>
</blockquote>
<h4 id="page-keyboard-键盘-属性-方法"><a href="#page-keyboard-键盘-属性-方法" class="headerlink" title="page.keyboard 键盘 属性&amp;方法"></a>page.keyboard 键盘 属性&amp;方法</h4><h5 id="keyboard-down-key"><a href="#keyboard-down-key" class="headerlink" title="keyboard.down(key) "></a><code>keyboard.down(key) </code></h5><p>键的示例如下：<br><code>F1 - F12</code>、<code>Digit0- Digit9</code>、<code>KeyA- KeyZ</code>、<code>Backquote</code>、<code>Minus</code>、<code>Equal</code>、<code>Backslash</code>、<code>Backspace</code>、<code>Tab</code>、<code>Delete</code>、<code>Escape</code>、<code>ArrowDown</code>、<code>End</code>、<code>Enter</code>、<code>Home</code>、<code>Insert</code>、<code>PageDown</code>、<code>PageUp</code>、<code>ArrowRight</code>、<code>ArrowUp</code> 等。<br>还支持以下修饰键快捷键：<code>Shift</code>、<code>Control</code>、<code>Alt</code>、<code>Meta</code>、<code>ShiftLeft</code>、<code>ControlOrMeta</code>。<code>ControlOrMeta</code> 在 Windows 和 Linux 上解析为 Control，在 macOS 上解析为 <code>Meta</code>。<br>按住 <code>Shift</code> 键将键入与 <code>key</code> 对应的大写字母文本。<br>如果 <code>key</code> 是单个字符，则区分大小写，因此值 <code>a</code> 和 <code>A</code> 将生成不同的文本。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按下键盘的 &quot;Enter&quot; 键  </span></span><br><span class="line">page.keyboard.down(<span class="string">&quot;Enter&quot;</span>)  </span><br><span class="line"><span class="comment"># 等待一段时间，模拟按键按下的动作  </span></span><br><span class="line">page.wait_for_timeout(<span class="number">2000</span>)  </span><br><span class="line"><span class="comment"># 松开键盘的 &quot;Enter&quot; 键  </span></span><br><span class="line">page.keyboard.up(<span class="string">&quot;Enter&quot;</span>)  </span><br><span class="line"><span class="comment"># 全选</span></span><br><span class="line"><span class="comment"># on windows and linux</span></span><br><span class="line">page.keyboard.press(<span class="string">&quot;Control+A&quot;</span>)</span><br><span class="line"><span class="comment"># on mac_os</span></span><br><span class="line">page.keyboard.press(<span class="string">&quot;Meta+A&quot;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="keyboard-insert-text-key"><a href="#keyboard-insert-text-key" class="headerlink" title="keyboard.insert_text(key) "></a><code>keyboard.insert_text(key) </code></h5><p>仅调度 <code>input</code> 事件，不发出 <code>keydown</code>、<code>keyup</code> 或 <code>keypress</code> 事件<br>用户在键盘上键入文本的操作。这个方法可以用来模拟用户键入文本到输入框或其他元素上。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定位到输入框  </span></span><br><span class="line">input_element = page.locator(<span class="string">&#x27;input[type=&quot;text&quot;]&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 向输入框发送文本  </span></span><br><span class="line">input_element.focus()  </span><br><span class="line">page.keyboard.insert_text(<span class="string">&quot;Hello, World!&quot;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="keyboard-press-key"><a href="#keyboard-press-key" class="headerlink" title="keyboard.press(key) "></a><code>keyboard.press(key) </code></h5><blockquote>
<p>在大多数情况下，您应该使用 locator.press() 代替。</p>
</blockquote>
<p>模拟按下键盘上的特定按键</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 模拟输入 &#x27;a&#x27;</span></span><br><span class="line">page.keyboard.press(<span class="string">&quot;a&quot;</span>)</span><br><span class="line"><span class="comment"># 模拟按下键盘的 &quot;Enter&quot; 键  </span></span><br><span class="line">page.keyboard.press(<span class="string">&#x27;Enter&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="keyboard-type"><a href="#keyboard-type" class="headerlink" title="keyboard.type() "></a><code>keyboard.type() </code></h5><blockquote>
<p>在大多数情况下，您应该使用 locator.fill() 代替。只有在页面上有特殊的键盘处理时才需要逐个按键</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 定位到输入框元素  </span></span><br><span class="line">input_element = page.locator(<span class="string">&#x27;input[type=&quot;text&quot;]&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 聚焦输入框  </span></span><br><span class="line">input_element.focus()  </span><br><span class="line"><span class="comment"># 输入文本</span></span><br><span class="line">page.keyboard.<span class="built_in">type</span>(<span class="string">&quot;Hello, World!&quot;</span>)  </span><br></pre></td></tr></table></figure>



<h5 id="keyboard-up-key"><a href="#keyboard-up-key" class="headerlink" title="keyboard.up(key)"></a><code>keyboard.up(key)</code></h5><p>调度一个 <code>keyup</code> 事件。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 按下键盘的 &quot;Enter&quot; 键  </span></span><br><span class="line">page.keyboard.down(<span class="string">&quot;Enter&quot;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 等待一段时间，模拟按键按下的动作  </span></span><br><span class="line">page.wait_for_timeout(<span class="number">2000</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 松开键盘的 &quot;Enter&quot; 键  </span></span><br><span class="line">page.keyboard.up(<span class="string">&quot;Enter&quot;</span>)</span><br></pre></td></tr></table></figure>



<h4 id="请求-request"><a href="#请求-request" class="headerlink" title="请求 - request"></a>请求 - request</h4><p>当页面发送网络资源请求时，页面 都会发出以下事件序列</p>
<ul>
<li>当页面发出请求时，会发出 page.on(“request”)。</li>
<li>当&#x2F;如果收到请求的响应状态和标头时，会发出 page.on(“response”)。</li>
<li>当响应正文下载完成且请求完成时，会发出 page.on(“requestfinished”)。</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 监听页面内请求  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_request</span>(<span class="params">request</span>):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Request URL:&#x27;</span>, request.url)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Request Method:&#x27;</span>, request.method)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Request Headers:&#x27;</span>, request.headers)  </span><br><span class="line"></span><br><span class="line">page.on(<span class="string">&#x27;request&#x27;</span>, on_request)  </span><br></pre></td></tr></table></figure>

<h5 id="方法-1"><a href="#方法-1" class="headerlink" title="方法"></a>方法</h5><h6 id="包含所有请求-HTTP-标头-request-all-headers"><a href="#包含所有请求-HTTP-标头-request-all-headers" class="headerlink" title="包含所有请求 HTTP 标头 - request.all_headers()"></a>包含所有请求 HTTP 标头 - request.all_headers()</h6><p>标头名称采用小写形式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 监听页面内请求  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_request</span>(<span class="params">request</span>):</span><br><span class="line">    headers = request.all_headers()</span><br><span class="line">    <span class="built_in">print</span>(headers)</span><br><span class="line">page.on(<span class="string">&#x27;request&#x27;</span>, on_request)</span><br></pre></td></tr></table></figure>

<h6 id="返回与名称匹配的标头的值-request-header-value-name"><a href="#返回与名称匹配的标头的值-request-header-value-name" class="headerlink" title="返回与名称匹配的标头的值 - request.header_value(name)"></a>返回与名称匹配的标头的值 - request.header_value(name)</h6><p>名称不区分大小写。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 监听页面内请求</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_request</span>(<span class="params">request</span>):</span><br><span class="line">    headers = request.header_value(<span class="string">&#x27;accept&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(headers)</span><br><span class="line">page.on(<span class="string">&#x27;request&#x27;</span>, on_request)</span><br></pre></td></tr></table></figure>

<h6 id="一个数组，包含与此请求关联的所有请求-HTTP-标头-request-headers-array"><a href="#一个数组，包含与此请求关联的所有请求-HTTP-标头-request-headers-array" class="headerlink" title="一个数组，包含与此请求关联的所有请求 HTTP 标头 - request.headers_array()"></a>一个数组，包含与此请求关联的所有请求 HTTP 标头 - request.headers_array()</h6><p>以键值对的形式返回</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 监听页面内请求</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_request</span>(<span class="params">request</span>):</span><br><span class="line">    headers = request.headers_array()</span><br><span class="line">    <span class="built_in">print</span>(headers)</span><br><span class="line">page.on(<span class="string">&#x27;request&#x27;</span>, on_request)</span><br></pre></td></tr></table></figure>

<h6 id="返回匹配的-响应-对象-request-response"><a href="#返回匹配的-响应-对象-request-response" class="headerlink" title="返回匹配的 响应 对象 - request.response()"></a>返回匹配的 响应 对象 - request.response()</h6><p>如果由于错误而未收到响应，则返回 <code>null</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">on_request</span>(<span class="params">request</span>):</span><br><span class="line">    headers = request.response()</span><br><span class="line">    <span class="built_in">print</span>(headers)</span><br><span class="line">page.on(<span class="string">&#x27;request&#x27;</span>, on_request)</span><br></pre></td></tr></table></figure>

<h6 id="返回给定请求的资源大小信息-request-sizes"><a href="#返回给定请求的资源大小信息-request-sizes" class="headerlink" title="返回给定请求的资源大小信息 - request.sizes()"></a>返回给定请求的资源大小信息 - request.sizes()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">on_request</span>(<span class="params">request</span>):</span><br><span class="line">    headers = request.sizes()</span><br><span class="line">    <span class="built_in">print</span>(headers)</span><br><span class="line">page.on(<span class="string">&#x27;request&#x27;</span>, on_request)</span><br></pre></td></tr></table></figure>

<h5 id="属性-1"><a href="#属性-1" class="headerlink" title="属性"></a>属性</h5><h6 id="记录所有失败请求-request-failure"><a href="#记录所有失败请求-request-failure" class="headerlink" title="记录所有失败请求 - request.failure"></a>记录所有失败请求 - request.failure</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.on(<span class="string">&quot;requestfailed&quot;</span>, <span class="keyword">lambda</span> request: <span class="built_in">print</span>(request.url + <span class="string">&quot; &quot;</span> + request.failure))</span><br></pre></td></tr></table></figure>

<h6 id="获取请求方法-request-method"><a href="#获取请求方法-request-method" class="headerlink" title="获取请求方法 - request.method"></a>获取请求方法 - request.method</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.on(<span class="string">&quot;requestfailed&quot;</span>, <span class="keyword">lambda</span> request: <span class="built_in">print</span>(request.url + <span class="string">&quot; &quot;</span> + request.method))</span><br></pre></td></tr></table></figure>

<h6 id="请求的帖子正文-request-post-data"><a href="#请求的帖子正文-request-post-data" class="headerlink" title="请求的帖子正文 - request.post_data"></a>请求的帖子正文 - request.post_data</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.on(<span class="string">&quot;requestfailed&quot;</span>, <span class="keyword">lambda</span> request: <span class="built_in">print</span>(request.url + <span class="string">&quot; &quot;</span> + request.post_data))</span><br></pre></td></tr></table></figure>

<h6 id="返回解析后的请求正文-request-post-data-json"><a href="#返回解析后的请求正文-request-post-data-json" class="headerlink" title="返回解析后的请求正文 - request.post_data_json"></a>返回解析后的请求正文 - request.post_data_json</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.on(<span class="string">&quot;requestfailed&quot;</span>, <span class="keyword">lambda</span> request: <span class="built_in">print</span>(request.url + <span class="string">&quot; &quot;</span> + request.post_data_json))</span><br></pre></td></tr></table></figure>

<h6 id="重定向前请求-request-redirected-from"><a href="#重定向前请求-request-redirected-from" class="headerlink" title="重定向前请求 - request.redirected_from"></a>重定向前请求 - request.redirected_from</h6><p>没有重定向操作则为None</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.on(<span class="string">&quot;requestfailed&quot;</span>, <span class="keyword">lambda</span> request: <span class="built_in">print</span>(request.url + <span class="string">&quot; &quot;</span> + request.redirected_from))</span><br></pre></td></tr></table></figure>

<h6 id="重定向后请求-request-resource-type"><a href="#重定向后请求-request-resource-type" class="headerlink" title="重定向后请求 - request.resource_type"></a>重定向后请求 - request.resource_type</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.on(<span class="string">&quot;requestfailed&quot;</span>, <span class="keyword">lambda</span> request: <span class="built_in">print</span>(request.url + <span class="string">&quot; &quot;</span> + request.redirected_to))</span><br></pre></td></tr></table></figure>

<h6 id="渲染引擎感知到的请求资源类型-request-resource-type"><a href="#渲染引擎感知到的请求资源类型-request-resource-type" class="headerlink" title="渲染引擎感知到的请求资源类型 - request.resource_type"></a>渲染引擎感知到的请求资源类型 - request.resource_type</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.on(<span class="string">&quot;requestfailed&quot;</span>, <span class="keyword">lambda</span> request: <span class="built_in">print</span>(request.url + <span class="string">&quot; &quot;</span> + request.resource_type))</span><br></pre></td></tr></table></figure>



<h4 id="响应-response"><a href="#响应-response" class="headerlink" title="响应 - response"></a>响应 - response</h4><h5 id="方法-2"><a href="#方法-2" class="headerlink" title="方法"></a>方法</h5><h6 id="关联的所有响应-HTTP-标头-response-all-headers"><a href="#关联的所有响应-HTTP-标头-response-all-headers" class="headerlink" title="关联的所有响应 HTTP 标头 - response.all_headers()"></a>关联的所有响应 HTTP 标头 - response.all_headers()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.on(<span class="string">&quot;response&quot;</span>, <span class="keyword">lambda</span> request: <span class="built_in">print</span>(request.url + <span class="string">&quot; &quot;</span> + response.all_headers()))</span><br></pre></td></tr></table></figure>

<h6 id="响应正文的缓冲区-response-body"><a href="#响应正文的缓冲区-response-body" class="headerlink" title="响应正文的缓冲区 - response.body()"></a>响应正文的缓冲区 - response.body()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.on(<span class="string">&quot;response&quot;</span>, <span class="keyword">lambda</span> request: <span class="built_in">print</span>(request.url + <span class="string">&quot; &quot;</span> + response.body()))</span><br></pre></td></tr></table></figure>

<h6 id="返回与名称匹配的标头的值-header-value"><a href="#返回与名称匹配的标头的值-header-value" class="headerlink" title="返回与名称匹配的标头的值 - header_value()"></a>返回与名称匹配的标头的值 - header_value()</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">page.on(<span class="string">&quot;response&quot;</span>, <span class="keyword">lambda</span> request: <span class="built_in">print</span>(response.header_value(<span class="string">&#x27;content-type&#x27;</span>)))</span><br></pre></td></tr></table></figure>

<h6 id="一个数组，包含与此响应关联的所有请求-HTTP-标头-response-headers-array"><a href="#一个数组，包含与此响应关联的所有请求-HTTP-标头-response-headers-array" class="headerlink" title="一个数组，包含与此响应关联的所有请求 HTTP 标头 - response.headers_array()"></a>一个数组，包含与此响应关联的所有请求 HTTP 标头 - response.headers_array()</h6><h6 id="返回服务器的-IP-地址和端口-response-server-addr"><a href="#返回服务器的-IP-地址和端口-response-server-addr" class="headerlink" title="返回服务器的 IP 地址和端口 - response.server_addr()"></a>返回服务器的 IP 地址和端口 - response.server_addr()</h6><h6 id="返回响应正文的-JSON-表示形式-response-json"><a href="#返回响应正文的-JSON-表示形式-response-json" class="headerlink" title="返回响应正文的 JSON 表示形式 - response.json()"></a>返回响应正文的 JSON 表示形式 - response.json()</h6><h6 id="返回响应正文的文本表示形式-response-text"><a href="#返回响应正文的文本表示形式-response-text" class="headerlink" title="返回响应正文的文本表示形式 - response.text()"></a>返回响应正文的文本表示形式 - response.text()</h6><h5 id="属性-2"><a href="#属性-2" class="headerlink" title="属性"></a>属性</h5><h6 id="一个包含响应-HTTP-标头的对象-response-headers"><a href="#一个包含响应-HTTP-标头的对象-response-headers" class="headerlink" title="一个包含响应 HTTP 标头的对象 - response.headers"></a>一个包含响应 HTTP 标头的对象 - response.headers</h6><h6 id="返回响应是否成功-response-ok"><a href="#返回响应是否成功-response-ok" class="headerlink" title="返回响应是否成功 - response.ok"></a>返回响应是否成功 - response.ok</h6><h6 id="返回匹配的-Request-对象-response-request"><a href="#返回匹配的-Request-对象-response-request" class="headerlink" title="返回匹配的 Request 对象 - response.request"></a>返回匹配的 Request 对象 - response.request</h6><h6 id="返回响应状态码-response-status"><a href="#返回响应状态码-response-status" class="headerlink" title="返回响应状态码 - response.status"></a>返回响应状态码 - response.status</h6><h6 id="响应的状态文本-成功时通常为“OK”-response-status-text"><a href="#响应的状态文本-成功时通常为“OK”-response-status-text" class="headerlink" title="响应的状态文本(成功时通常为“OK”) - response.status_text"></a>响应的状态文本(成功时通常为“OK”) - response.status_text</h6><h6 id="响应url-response-url"><a href="#响应url-response-url" class="headerlink" title="响应url - response.url"></a>响应url - response.url</h6><h4 id="CDP（Chrome-DevTools-Protocol）会话"><a href="#CDP（Chrome-DevTools-Protocol）会话" class="headerlink" title="CDP（Chrome DevTools Protocol）会话"></a>CDP（Chrome DevTools Protocol）会话</h4><blockquote>
<p><code>CDPSession</code> 实例用于与原始 Chrome Devtools 协议进行通信</p>
</blockquote>
<ul>
<li>可以使用 <code>session.send</code> 方法调用协议方法。</li>
<li>可以使用 <code>session.on</code> 方法订阅协议事件。</li>
</ul>
<h4 id="跟踪查看器-Tracing"><a href="#跟踪查看器-Tracing" class="headerlink" title="跟踪查看器 - Tracing"></a>跟踪查看器 - Tracing</h4><blockquote>
<p>使用跟踪查看器(Tracing)，生成的zip压缩包可以使用<code>playwright show-trace xxx.zip</code>进行GUI分析</p>
</blockquote>
<h5 id="开始跟踪-tracing-start-screenshots-True-snapshots-True"><a href="#开始跟踪-tracing-start-screenshots-True-snapshots-True" class="headerlink" title="开始跟踪 - tracing.start(screenshots&#x3D;True, snapshots&#x3D;True)"></a>开始跟踪 - tracing.start(screenshots&#x3D;True, snapshots&#x3D;True)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line">browser = p.chromium.launch()</span><br><span class="line">context = browser.new_context()</span><br><span class="line"><span class="comment"># 根据上下文，开始跟踪</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">screenshots bool （可选）</span></span><br><span class="line"><span class="string">是否在跟踪期间捕获屏幕截图。屏幕截图用于构建时间线预览。</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">snapshots bool （可选）#</span></span><br><span class="line"><span class="string">如果此选项为 true，则跟踪将</span></span><br><span class="line"><span class="string">在每次操作时捕获 DOM 快照</span></span><br><span class="line"><span class="string">记录网络活动</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">context.tracing.start(screenshots=<span class="literal">True</span>, snapshots=<span class="literal">True</span>)</span><br></pre></td></tr></table></figure>

<h5 id="在-tracing-start中开辟多个跟踪块-start-chunk-stop-chunk"><a href="#在-tracing-start中开辟多个跟踪块-start-chunk-stop-chunk" class="headerlink" title="在 tracing.start中开辟多个跟踪块 - start_chunk&amp;stop_chunk"></a>在 tracing.start中开辟多个跟踪块 - start_chunk&amp;stop_chunk</h5><p>开始新的跟踪块。如果您想在同一个 BrowserContext 上记录多个跟踪，请使用一次 tracing.start()，然后使用 tracing.start_chunk() 和 tracing.stop_chunk() 创建多个跟踪块。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">context = </span><br><span class="line">context.tracing.start(screenshots=<span class="literal">True</span>, snapshots=<span class="literal">True</span>)</span><br><span class="line">page = context.new_page()</span><br><span class="line">page.goto(<span class="string">&quot;https://playwright.net.cn&quot;</span>)</span><br><span class="line"></span><br><span class="line">context.tracing.start_chunk()</span><br><span class="line">page.get_by_text(<span class="string">&quot;Get Started&quot;</span>).click()</span><br><span class="line"><span class="comment"># Everything between start_chunk and stop_chunk will be recorded in the trace.</span></span><br><span class="line">context.tracing.stop_chunk(path = <span class="string">&quot;trace1.zip&quot;</span>)</span><br><span class="line"></span><br><span class="line">context.tracing.start_chunk()</span><br><span class="line">page.goto(<span class="string">&quot;http://example.com&quot;</span>)</span><br><span class="line"><span class="comment"># Save a second trace file with different actions.</span></span><br><span class="line">context.tracing.stop_chunk(path = <span class="string">&quot;trace2.zip&quot;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="结束跟踪并生成文件-tracing-stop-path-”trace-zip”"><a href="#结束跟踪并生成文件-tracing-stop-path-”trace-zip”" class="headerlink" title="结束跟踪并生成文件 - tracing.stop(path&#x3D;”trace.zip”)"></a>结束跟踪并生成文件 - tracing.stop(path&#x3D;”trace.zip”)</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context.tracing.stop(path=<span class="string">&quot;trace.zip&quot;</span>)</span><br></pre></td></tr></table></figure>



<h4 id="视频-page-video"><a href="#视频-page-video" class="headerlink" title="视频 - page.video"></a>视频 - page.video</h4><h5 id="删除视频文件-page-video-delete"><a href="#删除视频文件-page-video-delete" class="headerlink" title="删除视频文件 - page.video.delete()"></a>删除视频文件 - page.video.delete()</h5><p>删除视频文件。如有必要，将等待视频完成。</p>
<h5 id="返回此视频将录制到的文件系统路径-page-video-path"><a href="#返回此视频将录制到的文件系统路径-page-video-path" class="headerlink" title="返回此视频将录制到的文件系统路径 - page.video.path()"></a>返回此视频将录制到的文件系统路径 - page.video.path()</h5><h5 id="将视频保存到用户指定的路径-page-video-save-as-path"><a href="#将视频保存到用户指定的路径-page-video-save-as-path" class="headerlink" title="将视频保存到用户指定的路径 - page.video.save_as(path)"></a>将视频保存到用户指定的路径 - page.video.save_as(path)</h5><h4 id="错误处理-WebError"><a href="#错误处理-WebError" class="headerlink" title="错误处理 - WebError"></a>错误处理 - WebError</h4><blockquote>
<p>WebError 类表示页面中抛出的未处理异常。它通过 context.on(“weberror”) 事件进行调度</p>
</blockquote>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context.on(<span class="string">&quot;weberror&quot;</span>, <span class="keyword">lambda</span> web_error: <span class="built_in">print</span>(<span class="string">f&quot;uncaught exception: <span class="subst">&#123;web_error.error&#125;</span>&quot;</span>))</span><br></pre></td></tr></table></figure>

<h5 id="抛出未处理错误-web-error-error"><a href="#抛出未处理错误-web-error-error" class="headerlink" title="抛出未处理错误 - web_error.error"></a>抛出未处理错误 - web_error.error</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context.on(<span class="string">&quot;weberror&quot;</span>, <span class="keyword">lambda</span> web_error: <span class="built_in">print</span>(<span class="string">f&quot;uncaught exception: <span class="subst">&#123;web_error.error&#125;</span>&quot;</span>))</span><br></pre></td></tr></table></figure>

<h5 id="产生此未处理异常的页面-web-error-page"><a href="#产生此未处理异常的页面-web-error-page" class="headerlink" title="产生此未处理异常的页面 - web_error.page"></a>产生此未处理异常的页面 - web_error.page</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">context.on(<span class="string">&quot;weberror&quot;</span>, <span class="keyword">lambda</span> web_error: <span class="built_in">print</span>(<span class="string">f&quot;uncaught exception: <span class="subst">&#123;web_error.page&#125;</span>&quot;</span>))</span><br></pre></td></tr></table></figure>



<h4 id="路由-route"><a href="#路由-route" class="headerlink" title="路由 - route"></a>路由 - route</h4><blockquote>
<p>pass</p>
</blockquote>
<h4 id="tracing-解析"><a href="#tracing-解析" class="headerlink" title="tracing 解析"></a>tracing 解析</h4></article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95/">自动化测试</a><a class="post-meta__tags" href="/tags/playwright/">playwright</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2024/09/21/pywinauto-WIN-PC%E7%AB%AF%E8%87%AA%E5%8A%A8%E5%8C%96/" title="pywinauto_PC端自动化"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">pywinauto_PC端自动化</div></div></a></div><div class="next-post pull-right"><a href="/2024/09/29/xpath%E8%AF%AD%E6%B3%95/" title="Xpath语法"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">Xpath语法</div></div></a></div></nav></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/fafafa.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">fafafa</div><div class="author-info__description">记录笔记日志</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">56</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">35</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">47</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xxxxx" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="/fafafabaobei@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=728831102&amp;website=www.oicqzone.com" target="_blank" title="QQ"><i class="fab fa-qq"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A1%86%E6%9E%B6%E4%BB%8B%E7%BB%8D%E5%92%8C%E5%AE%89%E8%A3%85"><span class="toc-number">1.</span> <span class="toc-text">框架介绍和安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#playwright-%E4%B8%8E-selenium-%E5%8C%BA%E5%88%AB"><span class="toc-number">1.1.</span> <span class="toc-text">playwright 与 selenium 区别</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E5%AE%89%E8%A3%85"><span class="toc-number">1.2.</span> <span class="toc-text">环境安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#playwright%E8%87%AA%E5%B8%A6%E6%B5%8F%E8%A7%88%E5%99%A8%E9%A9%B1%E5%8A%A8%E5%AE%89%E8%A3%85"><span class="toc-number">1.3.</span> <span class="toc-text">playwright自带浏览器驱动安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E5%BD%95%E5%88%B6%E5%8A%9F%E8%83%BD"><span class="toc-number">1.4.</span> <span class="toc-text">脚本录制功能</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%90%AF%E7%94%A8%E5%BD%95%E5%88%B6%E5%B7%A5%E5%85%B7%E5%91%BD%E4%BB%A4"><span class="toc-number">1.4.1.</span> <span class="toc-text">启用录制工具命令</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%86%85%E7%BD%AE%E6%94%AF%E6%8C%81%E6%B5%8F%E8%A7%88%E5%99%A8%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.5.</span> <span class="toc-text">使用内置支持浏览器类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95-%E6%9C%AC%E5%9C%B0%E6%89%A7%E8%A1%8C"><span class="toc-number">1.6.</span> <span class="toc-text">使用方法 - 本地执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9C%E7%A8%8B%E6%89%A7%E8%A1%8C"><span class="toc-number">1.7.</span> <span class="toc-text">远程执行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%AD%89%E5%BE%85-%E4%B8%94%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9"><span class="toc-number">1.8.</span> <span class="toc-text">等待 - 且注意事项</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BC%BA%E5%88%B6%E7%AD%89%E5%BE%85-page-wait-for-timeout-1000-%E5%8D%95%E4%BD%8D%EF%BC%9Ams"><span class="toc-number">1.8.1.</span> <span class="toc-text">强制等待 - page.wait_for_timeout(1000)  - 单位：ms</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#page-wait-for-selector-selector-options"><span class="toc-number">1.8.2.</span> <span class="toc-text">page.wait_for_selector(selector, options?)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#wait-for-function-page-function"><span class="toc-number">1.8.3.</span> <span class="toc-text"> wait_for_function(page_function)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#wait-for-event-target-event"><span class="toc-number">1.8.4.</span> <span class="toc-text"> wait_for_event(target, event)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#wait-for-navigation"><span class="toc-number">1.8.5.</span> <span class="toc-text">wait_for_navigation()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#page-wait-for-load-state-load"><span class="toc-number">1.8.6.</span> <span class="toc-text">page.wait_for_load_state(&quot;load&quot;) </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#wait-for-request-url-or-predicate"><span class="toc-number">1.8.7.</span> <span class="toc-text">wait_for_request(url_or_predicate)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#wait-for-response-url-or-predicate"><span class="toc-number">1.8.8.</span> <span class="toc-text">wait_for_response(url_or_predicate)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#wait-for-url"><span class="toc-number">1.8.9.</span> <span class="toc-text">wait_for_url()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#locator-waitFor"><span class="toc-number">1.8.10.</span> <span class="toc-text">locator().waitFor()</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Browser-%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AF%B9%E8%B1%A1"><span class="toc-number">1.9.</span> <span class="toc-text">Browser(浏览器对象)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%8A%E4%B8%8B%E6%96%87-browser-new-context"><span class="toc-number">1.9.1.</span> <span class="toc-text">创建浏览器上下文 - browser.new_context()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%89%80%E6%9C%89%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%8A%E4%B8%8B%E6%96%87%E5%AF%B9%E8%B1%A1-browser-contexts"><span class="toc-number">1.9.2.</span> <span class="toc-text">获取所有浏览器上下文对象 - browser.contexts</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%A1%B5%E9%9D%A2%E5%AE%9E%E4%BE%8B-browser-new-page"><span class="toc-number">1.9.3.</span> <span class="toc-text">创建页面实例 - browser.new_page()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%B5%8F%E8%A7%88%E5%99%A8%E6%89%80%E5%B1%9E%E7%9A%84%E6%B5%8F%E8%A7%88%E5%99%A8%E7%B1%BB%E5%9E%8B-browser-browser-type"><span class="toc-number">1.9.4.</span> <span class="toc-text">获取浏览器所属的浏览器类型 - browser.browser_type</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AF%B9%E8%B1%A1%E6%98%AF%E5%90%A6%E8%BF%9E%E6%8E%A5-browser-is-connected"><span class="toc-number">1.9.5.</span> <span class="toc-text">判断浏览器对象是否连接 - browser.is_connected()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%B0%83%E8%AF%95%E5%8D%8F%E8%AE%AE%EF%BC%88CDP%EF%BC%89%E4%BC%9A%E8%AF%9D-browser-new-browser-cdp-session"><span class="toc-number">1.9.6.</span> <span class="toc-text">客户端调试协议（CDP）会话 - browser.new_browser_cdp_session()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC-browser-on"><span class="toc-number">1.9.7.</span> <span class="toc-text">事件监听 - browser.on()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%80%E6%AC%A1%E6%80%A7%E4%BA%8B%E4%BB%B6%E7%9B%91%E5%90%AC-browser-once"><span class="toc-number">1.9.8.</span> <span class="toc-text">一次性事件监听 - browser.once()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A7%BB%E9%99%A4%E7%9B%91%E5%90%AC-browser-remove-listener"><span class="toc-number">1.9.9.</span> <span class="toc-text">移除监听 - browser.remove_listener()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BC%80%E5%90%AF%E6%80%A7%E8%83%BD%E8%B7%9F%E8%B8%AA-browser-start-tracing-path-screenshots-browser-stop-tracing"><span class="toc-number">1.9.10.</span> <span class="toc-text">开启性能跟踪 - browser.start_tracing(path, screenshots) &amp; browser.stop_tracing()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E6%B5%8F%E8%A7%88%E5%99%A8%E7%89%88%E6%9C%AC%E5%8F%B7-browser-version"><span class="toc-number">1.9.11.</span> <span class="toc-text">获取当前浏览器版本号 - browser.version</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B3%E9%97%AD-browser-close"><span class="toc-number">1.9.12.</span> <span class="toc-text">关闭 - browser.close()</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#context-%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%8A%E4%B8%8B%E6%96%87"><span class="toc-number">1.10.</span> <span class="toc-text">context(浏览器上下文)</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B7%BB%E5%8A%A0cookie-context-add-cookie"><span class="toc-number">1.10.1.</span> <span class="toc-text">添加cookie - context.add_cookie()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96cookie-context-cookies"><span class="toc-number">1.10.2.</span> <span class="toc-text">获取cookie - context.cookies()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B8%85%E9%99%A4cookie%E8%AE%B0%E5%BD%95-context-clear-cookies"><span class="toc-number">1.10.3.</span> <span class="toc-text">清除cookie记录 - context.clear_cookies</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B5%8F%E8%A7%88%E5%99%A8%E6%8E%88%E6%9D%83-context-grant-permissions"><span class="toc-number">1.10.4.</span> <span class="toc-text">浏览器授权 - context.grant_permissions()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B8%85%E9%99%A4%E6%9D%83%E9%99%90-context-clear-permissions"><span class="toc-number">1.10.5.</span> <span class="toc-text">清除权限 - context.clear_permissions</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%B3%E9%97%AD%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%8A%E4%B8%8B%E6%96%87context-close-str"><span class="toc-number">1.10.6.</span> <span class="toc-text">关闭浏览器上下文context.close(str)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%9B%91%E5%90%AC%E7%AD%89%E5%BE%85%E7%89%B9%E5%AE%9A%E4%BA%8B%E4%BB%B6%E8%A7%A6%E5%8F%91-expect-event"><span class="toc-number">1.10.7.</span> <span class="toc-text">监听等待特定事件触发 - expect_event()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%AD%89%E5%BE%85%E7%BB%99%E5%AE%9A%E7%9A%84-event-%E8%A7%A6%E5%8F%91-wait-for-event"><span class="toc-number">1.10.8.</span> <span class="toc-text">等待给定的 event 触发 - wait_for_event()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#context-new-cdp-session"><span class="toc-number">1.10.9.</span> <span class="toc-text">context.new_cdp_session()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E9%A1%B5%E9%9D%A2-context-new-page"><span class="toc-number">1.10.10.</span> <span class="toc-text">创建一个页面 - context.new_page()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%94%A8%E4%BA%8E%E6%B5%8F%E8%A7%88%E5%99%A8%E4%B8%8A%E4%B8%8B%E6%96%87%E6%8D%95%E8%8E%B7%E7%BD%91%E7%BB%9C%E8%AF%B7%E6%B1%82%E7%9A%84%E5%8A%9F%E8%83%BD-context-route"><span class="toc-number">1.10.11.</span> <span class="toc-text">用于浏览器上下文捕获网络请求的功能 - context.route()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B8%85%E9%99%A4router%E6%8D%95%E8%8E%B7%E5%8A%9F%E8%83%BD-unroute"><span class="toc-number">1.10.12.</span> <span class="toc-text">清除router捕获功能 - unroute()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%B8%85%E9%99%A4%E4%BD%BF%E7%94%A8-browser-context-route-%E5%92%8C-browser-context-route-from-har-%E5%88%9B%E5%BB%BA%E7%9A%84%E6%89%80%E6%9C%89%E8%B7%AF%E7%94%B1%E8%A7%84%E5%88%99-unroute-all"><span class="toc-number">1.10.13.</span> <span class="toc-text">清除使用 browser_context.route()和 browser_context.route_from_har()创建的所有路由规则 - unroute_all()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BB%8E-HAR-%E6%96%87%E4%BB%B6%E5%88%9B%E5%BB%BA%E8%99%9A%E6%8B%9F%E7%9A%84%E8%B7%AF%E7%94%B1-route-from-har"><span class="toc-number">1.10.14.</span> <span class="toc-text">从 HAR 文件创建虚拟的路由 - route_from_har</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%9F%E4%B8%80%E8%AE%BE%E7%BD%AE%E8%B6%85%E6%97%B6%E6%97%B6%E9%97%B4-set-default-navigation-timeout-timeout"><span class="toc-number">1.10.15.</span> <span class="toc-text">统一设置超时时间 - set_default_navigation_timeout(timeout)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E6%89%80%E6%9C%89%E8%B6%85%E6%97%B6%E6%97%B6%E9%97%B4-set-default-timeout-timeout"><span class="toc-number">1.10.16.</span> <span class="toc-text">设置所有超时时间 - set_default_timeout(timeout)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E8%AF%B7%E6%B1%82%E5%A4%B4-set-extra-http-headers"><span class="toc-number">1.10.17.</span> <span class="toc-text">设置请求头 - set_extra_http_headers()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%9C%B0%E7%90%86%E4%BD%8D%E7%BD%AE-set-geolocation"><span class="toc-number">1.10.18.</span> <span class="toc-text">设置地理位置 - set_geolocation()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E7%BD%91%E7%BB%9C%E7%A6%BB%E7%BA%BF%E7%8A%B6%E6%80%81-set-offline"><span class="toc-number">1.10.19.</span> <span class="toc-text">模拟网络离线状态 - set_offline()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%B5%8F%E8%A7%88%E5%99%A8%E7%BC%93%E5%AD%98%E6%95%B0%E6%8D%AE-storage-state"><span class="toc-number">1.10.20.</span> <span class="toc-text">获取浏览器缓存数据 - storage_state()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E4%B8%8A%E4%B8%8B%E6%96%87%E4%B8%AD%E6%89%80%E6%9C%89%E7%8E%B0%E6%9C%89%E7%9A%84%E5%90%8E%E5%8F%B0%E9%A1%B5%E9%9D%A2-background-pages"><span class="toc-number">1.10.21.</span> <span class="toc-text">获取上下文中所有现有的后台页面 - background_pages</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E4%B8%8A%E4%B8%8B%E6%96%87%E6%89%80%E6%9C%89%E6%89%93%E5%BC%80%E7%9A%84%E9%A1%B5%E9%9D%A2-pages"><span class="toc-number">1.10.22.</span> <span class="toc-text">获取上下文所有打开的页面 - pages</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%91%E8%B5%B7%E8%AF%B7%E6%B1%82-request"><span class="toc-number">1.10.23.</span> <span class="toc-text">发起请求 - request</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#context%E7%9B%B8%E5%85%B3%E4%BA%8B%E4%BB%B6"><span class="toc-number">1.11.</span> <span class="toc-text">context相关事件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#on-%E2%80%9Cbackgroundpage%E2%80%9D"><span class="toc-number">1.11.1.</span> <span class="toc-text">on(“backgroundpage”)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#on-%E2%80%9Cclose%E2%80%9D"><span class="toc-number">1.11.2.</span> <span class="toc-text">on(“close”)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#on-%E2%80%9Cconsole%E2%80%9D"><span class="toc-number">1.11.3.</span> <span class="toc-text">on(“console”)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#on-%E2%80%9Cdialog%E2%80%9D"><span class="toc-number">1.11.4.</span> <span class="toc-text">on(“dialog”)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#on-%E2%80%9Cpage%E2%80%9D"><span class="toc-number">1.11.5.</span> <span class="toc-text">on(“page”)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#on-%E2%80%9Crequest%E2%80%9D"><span class="toc-number">1.11.6.</span> <span class="toc-text">on(“request”)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#on-%E2%80%9Crequestfailed%E2%80%9D"><span class="toc-number">1.11.7.</span> <span class="toc-text">on(“requestfailed”)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#on-%E2%80%9Crequestfinished%E2%80%9D"><span class="toc-number">1.11.8.</span> <span class="toc-text">on(“requestfinished”)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#on-%E2%80%9Cresponse%E2%80%9D"><span class="toc-number">1.11.9.</span> <span class="toc-text">on(“response”)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#on-%E2%80%9Cserviceworker%E2%80%9D"><span class="toc-number">1.11.10.</span> <span class="toc-text">on(“serviceworker”)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#on-%E2%80%9Cweberror%E2%80%9D"><span class="toc-number">1.11.11.</span> <span class="toc-text">on(“weberror”)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#page%E5%85%83%E7%B4%A0%E5%AE%9A%E4%BD%8D"><span class="toc-number">1.12.</span> <span class="toc-text">page元素定位</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%9A%E4%BD%8D%E5%99%A8-page-Locator-%E6%96%B9%E6%B3%95"><span class="toc-number">1.12.1.</span> <span class="toc-text">定位器 - page.Locator() 方法</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E8%AE%B2%E8%A7%A3-locator-selector-kwargs"><span class="toc-number">1.12.1.1.</span> <span class="toc-text">参数讲解 locator(selector, **kwargs)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%AE%9A%E4%BD%8D%E5%99%A8%E8%BF%94%E5%9B%9E%E5%8D%95%E4%B8%AA%E5%85%83%E7%B4%A0-page-locator"><span class="toc-number">1.12.1.2.</span> <span class="toc-text">定位器返回单个元素 - page.locator()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#page-locator-%E6%96%B9%E6%B3%95%E8%BF%94%E5%9B%9E%E4%B8%80%E4%B8%AA%E5%85%83%E7%B4%A0%E5%AE%9A%E4%BD%8D%E5%99%A8-Locator"><span class="toc-number">1.12.1.3.</span> <span class="toc-text">page.locator() 方法返回一个元素定位器 Locator</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%85%A8%E9%83%A8%E5%85%83%E7%B4%A0-locator-all"><span class="toc-number">1.12.1.4.</span> <span class="toc-text">返回全部元素 - locator.all()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%85%A8%E9%83%A8%E5%8C%B9%E9%85%8D%E5%85%83%E7%B4%A0%E7%9A%84%E6%95%B0%E9%87%8F-locator-count"><span class="toc-number">1.12.1.5.</span> <span class="toc-text">返回全部匹配元素的数量 - locator.count()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E5%85%83%E7%B4%A0%E7%9A%84%E6%96%87%E6%9C%AC%E5%86%85%E5%AE%B9-locator-all-inner-texts"><span class="toc-number">1.12.1.6.</span> <span class="toc-text">匹配元素的文本内容 - locator.all_inner_texts()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E7%9A%84DOM-locator-inner-html"><span class="toc-number">1.12.1.7.</span> <span class="toc-text">获取元素的DOM - locator.inner_html()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E7%9A%84%E6%96%87%E6%9C%AC%E5%86%85%E5%AE%B9-locator-inner-text"><span class="toc-number">1.12.1.8.</span> <span class="toc-text">获取元素的文本内容 - locator.inner_text()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0DOM%E5%B1%9E%E6%80%A7%E5%80%BC-locator-get-attribute"><span class="toc-number">1.12.1.9.</span> <span class="toc-text">获取元素DOM属性值 - locator.get_attribute()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E5%A4%9A%E7%A7%8D%E5%85%83%E7%B4%A0"><span class="toc-number">1.12.1.10.</span> <span class="toc-text">匹配多种元素</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%AD%97%E6%AE%B5%E5%80%BClocator-fill"><span class="toc-number">1.12.1.11.</span> <span class="toc-text">设置字段值locator.fill()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E6%A1%86%E8%81%9A%E7%84%A6-locator-focus"><span class="toc-number">1.12.1.12.</span> <span class="toc-text">输入框聚焦 - locator.focus()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BE%93%E5%85%A5%E6%A1%86%E7%84%A6%E7%82%B9-locator-blur"><span class="toc-number">1.12.1.13.</span> <span class="toc-text">输入框焦点 - locator.blur()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%AE%9A%E4%BD%8D%E5%B1%9E%E6%80%A7%E7%9A%84%E5%85%83%E7%B4%A0%E7%9A%84%E8%BE%B9%E7%95%8C%E6%A1%86%E4%BF%A1%E6%81%AF-locator-bounding-box"><span class="toc-number">1.12.1.14.</span> <span class="toc-text">获取定位属性的元素的边界框信息 - locator.bounding_box()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%80%89%E4%B8%AD%E9%80%89%E6%A1%86-%E6%8C%89%E9%92%AE%E5%85%83%E7%B4%A0-locator-check"><span class="toc-number">1.12.1.15.</span> <span class="toc-text">选中选框&#x2F;按钮元素 - locator.check()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%B8%85%E9%99%A4%E9%80%89%E4%B8%AD%E5%85%83%E7%B4%A0-locator-clear"><span class="toc-number">1.12.1.16.</span> <span class="toc-text">清除选中元素- locator.clear()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%82%B9%E5%87%BB%E9%80%89%E4%B8%AD%E5%85%83%E7%B4%A0-locator-click"><span class="toc-number">1.12.1.17.</span> <span class="toc-text">点击选中元素 - locator.click()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8F%8C%E5%87%BB%E9%80%89%E4%B8%AD%E5%85%83%E7%B4%A0-locator-dblclick"><span class="toc-number">1.12.1.18.</span> <span class="toc-text">双击选中元素 - locator.dblclick()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#locator-dispatch-event"><span class="toc-number">1.12.1.19.</span> <span class="toc-text">locator.dispatch_event()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%85%83%E7%B4%A0%E6%8B%96%E5%8A%A8-locator-drag-to"><span class="toc-number">1.12.1.20.</span> <span class="toc-text">元素拖动 - locator.drag_to()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%89%A7%E8%A1%8Cjs%E4%BB%A3%E7%A0%81-locator-evaluate"><span class="toc-number">1.12.1.21.</span> <span class="toc-text">执行js代码 - locator.evaluate()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%89%A7%E8%A1%8Cjs%E4%BB%A3%E7%A0%81-locator-evaluate-all"><span class="toc-number">1.12.1.22.</span> <span class="toc-text">执行js代码  - locator.evaluate_all()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%89%A7%E8%A1%8Cjs%E4%BB%A3%E7%A0%81-locator-evaluate-handle"><span class="toc-number">1.12.1.23.</span> <span class="toc-text">执行js代码  - locator.evaluate_handle()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%87%E6%BB%A4%E5%99%A8-locator-filter"><span class="toc-number">1.12.1.24.</span> <span class="toc-text">过滤器 - locator.filter()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%88%87%E6%8D%A2iframe-locator-frame-locator"><span class="toc-number">1.12.1.25.</span> <span class="toc-text">切换iframe - locator.frame_locator()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%AB%98%E4%BA%AE%E6%98%BE%E7%A4%BA%E9%80%89%E4%B8%AD%E5%85%83%E7%B4%A0-element-highlight"><span class="toc-number">1.12.1.26.</span> <span class="toc-text">高亮显示选中元素 - element.highlight()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%BC%A0%E6%A0%87%E6%82%AC%E5%81%9C-element-hover"><span class="toc-number">1.12.1.27.</span> <span class="toc-text">鼠标悬停 - element.hover()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E7%9A%84value%E5%B1%9E%E6%80%A7%E5%80%BC-locator-input-value"><span class="toc-number">1.12.1.28.</span> <span class="toc-text">获取元素的value属性值 - locator.input_value()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0%E6%98%AF%E5%90%A6%E9%80%89%E4%B8%AD-locator-is-checked"><span class="toc-number">1.12.1.29.</span> <span class="toc-text">返回定位元素是否选中 - locator.is_checked()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E8%AF%A5%E5%85%83%E7%B4%A0%E6%98%AF%E5%90%A6%E8%A2%AB%E7%A6%81%E7%94%A8-locator-is-disabled"><span class="toc-number">1.12.1.30.</span> <span class="toc-text">返回该元素是否被禁用 - locator.is_disabled()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E5%85%83%E7%B4%A0%E6%98%AF%E5%90%A6%E5%8F%AF%E7%BC%96%E8%BE%91-locator-is-editable"><span class="toc-number">1.12.1.31.</span> <span class="toc-text">判断元素是否可编辑 - locator.is_editable()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E5%85%83%E7%B4%A0%E6%98%AF%E5%90%A6%E5%90%AF%E7%94%A8-locator-is-enabled"><span class="toc-number">1.12.1.32.</span> <span class="toc-text">判断元素是否启用 - locator.is_enabled()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E5%85%83%E7%B4%A0%E6%98%AF%E5%90%A6%E9%9A%90%E8%97%8F-locator-is-hidden"><span class="toc-number">1.12.1.33.</span> <span class="toc-text">判断元素是否隐藏 - locator.is_hidden()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E5%85%83%E7%B4%A0%E6%98%AF%E5%90%A6%E5%8F%AF%E8%A7%81-locator-is-visible"><span class="toc-number">1.12.1.34.</span> <span class="toc-text">判断元素是否可见 - locator.is_visible()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%8C%89%E4%B8%8B%E5%85%83%E7%B4%A0-locator-press"><span class="toc-number">1.12.1.35.</span> <span class="toc-text">按下元素 - locator.press()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%BB%9A%E5%8A%A8%E5%85%83%E7%B4%A0%E8%87%B3%E5%8F%AF%E8%A7%81-locator-scroll-into-view-if-needed"><span class="toc-number">1.12.1.36.</span> <span class="toc-text">滚动元素至可见 - locator.scroll_into_view_if_needed()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%80%89%E6%8B%A9%E5%8D%95%E4%B8%AA%E6%88%96%E5%A4%9A%E4%B8%AAselect-element-select-option"><span class="toc-number">1.12.1.37.</span> <span class="toc-text">选择单个或多个select - element.select_option()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%8D%95%E9%80%89%E6%A1%86%E6%88%96%E5%A4%8D%E9%80%89%E6%A1%86%E7%8A%B6%E6%80%81-locator-set-checked"><span class="toc-number">1.12.1.38.</span> <span class="toc-text">设置单选框或复选框状态 - locator.set_checked()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%8D%95%E9%80%89%E6%A1%86%E6%88%96%E5%A4%8D%E9%80%89%E6%A1%86%E7%8A%B6%E6%80%81-locator-is-checked"><span class="toc-number">1.12.1.39.</span> <span class="toc-text">获取单选框或复选框状态 - locator.is_checked()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8F%96%E6%B6%88%E9%80%89%E4%B8%AD-locator-uncheck"><span class="toc-number">1.12.1.40.</span> <span class="toc-text">取消选中 - locator.uncheck()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%AD%89%E5%BE%85-locator-wait-for"><span class="toc-number">1.12.1.41.</span> <span class="toc-text">等待 - locator.wait_for()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-locator-set-input-files"><span class="toc-number">1.12.1.42.</span> <span class="toc-text">文件上传 - locator.set_input_files()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%82%B9%E5%87%BB%E9%80%89%E6%8B%A9%E5%99%A8%E5%85%83%E7%B4%A0-locator-tap"><span class="toc-number">1.12.1.43.</span> <span class="toc-text">点击选择器元素 - locator.tap()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E9%80%89%E6%8B%A9%E5%99%A8%E7%9A%84%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%85%83%E7%B4%A0-locator-first"><span class="toc-number">1.12.1.44.</span> <span class="toc-text">返回选择器的第一个元素 - locator.first</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E9%80%89%E6%8B%A9%E5%99%A8%E7%9A%84%E6%9C%80%E5%90%8E%E4%B8%80%E4%B8%AA%E5%85%83%E7%B4%A0-locator-last"><span class="toc-number">1.12.1.45.</span> <span class="toc-text">返回选择器的最后一个元素 - locator.last</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E7%AC%ACn%E4%B8%AA%E5%85%83%E7%B4%A0-locator-nth"><span class="toc-number">1.12.1.46.</span> <span class="toc-text">获取第n个元素 - locator.nth()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%BD%93%E5%89%8D%E5%85%83%E7%B4%A0%E9%A1%B5%E9%9D%A2%E4%BF%A1%E6%81%AF-locator-page"><span class="toc-number">1.12.1.47.</span> <span class="toc-text">返回当前元素页面信息 - locator.page</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#page-select-%E4%B8%8B%E6%8B%89%E9%80%89%E9%A1%B9"><span class="toc-number">1.12.2.</span> <span class="toc-text">page.select() 下拉选项</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E4%BD%BF%E7%94%A8"><span class="toc-number">1.12.2.1.</span> <span class="toc-text">基本使用</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%A4%9A%E9%80%89%E4%B8%8B%E6%8B%89%E5%88%97%E8%A1%A8"><span class="toc-number">1.12.2.2.</span> <span class="toc-text">多选下拉列表</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%B6%85%E6%97%B6%E8%AE%BE%E7%BD%AE"><span class="toc-number">1.12.2.3.</span> <span class="toc-text">超时设置</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%81%94%E5%8A%A8%E9%80%89%E6%8B%A9"><span class="toc-number">1.12.2.4.</span> <span class="toc-text">联动选择</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%86%85%E7%BD%AE%E5%AE%9A%E4%BD%8D%E5%99%A8"><span class="toc-number">1.12.3.</span> <span class="toc-text">内置定位器</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#page-get-by-role-%E9%80%9A%E8%BF%87%E6%98%BE%E5%BC%8F%E5%92%8C%E9%9A%90%E5%BC%8F%E5%8F%AF%E8%AE%BF%E9%97%AE%E6%80%A7%E5%B1%9E%E6%80%A7%E8%BF%9B%E8%A1%8C%E5%AE%9A%E4%BD%8D%E3%80%82role%E5%B1%9E%E6%80%A7"><span class="toc-number">1.12.3.1.</span> <span class="toc-text">page.get_by_role()通过显式和隐式可访问性属性进行定位。role属性</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#page-get-by-text-%E9%80%9A%E8%BF%87%E6%96%87%E6%9C%AC%E5%86%85%E5%AE%B9%E5%AE%9A%E4%BD%8D%E3%80%82"><span class="toc-number">1.12.3.2.</span> <span class="toc-text">page.get_by_text()通过文本内容定位。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#page-get-by-label-%E9%80%9A%E8%BF%87%E5%85%B3%E8%81%94%E6%A0%87%E7%AD%BE%E7%9A%84%E6%96%87%E6%9C%AC%E5%AE%9A%E4%BD%8D%E8%A1%A8%E5%8D%95%E6%8E%A7%E4%BB%B6%E3%80%82"><span class="toc-number">1.12.3.3.</span> <span class="toc-text">page.get_by_label()通过关联标签的文本定位表单控件。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#page-get-by-placeholder-%E6%8C%89%E5%8D%A0%E4%BD%8D%E7%AC%A6%E5%AE%9A%E4%BD%8D%E8%BE%93%E5%85%A5%E3%80%82"><span class="toc-number">1.12.3.4.</span> <span class="toc-text">page.get_by_placeholder()按占位符定位输入。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#page-get-by-alt-text-%E9%80%9A%E8%BF%87%E6%9B%BF%E4%BB%A3%E6%96%87%E6%9C%AC%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0%EF%BC%8C%E9%80%9A%E5%B8%B8%E6%98%AF%E5%9B%BE%E5%83%8F%E3%80%82"><span class="toc-number">1.12.3.5.</span> <span class="toc-text">page.get_by_alt_text()通过替代文本定位元素，通常是图像。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#page-get-by-title-%E9%80%9A%E8%BF%87%E6%A0%87%E9%A2%98%E5%B1%9E%E6%80%A7%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0%E3%80%82"><span class="toc-number">1.12.3.6.</span> <span class="toc-text">page.get_by_title()通过标题属性定位元素。</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#page-get-by-test-id-%E6%A0%B9%E6%8D%AEdata-testid%E5%B1%9E%E6%80%A7%E5%AE%9A%E4%BD%8D%E5%85%83%E7%B4%A0%E5%8F%AF%E4%BB%A5%E9%85%8D%E7%BD%AE%E5%85%B6%E4%BB%96%E5%B1%9E%E6%80%A7%EF%BC%89"><span class="toc-number">1.12.3.7.</span> <span class="toc-text">page.get_by_test_id()根据data-testid属性定位元素可以配置其他属性）</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#locator-get-by-placeholder-%E9%80%9A%E8%BF%87%E5%8D%A0%E4%BD%8D%E7%AC%A6%E6%96%87%E6%9C%AC%E5%AE%9A%E4%BD%8D%E8%BE%93%E5%85%A5%E5%85%83%E7%B4%A0%E3%80%82"><span class="toc-number">1.12.3.8.</span> <span class="toc-text">locator.get_by_placeholder( )  通过占位符文本定位输入元素。</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#page%E6%93%8D%E4%BD%9C"><span class="toc-number">1.13.</span> <span class="toc-text">page操作</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95"><span class="toc-number">1.13.1.</span> <span class="toc-text">方法</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%89%93%E5%BC%80%E9%A1%B5%E9%9D%A2-page-goto"><span class="toc-number">1.13.1.1.</span> <span class="toc-text">打开页面 - page.goto()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%A0%87%E9%A2%98%E5%90%8D%E7%A7%B0-page-title"><span class="toc-number">1.13.1.2.</span> <span class="toc-text">获取标题名称 - page.title()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%A1%B5%E9%9D%A2html%E5%86%85%E5%AE%B9-page-content"><span class="toc-number">1.13.1.3.</span> <span class="toc-text">获取页面html内容 - page.content()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%85%B3%E9%97%AD%E9%A1%B5%E9%9D%A2-page-close"><span class="toc-number">1.13.1.4.</span> <span class="toc-text">关闭页面 - page.close()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%88%A4%E6%96%AD%E9%A1%B5%E9%9D%A2%E6%98%AF%E5%90%A6%E5%85%B3%E9%97%AD-page-is-closed"><span class="toc-number">1.13.1.5.</span> <span class="toc-text">判断页面是否关闭 - page.is_closed()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%88%B7%E6%96%B0%E9%A1%B5%E9%9D%A2-page-reload"><span class="toc-number">1.13.1.6.</span> <span class="toc-text">刷新页面 - page.reload()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E4%B8%8A%E4%B8%80%E9%A1%B5%E5%8E%86%E5%8F%B2-page-go-back"><span class="toc-number">1.13.1.7.</span> <span class="toc-text">返回上一页历史 - page.go_back()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%B7%B3%E8%BD%AC%E4%B8%8B%E4%B8%80%E9%A1%B5%E5%8E%86%E5%8F%B2-page-go-forward"><span class="toc-number">1.13.1.8.</span> <span class="toc-text">跳转下一页历史 - page.go_forward()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E6%88%AA%E5%9B%BE-page-screenshot-options"><span class="toc-number">1.13.1.9.</span> <span class="toc-text">页面截图 - page.screenshot(options)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%AD%89%E5%BE%85%E9%A1%B5%E9%9D%A2%E5%85%83%E7%B4%A0%E5%8A%A0%E8%BD%BD%E6%88%90%E5%8A%9F-page-wait-for-selector-selector-timeout-1000"><span class="toc-number">1.13.1.10.</span> <span class="toc-text">等待页面元素加载成功 - page.wait_for_selector(selector, timeout&#x3D;1000)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%9C%A8%E9%A1%B5%E9%9D%A2%E4%B8%AD%E6%89%A7%E8%A1%8C-JavaScript-%E4%BB%A3%E7%A0%81-page-evaluate-script"><span class="toc-number">1.13.1.11.</span> <span class="toc-text">在页面中执行 JavaScript 代码 - page.evaluate(script)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E9%A1%B5%E9%9D%A2%E8%A7%86%E5%8F%A3%E5%A4%A7%E5%B0%8F-page-set-viewport-size-width-height"><span class="toc-number">1.13.1.12.</span> <span class="toc-text">设置页面视口大小 - page.set_viewport_size(width, height)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E9%94%AE%E7%9B%98%E8%BE%93%E5%85%A5-page-type-selector-text"><span class="toc-number">1.13.1.13.</span> <span class="toc-text">模拟键盘输入 - page.type(selector, text)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E9%94%AE%E7%9B%98%E8%BE%93%E5%85%A5-page-fill-selector-text"><span class="toc-number">1.13.1.14.</span> <span class="toc-text">模拟键盘输入 - page.fill(selector, text)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%B8%85%E7%A9%BA%E8%BE%93%E5%85%A5%E6%A1%86%E5%86%85%E5%AE%B9-page-clear"><span class="toc-number">1.13.1.15.</span> <span class="toc-text">清空输入框内容 - page.clear()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E9%BC%A0%E6%A0%87%E7%82%B9%E5%87%BB-page-click-selector"><span class="toc-number">1.13.1.16.</span> <span class="toc-text">模拟鼠标点击 - page.click(selector)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E9%BC%A0%E6%A0%87%E5%8F%8C%E5%87%BB-page-dblclick-selector"><span class="toc-number">1.13.1.17.</span> <span class="toc-text">模拟鼠标双击 - page.dblclick(selector)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%A8%A1%E6%8B%9F%E9%BC%A0%E6%A0%87%E6%82%AC%E5%81%9C-page-hover-selector"><span class="toc-number">1.13.1.18.</span> <span class="toc-text">模拟鼠标悬停 - page.hover(selector)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%A1%B5%E9%9D%A2%E4%B8%8A%E7%9A%84%E6%89%80%E6%9C%89%E9%93%BE%E6%8E%A5-page-query-selector-all-a"><span class="toc-number">1.13.1.19.</span> <span class="toc-text">获取页面上的所有链接 - page.query_selector_all(&#39;a&#39;)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%AE%BE%E7%BD%AE%E5%8D%95%E9%80%89%E6%A1%86%E6%88%96%E5%A4%8D%E9%80%89%E6%A1%86%E7%9A%84%E7%8A%B6%E6%80%81-page-set-checked"><span class="toc-number">1.13.1.20.</span> <span class="toc-text">设置单选框或复选框的状态 - page.set_checked()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8F%96%E6%B6%88%E9%80%89%E4%B8%AD%E7%9A%84%E5%8D%95%E9%80%89%E6%A1%86-page-uncheck"><span class="toc-number">1.13.1.21.</span> <span class="toc-text">取消选中的单选框 - page.uncheck()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#select%E4%B8%8B%E6%8B%89%E6%A1%86%E9%80%89%E9%A1%B9-page-select-option"><span class="toc-number">1.13.1.22.</span> <span class="toc-text">select下拉框选项 - page.select_option()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0-page-set-input-files"><span class="toc-number">1.13.1.23.</span> <span class="toc-text">文件上传 - page.set_input_files()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%85%83%E7%B4%A0%E6%8B%96%E6%8B%BD-page-drag-and-drop"><span class="toc-number">1.13.1.24.</span> <span class="toc-text">元素拖拽 - page.drag_and_drop()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%81%9A%E7%84%A6%E5%85%83%E7%B4%A0-page-focus"><span class="toc-number">1.13.1.25.</span> <span class="toc-text">聚焦元素 - page.focus()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%94%A8%E4%BA%8E%E6%A8%A1%E6%8B%9F%E6%8C%89%E4%B8%8B%E5%92%8C%E9%87%8A%E6%94%BE%E9%94%AE%E7%9B%98%E6%8C%89%E9%94%AE%E7%9A%84%E6%93%8D%E4%BD%9C-press"><span class="toc-number">1.13.1.26.</span> <span class="toc-text">用于模拟按下和释放键盘按键的操作 - press()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%AF%B9%E8%AF%9D%E6%A1%86"><span class="toc-number">1.13.1.27.</span> <span class="toc-text">对话框</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%B8%8B%E8%BD%BD"><span class="toc-number">1.13.1.28.</span> <span class="toc-text">下载</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0"><span class="toc-number">1.13.1.29.</span> <span class="toc-text">文件上传</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#iframe"><span class="toc-number">1.13.1.30.</span> <span class="toc-text">iframe</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%B3%A8%E5%86%8C%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E5%AE%9A%E4%BD%8D%E5%99%A8%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F-page-add-locator-handler"><span class="toc-number">1.13.1.31.</span> <span class="toc-text">注册自定义的定位器处理程序 - page.add_locator_handler()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%87%AA%E5%AE%9A%E4%B9%89%E5%AE%9A%E4%BD%8D%E5%A4%84%E7%90%86%E7%A8%8B%E5%BA%8F-page-remove-locator-handler"><span class="toc-number">1.13.1.32.</span> <span class="toc-text">删除自定义定位处理程序 - page.remove_locator_handler()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E7%BD%AE%E9%A1%B6-page-bring-to-front"><span class="toc-number">1.13.1.33.</span> <span class="toc-text">页面置顶 - page.bring_to_front()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%84%9A%E6%9C%AC%E8%B0%83%E8%AF%95-page-pause"><span class="toc-number">1.13.1.34.</span> <span class="toc-text">脚本调试 - page.pause()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E7%94%9F%E6%88%90pdf-page-pdf-path-%E2%80%9Dpage-pdf%E2%80%9D"><span class="toc-number">1.13.1.35.</span> <span class="toc-text">生成pdf - page.pdf(path&#x3D;”page.pdf”)</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7"><span class="toc-number">1.13.2.</span> <span class="toc-text">属性</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%A1%B5%E9%9D%A2%E7%9A%84-URL-page-url"><span class="toc-number">1.13.2.1.</span> <span class="toc-text">获取页面的 URL - page.url</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E6%B5%8F%E8%A7%88%E5%99%A8%E6%89%80%E5%B1%9E%E4%B8%8A%E4%B8%8B%E6%96%87-page-context"><span class="toc-number">1.13.2.2.</span> <span class="toc-text">获取浏览器所属上下文 - page.context</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%99%84%E5%8A%A0%E9%A1%B5%E9%9D%A2%E7%9A%84%E6%89%80%E6%9C%89%E6%A1%86%E6%9E%B6%E6%95%B0%E7%BB%84-page-frames"><span class="toc-number">1.13.2.3.</span> <span class="toc-text">获取附加页面的所有框架数组 - page.frames</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%8C%87%E7%A4%BA%E9%A1%B5%E9%9D%A2%E5%B7%B2%E5%85%B3%E9%97%AD-page-is-closed"><span class="toc-number">1.13.2.4.</span> <span class="toc-text">指示页面已关闭 - page.is_closed()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%A1%B5%E9%9D%A2%E7%9A%84%E4%B8%BB%E6%A1%86%E6%9E%B6-page-main-frame"><span class="toc-number">1.13.2.5.</span> <span class="toc-text">页面的主框架  - page.main_frame</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%A1%B5%E9%9D%A2%E5%AE%BD%E9%AB%98-page-viewport-size"><span class="toc-number">1.13.2.6.</span> <span class="toc-text">获取页面宽高 - page.viewport_size</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E9%A1%B5%E9%9D%A2%E5%85%B3%E8%81%94%E7%9A%84%E8%A7%86%E9%A2%91%E5%AF%B9%E8%B1%A1-page-video"><span class="toc-number">1.13.2.7.</span> <span class="toc-text">获取页面关联的视频对象 - page.video</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%BC%A0%E6%A0%87%E6%93%8D%E4%BD%9C"><span class="toc-number">1.14.</span> <span class="toc-text">鼠标操作</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%A7%BB%E5%8A%A8-mouse-move-x-y"><span class="toc-number">1.14.1.</span> <span class="toc-text">移动 - mouse.move(x, y)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8C%89%E4%B8%8B-mouse-down"><span class="toc-number">1.14.2.</span> <span class="toc-text">按下 - mouse . down()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8A%AC%E8%B5%B7-mouse-up"><span class="toc-number">1.14.3.</span> <span class="toc-text">抬起 - mouse.up()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%BB%9A%E8%BD%AE-mouse-whell"><span class="toc-number">1.14.4.</span> <span class="toc-text">滚轮 - mouse.whell()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%82%B9%E5%87%BB-mouse-click-x-y"><span class="toc-number">1.14.5.</span> <span class="toc-text">点击 - mouse.click(x, y)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%8C%E5%87%BB-mouse-dblclick-x-y"><span class="toc-number">1.14.6.</span> <span class="toc-text">双击 - mouse.dblclick(x, y)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%94%AE%E7%9B%98%E6%93%8D%E4%BD%9C"><span class="toc-number">1.15.</span> <span class="toc-text">键盘操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#page-keyboard-%E9%94%AE%E7%9B%98-%E5%B1%9E%E6%80%A7-%E6%96%B9%E6%B3%95"><span class="toc-number">1.16.</span> <span class="toc-text">page.keyboard 键盘 属性&amp;方法</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#keyboard-down-key"><span class="toc-number">1.16.1.</span> <span class="toc-text">keyboard.down(key) </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#keyboard-insert-text-key"><span class="toc-number">1.16.2.</span> <span class="toc-text">keyboard.insert_text(key) </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#keyboard-press-key"><span class="toc-number">1.16.3.</span> <span class="toc-text">keyboard.press(key) </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#keyboard-type"><span class="toc-number">1.16.4.</span> <span class="toc-text">keyboard.type() </span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#keyboard-up-key"><span class="toc-number">1.16.5.</span> <span class="toc-text">keyboard.up(key)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82-request"><span class="toc-number">1.17.</span> <span class="toc-text">请求 - request</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95-1"><span class="toc-number">1.17.1.</span> <span class="toc-text">方法</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%8C%85%E5%90%AB%E6%89%80%E6%9C%89%E8%AF%B7%E6%B1%82-HTTP-%E6%A0%87%E5%A4%B4-request-all-headers"><span class="toc-number">1.17.1.1.</span> <span class="toc-text">包含所有请求 HTTP 标头 - request.all_headers()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E4%B8%8E%E5%90%8D%E7%A7%B0%E5%8C%B9%E9%85%8D%E7%9A%84%E6%A0%87%E5%A4%B4%E7%9A%84%E5%80%BC-request-header-value-name"><span class="toc-number">1.17.1.2.</span> <span class="toc-text">返回与名称匹配的标头的值 - request.header_value(name)</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E6%95%B0%E7%BB%84%EF%BC%8C%E5%8C%85%E5%90%AB%E4%B8%8E%E6%AD%A4%E8%AF%B7%E6%B1%82%E5%85%B3%E8%81%94%E7%9A%84%E6%89%80%E6%9C%89%E8%AF%B7%E6%B1%82-HTTP-%E6%A0%87%E5%A4%B4-request-headers-array"><span class="toc-number">1.17.1.3.</span> <span class="toc-text">一个数组，包含与此请求关联的所有请求 HTTP 标头 - request.headers_array()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%8C%B9%E9%85%8D%E7%9A%84-%E5%93%8D%E5%BA%94-%E5%AF%B9%E8%B1%A1-request-response"><span class="toc-number">1.17.1.4.</span> <span class="toc-text">返回匹配的 响应 对象 - request.response()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E7%BB%99%E5%AE%9A%E8%AF%B7%E6%B1%82%E7%9A%84%E8%B5%84%E6%BA%90%E5%A4%A7%E5%B0%8F%E4%BF%A1%E6%81%AF-request-sizes"><span class="toc-number">1.17.1.5.</span> <span class="toc-text">返回给定请求的资源大小信息 - request.sizes()</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7-1"><span class="toc-number">1.17.2.</span> <span class="toc-text">属性</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%AE%B0%E5%BD%95%E6%89%80%E6%9C%89%E5%A4%B1%E8%B4%A5%E8%AF%B7%E6%B1%82-request-failure"><span class="toc-number">1.17.2.1.</span> <span class="toc-text">记录所有失败请求 - request.failure</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E8%AF%B7%E6%B1%82%E6%96%B9%E6%B3%95-request-method"><span class="toc-number">1.17.2.2.</span> <span class="toc-text">获取请求方法 - request.method</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%AF%B7%E6%B1%82%E7%9A%84%E5%B8%96%E5%AD%90%E6%AD%A3%E6%96%87-request-post-data"><span class="toc-number">1.17.2.3.</span> <span class="toc-text">请求的帖子正文 - request.post_data</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E8%A7%A3%E6%9E%90%E5%90%8E%E7%9A%84%E8%AF%B7%E6%B1%82%E6%AD%A3%E6%96%87-request-post-data-json"><span class="toc-number">1.17.2.4.</span> <span class="toc-text">返回解析后的请求正文 - request.post_data_json</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%87%8D%E5%AE%9A%E5%90%91%E5%89%8D%E8%AF%B7%E6%B1%82-request-redirected-from"><span class="toc-number">1.17.2.5.</span> <span class="toc-text">重定向前请求 - request.redirected_from</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E9%87%8D%E5%AE%9A%E5%90%91%E5%90%8E%E8%AF%B7%E6%B1%82-request-resource-type"><span class="toc-number">1.17.2.6.</span> <span class="toc-text">重定向后请求 - request.resource_type</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%B8%B2%E6%9F%93%E5%BC%95%E6%93%8E%E6%84%9F%E7%9F%A5%E5%88%B0%E7%9A%84%E8%AF%B7%E6%B1%82%E8%B5%84%E6%BA%90%E7%B1%BB%E5%9E%8B-request-resource-type"><span class="toc-number">1.17.2.7.</span> <span class="toc-text">渲染引擎感知到的请求资源类型 - request.resource_type</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%93%8D%E5%BA%94-response"><span class="toc-number">1.18.</span> <span class="toc-text">响应 - response</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%96%B9%E6%B3%95-2"><span class="toc-number">1.18.1.</span> <span class="toc-text">方法</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%85%B3%E8%81%94%E7%9A%84%E6%89%80%E6%9C%89%E5%93%8D%E5%BA%94-HTTP-%E6%A0%87%E5%A4%B4-response-all-headers"><span class="toc-number">1.18.1.1.</span> <span class="toc-text">关联的所有响应 HTTP 标头 - response.all_headers()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E6%AD%A3%E6%96%87%E7%9A%84%E7%BC%93%E5%86%B2%E5%8C%BA-response-body"><span class="toc-number">1.18.1.2.</span> <span class="toc-text">响应正文的缓冲区 - response.body()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E4%B8%8E%E5%90%8D%E7%A7%B0%E5%8C%B9%E9%85%8D%E7%9A%84%E6%A0%87%E5%A4%B4%E7%9A%84%E5%80%BC-header-value"><span class="toc-number">1.18.1.3.</span> <span class="toc-text">返回与名称匹配的标头的值 - header_value()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E6%95%B0%E7%BB%84%EF%BC%8C%E5%8C%85%E5%90%AB%E4%B8%8E%E6%AD%A4%E5%93%8D%E5%BA%94%E5%85%B3%E8%81%94%E7%9A%84%E6%89%80%E6%9C%89%E8%AF%B7%E6%B1%82-HTTP-%E6%A0%87%E5%A4%B4-response-headers-array"><span class="toc-number">1.18.1.4.</span> <span class="toc-text">一个数组，包含与此响应关联的所有请求 HTTP 标头 - response.headers_array()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84-IP-%E5%9C%B0%E5%9D%80%E5%92%8C%E7%AB%AF%E5%8F%A3-response-server-addr"><span class="toc-number">1.18.1.5.</span> <span class="toc-text">返回服务器的 IP 地址和端口 - response.server_addr()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%93%8D%E5%BA%94%E6%AD%A3%E6%96%87%E7%9A%84-JSON-%E8%A1%A8%E7%A4%BA%E5%BD%A2%E5%BC%8F-response-json"><span class="toc-number">1.18.1.6.</span> <span class="toc-text">返回响应正文的 JSON 表示形式 - response.json()</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%93%8D%E5%BA%94%E6%AD%A3%E6%96%87%E7%9A%84%E6%96%87%E6%9C%AC%E8%A1%A8%E7%A4%BA%E5%BD%A2%E5%BC%8F-response-text"><span class="toc-number">1.18.1.7.</span> <span class="toc-text">返回响应正文的文本表示形式 - response.text()</span></a></li></ol></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B1%9E%E6%80%A7-2"><span class="toc-number">1.18.2.</span> <span class="toc-text">属性</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA%E5%8C%85%E5%90%AB%E5%93%8D%E5%BA%94-HTTP-%E6%A0%87%E5%A4%B4%E7%9A%84%E5%AF%B9%E8%B1%A1-response-headers"><span class="toc-number">1.18.2.1.</span> <span class="toc-text">一个包含响应 HTTP 标头的对象 - response.headers</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%93%8D%E5%BA%94%E6%98%AF%E5%90%A6%E6%88%90%E5%8A%9F-response-ok"><span class="toc-number">1.18.2.2.</span> <span class="toc-text">返回响应是否成功 - response.ok</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%8C%B9%E9%85%8D%E7%9A%84-Request-%E5%AF%B9%E8%B1%A1-response-request"><span class="toc-number">1.18.2.3.</span> <span class="toc-text">返回匹配的 Request 对象 - response.request</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E5%93%8D%E5%BA%94%E7%8A%B6%E6%80%81%E7%A0%81-response-status"><span class="toc-number">1.18.2.4.</span> <span class="toc-text">返回响应状态码 - response.status</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%93%8D%E5%BA%94%E7%9A%84%E7%8A%B6%E6%80%81%E6%96%87%E6%9C%AC-%E6%88%90%E5%8A%9F%E6%97%B6%E9%80%9A%E5%B8%B8%E4%B8%BA%E2%80%9COK%E2%80%9D-response-status-text"><span class="toc-number">1.18.2.5.</span> <span class="toc-text">响应的状态文本(成功时通常为“OK”) - response.status_text</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%93%8D%E5%BA%94url-response-url"><span class="toc-number">1.18.2.6.</span> <span class="toc-text">响应url - response.url</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CDP%EF%BC%88Chrome-DevTools-Protocol%EF%BC%89%E4%BC%9A%E8%AF%9D"><span class="toc-number">1.19.</span> <span class="toc-text">CDP（Chrome DevTools Protocol）会话</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%9F%E8%B8%AA%E6%9F%A5%E7%9C%8B%E5%99%A8-Tracing"><span class="toc-number">1.20.</span> <span class="toc-text">跟踪查看器 - Tracing</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BC%80%E5%A7%8B%E8%B7%9F%E8%B8%AA-tracing-start-screenshots-True-snapshots-True"><span class="toc-number">1.20.1.</span> <span class="toc-text">开始跟踪 - tracing.start(screenshots&#x3D;True, snapshots&#x3D;True)</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9C%A8-tracing-start%E4%B8%AD%E5%BC%80%E8%BE%9F%E5%A4%9A%E4%B8%AA%E8%B7%9F%E8%B8%AA%E5%9D%97-start-chunk-stop-chunk"><span class="toc-number">1.20.2.</span> <span class="toc-text">在 tracing.start中开辟多个跟踪块 - start_chunk&amp;stop_chunk</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%BB%93%E6%9D%9F%E8%B7%9F%E8%B8%AA%E5%B9%B6%E7%94%9F%E6%88%90%E6%96%87%E4%BB%B6-tracing-stop-path-%E2%80%9Dtrace-zip%E2%80%9D"><span class="toc-number">1.20.3.</span> <span class="toc-text">结束跟踪并生成文件 - tracing.stop(path&#x3D;”trace.zip”)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A7%86%E9%A2%91-page-video"><span class="toc-number">1.21.</span> <span class="toc-text">视频 - page.video</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%88%A0%E9%99%A4%E8%A7%86%E9%A2%91%E6%96%87%E4%BB%B6-page-video-delete"><span class="toc-number">1.21.1.</span> <span class="toc-text">删除视频文件 - page.video.delete()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%BF%94%E5%9B%9E%E6%AD%A4%E8%A7%86%E9%A2%91%E5%B0%86%E5%BD%95%E5%88%B6%E5%88%B0%E7%9A%84%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F%E8%B7%AF%E5%BE%84-page-video-path"><span class="toc-number">1.21.2.</span> <span class="toc-text">返回此视频将录制到的文件系统路径 - page.video.path()</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B0%86%E8%A7%86%E9%A2%91%E4%BF%9D%E5%AD%98%E5%88%B0%E7%94%A8%E6%88%B7%E6%8C%87%E5%AE%9A%E7%9A%84%E8%B7%AF%E5%BE%84-page-video-save-as-path"><span class="toc-number">1.21.3.</span> <span class="toc-text">将视频保存到用户指定的路径 - page.video.save_as(path)</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%94%99%E8%AF%AF%E5%A4%84%E7%90%86-WebError"><span class="toc-number">1.22.</span> <span class="toc-text">错误处理 - WebError</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%8A%9B%E5%87%BA%E6%9C%AA%E5%A4%84%E7%90%86%E9%94%99%E8%AF%AF-web-error-error"><span class="toc-number">1.22.1.</span> <span class="toc-text">抛出未处理错误 - web_error.error</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BA%A7%E7%94%9F%E6%AD%A4%E6%9C%AA%E5%A4%84%E7%90%86%E5%BC%82%E5%B8%B8%E7%9A%84%E9%A1%B5%E9%9D%A2-web-error-page"><span class="toc-number">1.22.2.</span> <span class="toc-text">产生此未处理异常的页面 - web_error.page</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B7%AF%E7%94%B1-route"><span class="toc-number">1.23.</span> <span class="toc-text">路由 - route</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#tracing-%E8%A7%A3%E6%9E%90"><span class="toc-number">1.24.</span> <span class="toc-text">tracing 解析</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2025/01/14/SQLite/" title="SQLite"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="SQLite"/></a><div class="content"><a class="title" href="/2025/01/14/SQLite/" title="SQLite">SQLite</a><time datetime="2025-01-13T16:52:36.000Z" title="发表于 2025-01-14 00:52:36">2025-01-14</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/29/xpath%E8%AF%AD%E6%B3%95/" title="Xpath语法"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Xpath语法"/></a><div class="content"><a class="title" href="/2024/09/29/xpath%E8%AF%AD%E6%B3%95/" title="Xpath语法">Xpath语法</a><time datetime="2024-09-29T15:57:28.000Z" title="发表于 2024-09-29 23:57:28">2024-09-29</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/26/playwright%E6%A1%86%E6%9E%B6/" title="Playwright框架"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Playwright框架"/></a><div class="content"><a class="title" href="/2024/09/26/playwright%E6%A1%86%E6%9E%B6/" title="Playwright框架">Playwright框架</a><time datetime="2024-09-26T14:29:59.000Z" title="发表于 2024-09-26 22:29:59">2024-09-26</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/21/pywinauto-WIN-PC%E7%AB%AF%E8%87%AA%E5%8A%A8%E5%8C%96/" title="pywinauto_PC端自动化"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="pywinauto_PC端自动化"/></a><div class="content"><a class="title" href="/2024/09/21/pywinauto-WIN-PC%E7%AB%AF%E8%87%AA%E5%8A%A8%E5%8C%96/" title="pywinauto_PC端自动化">pywinauto_PC端自动化</a><time datetime="2024-09-21T02:35:00.000Z" title="发表于 2024-09-21 10:35:00">2024-09-21</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/09/12/pytest-hooks/" title="Pytest-Hooks"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Pytest-Hooks"/></a><div class="content"><a class="title" href="/2024/09/12/pytest-hooks/" title="Pytest-Hooks">Pytest-Hooks</a><time datetime="2024-09-12T07:38:15.000Z" title="发表于 2024-09-12 15:38:15">2024-09-12</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2025 By fafafa</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.14.0-b3"></script><script src="/js/main.js?v=4.14.0-b3"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.35/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.0.5/dist/lazyload.iife.min.js"></script><script>(() => {
  const panguFn = () => {
    if (typeof pangu === 'object') pangu.autoSpacingPage()
    else {
      btf.getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
        .then(() => {
          pangu.autoSpacingPage()
        })
    }
  }

  const panguInit = () => {
    if (false){
      GLOBAL_CONFIG_SITE.isPost && panguFn()
    } else {
      panguFn()
    }
  }

  btf.addGlobalFn('pjaxComplete', panguInit, 'pangu')
  document.addEventListener('DOMContentLoaded', panguInit)
})()</script><div class="js-pjax"><script>(() => {
  const runMermaid = (ele) => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from(ele).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return
    
    codeMermaidEle.forEach(ele => {
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.innerHTML = `<pre class="mermaid-src" hidden>${ele.textContent}</pre>`
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@10.9.0/dist/mermaid.min.js').then(runMermaidFn)
  }
  
  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.14.0-b3"></script></div></div></body></html>