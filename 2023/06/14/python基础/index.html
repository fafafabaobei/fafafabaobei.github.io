<!DOCTYPE html><html lang="zh-CN" data-theme="light"><head><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0,viewport-fit=cover"><title>Python基础 | fafafabaobei</title><meta name="author" content="fafafa"><meta name="copyright" content="fafafa"><meta name="format-detection" content="telephone=no"><meta name="theme-color" content="#ffffff"><meta name="description" content="基础简介​	Python是一门动态、解释型、强类型语言  动态：在运行期间才做数据检查（不用提前声明变量）- 静态语音(C&#x2F;Java)：编译时检查数据类型（编码时需要声明变量类型） 解释型：在执行程序时，才一条条解释成机器语言给计算机执行（无需编译，速度较慢）- 编译型语言(C&#x2F;Java)：先要将代码编译成二进制可执行文件，再执行 强类型：类型安全，变量一旦被指定了数据类型，如">
<meta property="og:type" content="article">
<meta property="og:title" content="Python基础">
<meta property="og:url" content="https://fafafabaobei.github.io/2023/06/14/python%E5%9F%BA%E7%A1%80/index.html">
<meta property="og:site_name" content="fafafabaobei">
<meta property="og:description" content="基础简介​	Python是一门动态、解释型、强类型语言  动态：在运行期间才做数据检查（不用提前声明变量）- 静态语音(C&#x2F;Java)：编译时检查数据类型（编码时需要声明变量类型） 解释型：在执行程序时，才一条条解释成机器语言给计算机执行（无需编译，速度较慢）- 编译型语言(C&#x2F;Java)：先要将代码编译成二进制可执行文件，再执行 强类型：类型安全，变量一旦被指定了数据类型，如">
<meta property="og:locale" content="zh_CN">
<meta property="og:image" content="https://tse2-mm.cn.bing.net/th/id/OIP-C.dSMliGMR1gP-nfkwknp26QHaDt?w=314&h=175&c=7&r=0&o=5&dpr=1.3&pid=1.7">
<meta property="article:published_time" content="2023-06-14T14:31:23.000Z">
<meta property="article:modified_time" content="2023-06-14T14:31:23.000Z">
<meta property="article:author" content="fafafa">
<meta property="article:tag" content="python">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="https://tse2-mm.cn.bing.net/th/id/OIP-C.dSMliGMR1gP-nfkwknp26QHaDt?w=314&h=175&c=7&r=0&o=5&dpr=1.3&pid=1.7"><link rel="shortcut icon" href="/img/blog.png"><link rel="canonical" href="https://fafafabaobei.github.io/2023/06/14/python%E5%9F%BA%E7%A1%80/index.html"><link rel="preconnect" href="//cdn.jsdelivr.net"/><link rel="preconnect" href="//busuanzi.ibruce.info"/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><meta/><link rel="stylesheet" href="/css/index.css?v=4.14.0-b3"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@6.5.1/css/all.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.35/dist/fancybox/fancybox.min.css" media="print" onload="this.media='all'"><script>(()=>{
      const saveToLocal = {
        set: (key, value, ttl) => {
          if (ttl === 0) return
          const now = Date.now()
          const expiry = now + ttl * 86400000
          const item = {
            value,
            expiry
          }
          localStorage.setItem(key, JSON.stringify(item))
        },
      
        get: key => {
          const itemStr = localStorage.getItem(key)
      
          if (!itemStr) {
            return undefined
          }
          const item = JSON.parse(itemStr)
          const now = Date.now()
      
          if (now > item.expiry) {
            localStorage.removeItem(key)
            return undefined
          }
          return item.value
        }
      }
      
      window.btf = {
        saveToLocal: saveToLocal,
        getScript: (url, attr = {}) => new Promise((resolve, reject) => {
          const script = document.createElement('script')
          script.src = url
          script.async = true
          script.onerror = reject
          script.onload = script.onreadystatechange = function() {
            const loadState = this.readyState
            if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
            script.onload = script.onreadystatechange = null
            resolve()
          }

          Object.keys(attr).forEach(key => {
            script.setAttribute(key, attr[key])
          })

          document.head.appendChild(script)
        }),

        getCSS: (url, id = false) => new Promise((resolve, reject) => {
          const link = document.createElement('link')
          link.rel = 'stylesheet'
          link.href = url
          if (id) link.id = id
          link.onerror = reject
          link.onload = link.onreadystatechange = function() {
            const loadState = this.readyState
            if (loadState && loadState !== 'loaded' && loadState !== 'complete') return
            link.onload = link.onreadystatechange = null
            resolve()
          }
          document.head.appendChild(link)
        }),

        addGlobalFn: (key, fn, name = false, parent = window) => {
          const pjaxEnable = false
          if (!pjaxEnable && key.startsWith('pjax')) return

          const globalFn = parent.globalFn || {}
          const keyObj = globalFn[key] || {}
    
          if (name && keyObj[name]) return
    
          name = name || Object.keys(keyObj).length
          keyObj[name] = fn
          globalFn[key] = keyObj
          parent.globalFn = globalFn
        }
      }
    
      const activateDarkMode = () => {
        document.documentElement.setAttribute('data-theme', 'dark')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#0d0d0d')
        }
      }
      const activateLightMode = () => {
        document.documentElement.setAttribute('data-theme', 'light')
        if (document.querySelector('meta[name="theme-color"]') !== null) {
          document.querySelector('meta[name="theme-color"]').setAttribute('content', '#ffffff')
        }
      }

      btf.activateDarkMode = activateDarkMode
      btf.activateLightMode = activateLightMode
      
      const t = saveToLocal.get('theme')
    
        if (t === 'dark') activateDarkMode()
        else if (t === 'light') activateLightMode()
      
      const asideStatus = saveToLocal.get('aside-status')
      if (asideStatus !== undefined) {
        if (asideStatus === 'hide') {
          document.documentElement.classList.add('hide-aside')
        } else {
          document.documentElement.classList.remove('hide-aside')
        }
      }
    
      const detectApple = () => {
        if(/iPad|iPhone|iPod|Macintosh/.test(navigator.userAgent)){
          document.documentElement.classList.add('apple')
        }
      }
      detectApple()
    })()</script><script>const GLOBAL_CONFIG = {
  root: '/',
  algolia: undefined,
  localSearch: {"path":"/search.xml","preload":false,"top_n_per_article":1,"unescape":false,"languages":{"hits_empty":"找不到您查询的内容：${query}","hits_stats":"共找到 ${hits} 篇文章"}},
  translate: undefined,
  noticeOutdate: undefined,
  highlight: {"plugin":"highlight.js","highlightCopy":true,"highlightLang":true,"highlightHeightLimit":false,"highlightFullpage":true,"highlightMacStyle":true},
  copy: {
    success: '复制成功',
    error: '复制错误',
    noSupport: '浏览器不支持'
  },
  relativeDate: {
    homepage: false,
    post: false
  },
  runtime: '天',
  dateSuffix: {
    just: '刚刚',
    min: '分钟前',
    hour: '小时前',
    day: '天前',
    month: '个月前'
  },
  copyright: undefined,
  lightbox: 'fancybox',
  Snackbar: undefined,
  infinitegrid: {
    js: 'https://cdn.jsdelivr.net/npm/@egjs/infinitegrid@4.11.1/dist/infinitegrid.min.js',
    buttonText: '加载更多'
  },
  isPhotoFigcaption: true,
  islazyload: true,
  isAnchor: false,
  percent: {
    toc: true,
    rightside: false,
  },
  autoDarkmode: false
}</script><script id="config-diff">var GLOBAL_CONFIG_SITE = {
  title: 'Python基础',
  isPost: true,
  isHome: false,
  isHighlightShrink: false,
  isToc: true,
  postUpdate: '2023-06-14 22:31:23'
}</script><meta name="generator" content="Hexo 7.2.0"></head><body><div id="loading-box"><div class="loading-left-bg"></div><div class="loading-right-bg"></div><div class="spinner-box"><div class="configure-border-1"><div class="configure-core"></div></div><div class="configure-border-2"><div class="configure-core"></div></div><div class="loading-word">加载中...</div></div></div><script>(()=>{
  const $loadingBox = document.getElementById('loading-box')
  const $body = document.body
  const preloader = {
    endLoading: () => {
      $body.style.overflow = ''
      $loadingBox.classList.add('loaded')
    },
    initLoading: () => {
      $body.style.overflow = 'hidden'
      $loadingBox.classList.remove('loaded')
    }
  }

  preloader.initLoading()
  window.addEventListener('load',() => { preloader.endLoading() })

  if (false) {
    btf.addGlobalFn('pjaxSend', () => { preloader.initLoading() }, 'preloader_init')
    btf.addGlobalFn('pjaxComplete', () => { preloader.endLoading() }, 'preloader_end')
  }
})()</script><div id="web_bg"></div><div id="sidebar"><div id="menu-mask"></div><div id="sidebar-menus"><div class="avatar-img is-center"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/fafafa.jpg" onerror="onerror=null;src='/img/friend_404.gif'" alt="avatar"/></div><div class="sidebar-site-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">40</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">25</div></a></div><hr class="custom-hr"/><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 其他</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div></div></div><div class="post" id="body-wrap"><header class="post-bg" id="page-header" style="background-image: url('https://tse2-mm.cn.bing.net/th/id/OIP-C.dSMliGMR1gP-nfkwknp26QHaDt?w=314&amp;h=175&amp;c=7&amp;r=0&amp;o=5&amp;dpr=1.3&amp;pid=1.7')"><nav id="nav"><span id="blog-info"><a href="/" title="fafafabaobei"><img class="site-icon" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/blog.png" alt="Logo"/><span class="site-name">fafafabaobei</span></a></span><div id="menus"><div id="search-button"><span class="site-page social-icon search"><i class="fas fa-search fa-fw"></i><span> 搜索</span></span></div><div class="menus_items"><div class="menus_item"><a class="site-page" href="/"><i class="fa-fw fas fa-home"></i><span> 首页</span></a></div><div class="menus_item"><a class="site-page" href="/archives/"><i class="fa-fw fas fa-archive"></i><span> 归档</span></a></div><div class="menus_item"><a class="site-page" href="/tags/"><i class="fa-fw fas fa-tags"></i><span> 标签</span></a></div><div class="menus_item"><span class="site-page group"><i class="fa-fw fas fa-list"></i><span> 其他</span><i class="fas fa-chevron-down"></i></span><ul class="menus_item_child"><li><a class="site-page child" href="/music/"><i class="fa-fw fas fa-music"></i><span> Music</span></a></li><li><a class="site-page child" href="/movies/"><i class="fa-fw fas fa-video"></i><span> Movie</span></a></li></ul></div><div class="menus_item"><a class="site-page" href="/about/"><i class="fa-fw fas fa-heart"></i><span> 关于我</span></a></div></div><div id="toggle-menu"><span class="site-page"><i class="fas fa-bars fa-fw"></i></span></div></div></nav><div id="post-info"><h1 class="post-title">Python基础<a class="post-edit-link" href="null_posts/python基础.md" title="编辑" target="_blank"><i class="fas fa-pencil-alt"></i></a></h1><div id="post-meta"><div class="meta-firstline"><span class="post-meta-date"><i class="far fa-calendar-alt fa-fw post-meta-icon"></i><span class="post-meta-label">发表于</span><time class="post-meta-date-created" datetime="2023-06-14T14:31:23.000Z" title="发表于 2023-06-14 22:31:23">2023-06-14</time><span class="post-meta-separator">|</span><i class="fas fa-history fa-fw post-meta-icon"></i><span class="post-meta-label">更新于</span><time class="post-meta-date-updated" datetime="2023-06-14T14:31:23.000Z" title="更新于 2023-06-14 22:31:23">2023-06-14</time></span><span class="post-meta-categories"><span class="post-meta-separator">|</span><i class="fas fa-inbox fa-fw post-meta-icon"></i><a class="post-meta-categories" href="/categories/python/">python</a></span></div><div class="meta-secondline"><span class="post-meta-separator">|</span><span class="post-meta-wordcount"><i class="far fa-file-word fa-fw post-meta-icon"></i><span class="post-meta-label">字数总计:</span><span class="word-count">40.2k</span><span class="post-meta-separator">|</span><i class="far fa-clock fa-fw post-meta-icon"></i><span class="post-meta-label">阅读时长:</span><span>161分钟</span></span><span class="post-meta-separator">|</span><span class="post-meta-pv-cv" id="" data-flag-title="Python基础"><i class="far fa-eye fa-fw post-meta-icon"></i><span class="post-meta-label">阅读量:</span><span id="busuanzi_value_page_pv"><i class="fa-solid fa-spinner fa-spin"></i></span></span></div></div></div></header><main class="layout" id="content-inner"><div id="post"><article class="post-content" id="article-container"><h2 id="基础"><a href="#基础" class="headerlink" title="基础"></a>基础</h2><h3 id="简介"><a href="#简介" class="headerlink" title="简介"></a>简介</h3><p>​	Python是一门动态、解释型、强类型语言</p>
<ol>
<li>动态：在运行期间才做数据检查（不用提前声明变量）- 静态语音(C&#x2F;Java)：编译时检查数据类型（编码时需要声明变量类型）</li>
<li>解释型：在执行程序时，才一条条解释成机器语言给计算机执行（无需编译，速度较慢）- 编译型语言(C&#x2F;Java)：先要将代码编译成二进制可执行文件，再执行</li>
<li>强类型：类型安全，变量一旦被指定了数据类型，如果不强制转换，那么永远是这种类型（严谨，避免类型错误，速度较慢）- 弱类型（VBScript&#x2F;JavaScript）: 类型在运行期间会转化，如 js中的 1+”2”&#x3D;”12”, 1会由数字转化为string</li>
</ol>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2023/06/14/python%E5%9F%BA%E7%A1%80/python%E8%A7%A3%E6%9E%90%E5%99%A8.png" alt="python解析器"></p>
<p><strong>优点</strong></p>
<ol>
<li>简单易学</li>
<li>开发效率高</li>
<li>高级语言</li>
<li>可移植、可扩展、可嵌入</li>
<li>庞大的三方库</li>
</ol>
<p><strong>缺点</strong></p>
<ol>
<li>速度慢</li>
<li>代码不能加密</li>
<li>多线程不能充分利用多核cpu(GIL全局解释性锁，同一时刻只能运行一个线程</li>
</ol>
<p><strong>应用领域</strong></p>
<ol>
<li>自动化测试（UI&#x2F;接口）</li>
<li>自动化运维</li>
<li>爬虫</li>
<li>Web开发（Django&#x2F;Flask&#x2F;..)</li>
<li>图形GUI开发</li>
<li>游戏脚本</li>
<li>金融、量化交易</li>
<li>数据分析，大数据</li>
<li>人工智能、机器学习、NLP、计算机视觉</li>
<li>云计算</li>
</ol>
<h3 id="环境搭建"><a href="#环境搭建" class="headerlink" title="环境搭建"></a>环境搭建</h3><p>Windows Python3环境搭建</p>
<ol>
<li>从<a target="_blank" rel="noopener" href="https://www.python.org/getit/">Python官网</a>，下载Python3安装包</li>
<li>双击安装，第一个节目选中Add Python3.* to PATH，点击Install Now(默认安装pip)，一路下一步</li>
<li>验证：打开cmd命令行，输入python，应能进入python shell 并显示为Python 3.6.5版本</li>
</ol>
<p>Mac OS Python3环境搭建</p>
<ol>
<li>安装brew：在终端执行以下命令 <code>ruby -e &quot;$(curl -fsSL https://raw.github.com/mxcl/homebrew/go)&quot;</code></li>
<li>使用brew安装python3：<code>brew install python3</code></li>
</ol>
<p>CentOS Python3环境搭建</p>
<ol>
<li><p>安装依赖包</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">yum install zlib-devel bzip2-devel openssl-devel ncurses-devel sqlite-devel readline-devel tk-devel gcc make</span><br><span class="line">yum install libffi-devel -y</span><br></pre></td></tr></table></figure>
</li>
<li><p>下载Python3源码安装</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">wget https://www.python.org/ftp/python/3.7.0/Python-3.7.0.tgz</span><br><span class="line">tar -zxvf Python-3.7.0.tgz</span><br><span class="line"><span class="built_in">cd</span> Python-3.7.0</span><br><span class="line">./configure --prefix=/usr/local/python37</span><br><span class="line">make &amp; make install</span><br></pre></td></tr></table></figure>
</li>
<li><p>建立软连接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">ln</span> -s /usr/local/python37/bin/python3.7 /usr/bin/python3</span><br><span class="line"><span class="built_in">ln</span> -s /usr/local/python37/bin/pip3 /usr/bin/pip3</span><br></pre></td></tr></table></figure>
</li>
<li><p>添加环境变量</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">export</span> PATH=<span class="variable">$PATH</span>:/usr/local/python37/bin</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line">vim ~/.bashrc, 增加</span><br></pre></td></tr></table></figure></li>
</ol>
<h3 id="包管理工具-pip"><a href="#包管理工具-pip" class="headerlink" title="包管理工具-pip"></a>包管理工具-pip</h3><h4 id="在线安装库文件"><a href="#在线安装库文件" class="headerlink" title="在线安装库文件"></a>在线安装库文件</h4><ul>
<li>在线安装：<code>pip install 包名</code></li>
<li>从豆瓣源查找安装：<code>pip install 包名 -i https://pypi.doubanio.com/simple/</code></li>
<li>直接从GitHub安装：<code>git+https://github.com/hanzhichao/logz</code></li>
<li>一次安装多个：<code>pip install 包1 包2</code></li>
<li>指定安装版本：<code>pip install 包名==1.5.6</code></li>
<li>升级到包的最新版本：·pip install 包名 –upgrade·</li>
<li>卸载包：pip uninstall 包名</li>
<li>批量安装requiements.txt文件中所有列出的包：<code>pip install -r requiements.txt</code></li>
<li>查看已安装包的信息：<code>pip show 包名</code></li>
<li>查看已安装的所有包：<code>pip list</code></li>
<li>导出当前环境所有安装的包：<code>pip freeze &gt; requirements.txt</code></li>
</ul>
<h4 id="修改pip源"><a href="#修改pip源" class="headerlink" title="修改pip源"></a>修改pip源</h4><p>​	Linux&#x2F;MacOS下，修改 ~&#x2F;.pip&#x2F;pip.conf (没有就创建一个)，windows下，直接在user目录中创建一个pip目录，如：C:\Users\xx\pip，新建文件pip.ini，内容如下：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[global]</span></span><br><span class="line"><span class="attr">index-url</span> = https://pypi.tuna.tsinghua.edu.cn/simple</span><br><span class="line"><span class="comment">#豆瓣：http://pypi.douban.com/simple/</span></span><br><span class="line"><span class="comment">#中科大：https://pypi.mirrors.ustc.edu.cn/simple/</span></span><br><span class="line"><span class="comment">#清华：https://pypi.tuna.tsinghua.edu.cn/simple</span></span><br></pre></td></tr></table></figure>

<h4 id="pip-离线安装"><a href="#pip-离线安装" class="headerlink" title="pip 离线安装"></a>pip 离线安装</h4><ul>
<li>离线安装<ol>
<li>从<a target="_blank" rel="noopener" href="https://pypi.org/">Pypi.org</a>网站查找需要的包，下载.whl文件</li>
<li>使用pip install &lt;下载的whl包&gt;  进行本地whl文件安装</li>
</ol>
</li>
<li>源码安装<ol>
<li>从<a target="_blank" rel="noopener" href="https://pypi.org/">Pypi.org</a>下载源码包，解压，进入解压目录</li>
<li>打开命令行，执行 <code>python setup.py install</code></li>
<li>验证：pip list  进行查找</li>
</ol>
</li>
</ul>
<h3 id="语法"><a href="#语法" class="headerlink" title="语法"></a>语法</h3><h4 id="缩进"><a href="#缩进" class="headerlink" title="缩进"></a>缩进</h4><p>​	python 语法没有 { } 代码块，严格按照缩进进行代码块的规范</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> x &gt; <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正数&quot;</span>)</span><br><span class="line"><span class="keyword">elif</span> x = <span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;0&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;负数&quot;</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="keyword">return</span> x+y</span><br></pre></td></tr></table></figure>



<h4 id="一行多条语句"><a href="#一行多条语句" class="headerlink" title="一行多条语句"></a>一行多条语句</h4><p> 除了可以利用换行进行语句结束划分，也可以使用 ;</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">x=<span class="number">1</span>; y=<span class="number">2</span>; <span class="built_in">print</span>(x+y)</span><br></pre></td></tr></table></figure>



<h4 id="断行"><a href="#断行" class="headerlink" title="断行"></a>断行</h4><p>当一行语句太长时，会显得累赘；可以使用 ‘\‘ 将两行语句归为一行</p>
<h4 id="注释"><a href="#注释" class="headerlink" title="注释"></a>注释</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 单行注释</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">多行注释</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line"><span class="string">多行注释，也可以代表函数说明</span></span><br><span class="line"><span class="string">使用三个单引号（&#x27;&#x27;&#x27; &#x27;&#x27;&#x27;）或三个双引号（&quot;&quot;&quot;</span> <span class="string">&quot;&quot;&quot;）来创建多行注释</span></span><br><span class="line"><span class="string">用法：三个单引号和三个双引号都可以用来创建多行注释。两者的作用是一样的，都可以用于对代码进行注释和说明。</span></span><br><span class="line"><span class="string">使用双引号时，你不需要转义单引号，而使用单引号时则需要转义双引号。</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br></pre></td></tr></table></figure>



<h4 id="类型注释"><a href="#类型注释" class="headerlink" title="类型注释"></a>类型注释</h4><p>在函数中，可以对参数及返回值类型进行注释</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x: <span class="built_in">int</span>, y: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:</span><br><span class="line">    <span class="keyword">return</span> x+y</span><br></pre></td></tr></table></figure>



<h4 id="变量"><a href="#变量" class="headerlink" title="变量"></a>变量</h4><ol>
<li><p>变量类型（局部变量、全局变量、系统变量）</p>
</li>
<li><p>变量赋值</p>
<ul>
<li><p>多重赋值<code>x=y=z=1</code></p>
</li>
<li><p>多元赋值<code>x,y = y,x</code></p>
</li>
</ul>
</li>
<li><p>变量自增 <code>x+=1</code>，<code>x-=1</code>(不支持<code>x++</code>, <code>x--</code>)</p>
</li>
<li><p>Python 语言本身没有提供内置的常量机制，但是通常使用全大写命名的变量来表示常量，在 Python 3.8 中引入了 <code>typing.Final</code> 来标识一个变量为最终值；Python 中，使用约定而不是强制，不像Java 有明确的常量关键字 <code>final</code> 来定义常量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> typing <span class="keyword">import</span> Final</span><br><span class="line">PI: Final = <span class="number">3.14159</span></span><br></pre></td></tr></table></figure></li>
</ol>
<h4 id="运算符"><a href="#运算符" class="headerlink" title="运算符"></a>运算符</h4><ul>
<li><p>算术运算符：一般用于数字类型的计算</p>
<ul>
<li>+：加，如 <code>1+2</code>，结果为3，在字符串中为连接，如<code>&#39;1&#39; + &#39;2&#39;</code>，结果为’12’，不同类型不能直接相加。</li>
<li><ul>
<li>：减，如 <code>3-1</code>，结果2</li>
</ul>
</li>
<li><em>：乘，如&#96;2</em>3，结果为6</li>
<li>&#x2F;：除：如 <code>3/2</code>，结果为1.5</li>
<li>&#x2F;&#x2F;：地板除（只向下保留整数），如<code>3//2</code>，结果为1，<code>3//-2</code>，结果为-2</li>
<li>**：乘方，如<code>4**2</code>，结果为16</li>
<li>%： 取余，如果<code>5%2</code>，结果为1</li>
</ul>
</li>
<li><p>比较运算符：可用于两个相同类型对象的比较</p>
<ul>
<li>&#x3D;&#x3D;：相等比较，如<code>1+1==2</code>，结果为True，<code>&#123;&#39;a&#39;: 1, &#39;b&#39;: 2&#125; = &#123;&#39;b&#39;: 1 , &#39;a&#39;: 1&#125;</code>，结果为True</li>
<li>!&#x3D;：比较是否不等，如<code>1+1 != 3</code>，结果为True，<code>[1,2,3] != [2,1,3]</code>，结果为True</li>
<li>&lt;：比较小于</li>
<li>&lt;&#x3D;：比较小于等于</li>
</ul>
</li>
<li><p>身份运算符：用于判断是否同一对象</p>
<ul>
<li>is：判断是同一对象，’&#x3D;&#x3D;’只判断值是否相等，如<code>True==1</code>，is则判断是否同一对象（使用id()得出的内存地址相同），2&gt;1 is True<code>，结果为True，</code>a&#x3D;None;a is None&#96;，结果为True</li>
<li>is not：判断非同一对象，如<code>True is not 1</code>结果为True。</li>
</ul>
</li>
<li><p>赋值运算符：用于将值赋给变量</p>
<ul>
<li>&#x3D;：赋值，如<code>a = 1</code>，将1赋给变量a，支持多重赋值，如<code>a,b = 1,2</code>或<code>a,b=[1,2]</code>（赋值时序列会自动解包变为1,2两个变量），结果为将1赋给a，将2赋给b</li>
<li>+&#x3D;：变量自增，如<code>a+=1</code>相当于<code>a=a+1</code></li>
<li>-&#x3D;: 自减</li>
<li>*&#x3D;：自乘</li>
<li>&#x2F;&#x3D;：自除</li>
<li>&#x2F;&#x2F;&#x3D;：自地板除</li>
<li>**&#x3D;：自乘方</li>
<li>%&#x3D;：自取余</li>
</ul>
</li>
<li><p>逻辑运算符：用于多个表达式的逻辑判断，有短路效应</p>
<ul>
<li>and：并且，如<code>1&gt;2 and 1&gt;0</code>，都为真时返回最后一个结果的值。当第一个条件为假时不执行后面的判断，直接返回False，如果第一个条件为真时结果为第二个判断的结果（本例实际1&gt;0不会执行）</li>
<li>or：或，如<code>1&gt;2 or 1&gt;0</code>，返回第一个为真的值或都无假时返回最后一个结果的值。当第一个条件为真是不执行后面的判断，直接返回True，否则返回第二个结果的值（本例1&gt;0会执行）</li>
<li>not：非，如<code>not 1&gt;2</code>，结果为True</li>
</ul>
</li>
<li><p>成员运算符：用于判断包含，常用判断字符串、列表、元祖、集合、字典中是否包含某元素（某键值）</p>
<ul>
<li>in：是否在其中，如<code>a in &#39;abcd&#39;</code>，结果为True，或<code>1 in [1,2,3]</code>，结果为True，或<code>&#39;name&#39; in &#123;&#39;name&#39;: &#39;kevin&#39;, &#39;age&#39;: 12&#125;</code>，结果为True。</li>
<li>not in：判断不包含，如<code>a not in &#39;bcde&#39;</code>结果为True，从效率上由于not in会对比所有的元素，因此效率比使用in低</li>
</ul>
</li>
<li><p>位运算符：用于二进制或集合运算</p>
<ul>
<li>&amp;：按位与</li>
<li>|：按位或</li>
<li>~：按位取反</li>
<li>^：按位异或</li>
<li>&lt;&lt;：左移</li>
</ul>
</li>
</ul>
<h4 id="运算符优先级-从高到低"><a href="#运算符优先级-从高到低" class="headerlink" title="运算符优先级 ( 从高到低)"></a>运算符优先级 ( 从高到低)</h4><table>
<thead>
<tr>
<th align="center">运算符</th>
<th align="center">描述</th>
</tr>
</thead>
<tbody><tr>
<td align="center">**</td>
<td align="center">指数（最高优先级）</td>
</tr>
<tr>
<td align="center">~、+、-</td>
<td align="center">按位翻转，一元加号和减号（最后两个的方法名为+@和-@）</td>
</tr>
<tr>
<td align="center">*、&#x2F;、%、&#x2F;&#x2F;</td>
<td align="center">乘、除、取模和取整除</td>
</tr>
<tr>
<td align="center">+、-</td>
<td align="center">加法、减法</td>
</tr>
<tr>
<td align="center">&gt;&gt;、&lt;&lt;</td>
<td align="center">右移、左移运算符</td>
</tr>
<tr>
<td align="center">&amp;</td>
<td align="center">位与</td>
</tr>
<tr>
<td align="center">^、|</td>
<td align="center">位运算符</td>
</tr>
<tr>
<td align="center">&lt;&#x3D;、&lt;、&gt;、&gt;&#x3D;</td>
<td align="center">比较运算符</td>
</tr>
<tr>
<td align="center">&lt;&gt; &#x3D;&#x3D; !&#x3D;</td>
<td align="center">等于运算符</td>
</tr>
<tr>
<td align="center">&#x3D; %&#x3D; &#x2F;&#x3D; &#x2F;&#x2F;&#x3D; -&#x3D; +&#x3D; *&#x3D; **&#x3D;</td>
<td align="center">赋值运算符</td>
</tr>
<tr>
<td align="center">is  is not</td>
<td align="center">身份运算符</td>
</tr>
<tr>
<td align="center">in  in not</td>
<td align="center">成员运算符</td>
</tr>
<tr>
<td align="center">not or and</td>
<td align="center">逻辑运算符</td>
</tr>
</tbody></table>
<p><code>[&#39;&#39;]</code>，<code>[[],[]]</code>由于不是空列表，在逻辑判断时被认为是True。</p>
<h4 id="表达式与语句"><a href="#表达式与语句" class="headerlink" title="表达式与语句"></a>表达式与语句</h4><p>​		Python代码由表达式和语句组成；表达式(Expression)是运算符(operator)和操作数(operand)所构成的序列,语句是让计算机执行特定操作的指示</p>
<ul>
<li><p>表达式</p>
<p>表达式一般结果为一个Python对象，如<code>1+2</code>, <code>int(&#39;123&#39;)</code>，<code>range(10)</code><br>表达式一般可以包含算数运算符、比较运算符、逻辑运算符、成员运算符、位运算符，但不能包含赋值运算符</p>
<p>由于表达式计算后返回一个Python对象，因此表达式可以当做待计算的变量一样使用</p>
</li>
<li><p>语句</p>
<p>结果不是对象的代码则成为‘语句’。它们表示的是一个动作而不是生成或者返回一个值。</p>
<p>常见的Python语句有：</p>
<ul>
<li>赋值语句</li>
<li>调用</li>
<li>print：打印对象</li>
<li>if&#x2F;elif&#x2F;else</li>
<li>for&#x2F;else、while&#x2F;else</li>
<li>pass</li>
<li>break、continue</li>
<li>def</li>
<li>return、yield</li>
<li>global</li>
<li>raise</li>
<li>import、from … import</li>
</ul>
</li>
</ul>
<h3 id="基本数据类型"><a href="#基本数据类型" class="headerlink" title="基本数据类型"></a>基本数据类型</h3><h4 id="数据类型"><a href="#数据类型" class="headerlink" title="数据类型"></a>数据类型</h4><p>Python基本的数据类型包含10种，分别是：</p>
<ul>
<li>整数（int）：表示整数值，例如：5、-10、100。</li>
<li>浮点数（float）：表示带有小数点的数值，例如：3.14、-2.5、1.0。</li>
<li>布尔类型（bool）：表示真（True）或假（False）的值。</li>
<li>字符串类型（str）：表示文本数据，使用单引号（’）或双引号（”）括起来，例如：”Hello”、’World’。</li>
<li>列表类型（list）：表示有序、可变的集合，可以包含不同类型的元素，使用方括号（[]）括起来，例如：[1, 2, ‘three’, True]。</li>
<li>元组类型（tuple）：表示有序、不可变的集合，可以包含不同类型的元素，使用圆括号（()）括起来，例如：(1, 2, ‘three’, True)。</li>
<li>集合类型（set）：表示无序、唯一的元素集合，不包含重复的元素，使用大括号（{}）或 set() 函数创建，例如：{1, 2, 3}、set([1, 2, 3])。</li>
<li>字典类型（dict）：表示键值对的集合，每个键都是唯一的，使用大括号（{}）括起来，键和值之间使用冒号（:）分隔，例如：{‘name’: ‘John’, ‘age’: 25}。</li>
<li><code>NoneType</code> 类型：<code>None</code> 是一个特殊的常量，表示一个空对象或空值。它是一个内置的对象</li>
<li>复数类型（complex）</li>
</ul>
<p>这些又可以分为可变类型和不可变类型</p>
<ul>
<li>不可变类型- 整数、浮点数、布尔类型、字符串、元组</li>
</ul>
<p>不可变类型指的是一旦创建就不能被修改的数据类型，例如整数、浮点数、布尔类型、字符串、元组等。对于不可变类型的数据，如果需要修改，通常需要创建一个新的对象来代替原来的对象。</p>
<p>对于不可变类型的数据，虽然不能直接修改其内容，但是可以通过重新赋值的方式来改变其值。</p>
<ul>
<li>可变类型 - 列表、集合、字典等</li>
</ul>
<p>可变类型指的是可以被修改的数据类型，例如列表、集合、字典等。对于可变类型的数据，可以直接修改其内容，而不需要创建新的对象。</p>
<p>可以通过选择合适的数据类型、避免频繁的对象复制、使用不可变类型作为函数参数、使用生成器和迭代器等方式来提高程序的性能。</p>
<p>总结：</p>
<p>不可变类型：数字&#x2F;字符串&#x2F;元祖&#x2F;frozen set<br>可变类型：列表、集合、字典</p>
<p>有序类型：序列(字符串&#x2F;列表&#x2F;元祖<br>无序类型：集合、字典</p>
<h4 id="操作符"><a href="#操作符" class="headerlink" title="操作符"></a>操作符</h4><ul>
<li><code>+</code>：加</li>
<li><code>-</code>：减</li>
<li><code>*</code>：乘</li>
<li><code>/</code>：除，结果为浮点数，如<code>1/2=0.5</code>，又称真实除</li>
<li><code>//</code>：整除，舍去所有小数，又称地板除</li>
<li><code>%</code>：取模，如<code>3 % 2 = 1</code></li>
<li><code>**</code>：乘方，如<code>3 ** 2 = 9</code></li>
</ul>
<h4 id="类型转换"><a href="#类型转换" class="headerlink" title="类型转换"></a>类型转换</h4><p>​		!!! 字符串形式的浮点数，如’1.23’，只能使用float转为浮点数，用int转为整数则会报错。</p>
<ul>
<li>str(): 其他类型转为字符串, 如<code>str(12)</code></li>
<li>int()：字符串整数或浮点数转为整型，如<code>int(&quot;12&quot;)</code></li>
<li>float()：字符串数字或整形，转换为浮点数，如<code>float(&quot;1.23&quot;)</code></li>
</ul>
<h4 id="进制转换"><a href="#进制转换" class="headerlink" title="进制转换"></a>进制转换</h4><p>Python中的数字除了10进制数之外，还支持2进制（表示为0b开头）、8进制（表示为0o开头）、16进制数（表示为0x开头）。相互转换方法如下：</p>
<ul>
<li>bin()：转为2进制，如<code>bin(10)</code>，结果为<code>0b1010</code></li>
<li>oct()：转为8进制，如<code>oct(10)</code>，结果为<code>0o12</code></li>
<li>hex()：转为16进制，如<code>hex(10)</code>，结果为<code>0xa</code></li>
<li>int()：转为10进制，如<code>int(0b1010)</code>结果为<code>10</code></li>
</ul>
<h3 id="字符串"><a href="#字符串" class="headerlink" title="字符串"></a>字符串</h3><h4 id="系统方法"><a href="#系统方法" class="headerlink" title="系统方法"></a>系统方法</h4><table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>len()</td>
<td>计算字符串长度</td>
<td>len(“abcdefg”)，结果为7</td>
</tr>
<tr>
<td>count()</td>
<td>查询字符串中某个元素的数量</td>
<td>aabcabc”.count(“a”)，结果为3</td>
</tr>
<tr>
<td>find() &#x2F; index()</td>
<td>查找字符串中某个字符第一次出现的索引，find()找不到返回-1 , index()找不到报错</td>
<td>“abcdefg”.find(“b”)，结果为1 , ”abcdefg”.index(“b”)，结果也为1</td>
</tr>
<tr>
<td>replace()</td>
<td>替换字符串中的某部分</td>
<td>“hello,java”.replace(“java”, “python”)，结果为hello,python</td>
</tr>
<tr>
<td>split()</td>
<td>将字符串按分隔符分割成列表</td>
<td>“a,b,c,d”.split(“,”)，结果为[“a”, “b”, “c”, “d”]</td>
</tr>
<tr>
<td>join()</td>
<td>将字符串作为分隔符连接列表元素得到一个字符串</td>
<td>“-“.join([“a”, “b”, “c”, “d”])，结果为a-b-c-d</td>
</tr>
<tr>
<td>lower() &#x2F; upper()</td>
<td>将字符串转换为全小写&#x2F;大写</td>
<td>“AbcdeF”.lower()，结果为abcdef , “abcedF”.upper()，结果也为ABCDEF</td>
</tr>
<tr>
<td>isdigit() &#x2F; isalpha() &#x2F; isalnum()</td>
<td>字符串是否纯数字&#x2F;纯字母&#x2F;纯数字字母组合</td>
<td>“123”.isdigit()，结果为True</td>
</tr>
<tr>
<td>strip() &#x2F; lstrip() &#x2F; rstrip()</td>
<td>去掉字符串左右&#x2F;左边&#x2F;右边的无意字符（包括空格、换行等非显示字符)</td>
<td>“ this has blanks \n”.strip()，结果为this has balnks</td>
</tr>
</tbody></table>
<h4 id="格式化输出"><a href="#格式化输出" class="headerlink" title="格式化输出"></a>格式化输出</h4><p>字符串格式化是指，将字符串的某部分按一定格式输出，同时也可以将某些变量的实际值，插入到字符串中。</p>
<ul>
<li>%: 如<code>&quot;Name: %s, Age: %d&quot; % (&quot;Lily&quot;, 12)</code>或<code>&quot;Name: %(name)s, Age: %(age)d&quot; % &#123;&quot;name&quot;: &quot;Lily&quot;, &quot;age&quot;: 12&#125;</code></li>
<li>format: 如<code>&quot;Name: &#123;&#125;, Age: &#123;&#125;&quot;.format(&quot;Lily&quot;, 12)</code>或<code>&quot;Name: &#123;name&#125;, Age: &#123;age&#125;&quot;.format(name=&quot;Lily&quot;,age=12)</code></li>
<li>fstring：如 <code>f&#39;Name: &#123;name&#125;, Age: &#123;age&#125;&#39;</code></li>
<li>substitude(不完全替换会报错)&#x2F;safe_substitude: 如&#96;”Name: ${name}, Age: ${age}”.safe_substitude(name&#x3D;”Lily”,age&#x3D;12)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">tpl=<span class="string">&#x27;&#x27;&#x27;&lt;html&gt;</span></span><br><span class="line"><span class="string">&lt;head&gt;&lt;title&gt;&#123;title&#125;&lt;/title&gt;&lt;/head&gt;</span></span><br><span class="line"><span class="string">&lt;body&gt;</span></span><br><span class="line"><span class="string">&lt;h1&gt;&#123;title&#125;&lt;/h1&gt;</span></span><br><span class="line"><span class="string">&lt;table border=1px&gt;</span></span><br><span class="line"><span class="string">    &lt;tr&gt;</span></span><br><span class="line"><span class="string">        &lt;th&gt;序号&lt;/th&gt;</span></span><br><span class="line"><span class="string">        &lt;th&gt;用例&lt;/th&gt;</span></span><br><span class="line"><span class="string">        &lt;th&gt;结果&lt;/th&gt;</span></span><br><span class="line"><span class="string">    &lt;/tr&gt;</span></span><br><span class="line"><span class="string">    &#123;trs&#125;</span></span><br><span class="line"><span class="string">&lt;/table&gt;</span></span><br><span class="line"><span class="string">&lt;/body&gt;</span></span><br><span class="line"><span class="string">&lt;/html&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">tr=<span class="string">&#x27;&#x27;&#x27;&lt;tr&gt;&lt;td&gt;&#123;sn&#125;&lt;/td&gt;</span></span><br><span class="line"><span class="string">&lt;td&gt;&#123;case_name&#125;&lt;/td&gt;</span></span><br><span class="line"><span class="string">&lt;td&gt;&#123;result&#125;&lt;/td&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line">title=<span class="string">&quot;自动化测试报告&quot;</span></span><br><span class="line">case_results = [(<span class="string">&quot;1&quot;</span>, <span class="string">&quot;test_add_normal&quot;</span>, <span class="string">&quot;PASS&quot;</span>),(<span class="string">&quot;2&quot;</span>, <span class="string">&quot;test_add_negative&quot;</span>, <span class="string">&quot;PASS&quot;</span>), (<span class="string">&quot;3&quot;</span>, <span class="string">&quot;test_add_float&quot;</span>, <span class="string">&quot;FAIL&quot;</span>)]</span><br><span class="line"></span><br><span class="line">trs=<span class="string">&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">for</span> case_result <span class="keyword">in</span> case_results:</span><br><span class="line">    tr_format = tr.<span class="built_in">format</span>(sn=case_result[<span class="number">0</span>], case_name=case_result[<span class="number">1</span>], result=case_result[<span class="number">2</span>])</span><br><span class="line">    trs += tr_format</span><br><span class="line"></span><br><span class="line">html = tpl.<span class="built_in">format</span>(title=title, trs=trs)</span><br><span class="line"></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&quot;report.html&quot;</span>, <span class="string">&quot;w&quot;</span>)</span><br><span class="line">f.write(html)</span><br><span class="line">f.close()</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="列表list"><a href="#列表list" class="headerlink" title="列表list"></a>列表list</h3><p>​	列表元素支持各种对象的混合,支持嵌套各种对象,如<code>[&quot;a&quot;, 1, &#123;&quot;b&quot;: 3&#125;, [1,2,3]]</code></p>
<h4 id="列表操作"><a href="#列表操作" class="headerlink" title="列表操作"></a>列表操作</h4><ul>
<li>赋值: <code>l = [1, &quot;hello&quot;, (&quot;a&quot;, &quot;b&quot;)]</code></li>
<li>获取: <code>a = l[0] # 通过索引获取</code></li>
<li>增: <code>l.append(&quot;c&quot;);l.extend([&quot;d&quot;,&quot;e&quot;]);l+[&quot;f&quot;]</code></li>
<li>删: <code>l.pop() # 按索引删除,无参数默认删除最后一个;l.remove(&quot;c&quot;) # 按元素删除</code></li>
<li>改:<code>l[1]=&quot;HELLO&quot; # 通过索引修改</code></li>
<li>查: 遍历 <code>for i in l: print(i)</code></li>
</ul>
<h4 id="列表系统方法"><a href="#列表系统方法" class="headerlink" title="列表系统方法"></a>列表系统方法</h4><table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>append()&#x2F;insert()&#x2F;extend()</td>
<td>添加&#x2F;插入&#x2F;扩展(连接)</td>
<td>[1,2].append(3)</td>
</tr>
<tr>
<td>insert()</td>
<td>插入</td>
<td>[1,3].insert(1,2)</td>
</tr>
<tr>
<td>extend()</td>
<td>扩展(连接)</td>
<td>[1,2].extend([3,4])</td>
</tr>
<tr>
<td>index()</td>
<td>获取元素索引</td>
<td>[1,2].index(2)</td>
</tr>
<tr>
<td>count()</td>
<td>统计元素个数</td>
<td>[1,2,1,1].count(1)</td>
</tr>
<tr>
<td>pop()</td>
<td>按索引删除</td>
<td>[1,2].pop(0)</td>
</tr>
<tr>
<td>remove()</td>
<td>按元素删除</td>
<td>[1,2].remove(1)</td>
</tr>
<tr>
<td>sort()</td>
<td>排序</td>
<td>[1,3,2].sort()</td>
</tr>
<tr>
<td>reverse()</td>
<td>反转</td>
<td>[1,3,2].reverse()</td>
</tr>
</tbody></table>
<h3 id="元祖tuple"><a href="#元祖tuple" class="headerlink" title="元祖tuple"></a>元祖tuple</h3><ol>
<li>不可改变,常用作函数参数(安全性好)</li>
<li>同样支持混合元素以及嵌套</li>
<li>只有一个元素时,必须加”,”号,如<code>a=(&quot;hello&quot;,)</code> - 因为Python中()还有分组的含义,不加”,”会识别为字符串</li>
</ol>
<p>为什么需要元祖？有时候我们需要多个变量来表达一个确定的值，如坐标(x,y)。在哈希算法中，不可变是非常重要的，这样每次生成的哈希值才能相同。作为不可变对象，元祖可以作为字典的KEY，即<code>&#123;(1,2): 3&#125;</code>是合法的。</p>
<h4 id="元祖对象操作方法"><a href="#元祖对象操作方法" class="headerlink" title="元祖对象操作方法"></a>元祖对象操作方法</h4><p>​	由于元素是不可变对象，自带操作对象较少</p>
<table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>index()</td>
<td>获取元素索引</td>
<td>t&#x3D;(1,2,3); print(t.index(2)</td>
</tr>
<tr>
<td>count()</td>
<td>获取元素个数</td>
<td>t&#x3D;(1,2,3,2,1,2,3); print(t.index(2)</td>
</tr>
</tbody></table>
<h3 id="序列类型相关操作方法"><a href="#序列类型相关操作方法" class="headerlink" title="序列类型相关操作方法"></a>序列类型相关操作方法</h3><p>​	字符串、列表、元祖等按顺序存储的变量类型，我们统称为序列类型。</p>
<h4 id="序列类型-索引"><a href="#序列类型-索引" class="headerlink" title="序列类型 - 索引"></a>序列类型 - 索引</h4><ul>
<li>正反索引: <code>l[3];l[-1]</code></li>
<li>索引溢出(IndexError): 当索引大于序列的最大索引时会报错,如[1,2,3,4]最大索引是3,引用l[4]会报IndexError</li>
</ul>
<h4 id="序列类型-切片"><a href="#序列类型-切片" class="headerlink" title="序列类型 - 切片"></a>序列类型 - 切片</h4><ul>
<li>l[1:3] # 从列表索引1到索引3(不包含索引3)进行截取, 如 l &#x3D; [1, 2, 3, 4, 5], l[1:3]为[2, 3]</li>
<li>l[:5:2] # 第一个表示开始索引(留空0), 第二个表示结束索引(留空为最后一个,即-1), 第三个是步长, 即从开头到第5个(不包含第5个),跳一个取一个</li>
<li><em>案例</em>: 字符串反转 <code>s=&quot;abcdefg&quot;;r=s[::-1]</code></li>
</ul>
<h4 id="序列类型-遍历"><a href="#序列类型-遍历" class="headerlink" title="序列类型-遍历"></a>序列类型-遍历</h4><ul>
<li>按元素遍历: <code>for item in l: print(item)</code></li>
<li>按索引遍历: <code>for index in range(len(l)): print(l[index])</code></li>
<li>按枚举遍历: <code>for i,v in enumerate(l): print((i,v))</code></li>
</ul>
<p>当遍历序列类型（如列表、元组、字符串等）和非序列类型（如集合、字典等）时，存在一些区别和注意点。</p>
<h4 id="遍历序列类型"><a href="#遍历序列类型" class="headerlink" title="遍历序列类型"></a>遍历序列类型</h4><ol>
<li><p>使用 for 循环：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">my_list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>]</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> my_list:</span><br><span class="line">    <span class="built_in">print</span>(item)</span><br></pre></td></tr></table></figure>
</li>
<li><p>使用 while 循环和索引：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">my_tuple = (<span class="number">10</span>, <span class="number">20</span>, <span class="number">30</span>)</span><br><span class="line">index = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> index &lt; <span class="built_in">len</span>(my_tuple):</span><br><span class="line">    <span class="built_in">print</span>(my_tuple[index])</span><br><span class="line">    index += <span class="number">1</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>使用内置函数 enumerate() 获取索引和值：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">my_string = <span class="string">&quot;Hello&quot;</span></span><br><span class="line"><span class="keyword">for</span> index, value <span class="keyword">in</span> <span class="built_in">enumerate</span>(my_string):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Index: <span class="subst">&#123;index&#125;</span>, Value: <span class="subst">&#123;value&#125;</span>&quot;</span>)</span><br></pre></td></tr></table></figure>
</li>
<li><p>列表解析（List comprehension）：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">my_list = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>]</span><br><span class="line">squared_values = [x**<span class="number">2</span> <span class="keyword">for</span> x <span class="keyword">in</span> my_list]</span><br><span class="line"><span class="built_in">print</span>(squared_values) </span><br></pre></td></tr></table></figure></li>
</ol>
<ul>
<li>序列类型支持索引操作，因此可以使用循环或者内置函数来获取每个元素。</li>
<li>序列类型的元素有顺序，因此我们可以按照它们在序列中的位置来进行遍历。</li>
<li>序列类型通常具有固定长度，因此我们可以使用内置函数 <code>len()</code> 来获取其长度</li>
</ul>
<h4 id="遍历非序列类型"><a href="#遍历非序列类型" class="headerlink" title="遍历非序列类型"></a>遍历非序列类型</h4><h4 id="集合-set-示例："><a href="#集合-set-示例：" class="headerlink" title="集合 (set) 示例："></a>集合 (set) 示例：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">my_set = &#123;<span class="number">10</span>, <span class="string">&#x27;a&#x27;</span>, <span class="literal">True</span>&#125;</span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> my_set:</span><br><span class="line">    <span class="built_in">print</span>(item)</span><br></pre></td></tr></table></figure>



<h4 id="字典-dict-示例："><a href="#字典-dict-示例：" class="headerlink" title="字典 (dict) 示例："></a>字典 (dict) 示例：</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">my_dict = &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;Alice&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">25</span>&#125;</span><br><span class="line"><span class="comment"># 遍历键值对</span></span><br><span class="line"><span class="keyword">for</span> key, value <span class="keyword">in</span> my_dict.items():</span><br><span class="line">    <span class="built_in">print</span>(key, value)</span><br><span class="line"><span class="comment"># 只遍历键或值</span></span><br><span class="line"><span class="keyword">for</span> key <span class="keyword">in</span> my_dict.keys():</span><br><span class="line">     <span class="built_in">print</span>(key)</span><br><span class="line"><span class="keyword">for</span> value <span class="keyword">in</span> my_dict.values():</span><br><span class="line">     <span class="built_in">print</span>(value)</span><br></pre></td></tr></table></figure>

<p>某些非序列对象可能具有特定方法用于迭代。例如，在 pandas 的 DataFrame 中，我们可以使用 iteritems() 方法来遍历每一行数据。</p>
<h4 id="区别与注意点"><a href="#区别与注意点" class="headerlink" title="区别与注意点"></a>区别与注意点</h4><ul>
<li>对于集合（set），由于其是无需且不重复的容器，所以在遍历时不能保证元素的顺序。</li>
<li>字典（dict）是键值对形式存储数据的对象，在循环中需要考虑是否要同时处理键和值。</li>
<li>其他非序列对象可能具有特定方法用于迭代。需要查看相应文档以了解如何进行迭代操作。</li>
</ul>
<h4 id="扩展-连接-添加多个元素"><a href="#扩展-连接-添加多个元素" class="headerlink" title="扩展&#x2F;连接(添加多个元素"></a>扩展&#x2F;连接(添加多个元素</h4><p>extend()&#x2F;+ <code>&quot;abc&quot;+&quot;123&quot;;[1,2,3]+[4,5];[1,2,3].extend([4,5,6,7])</code></p>
<h4 id="类型互转-str-list-tuple"><a href="#类型互转-str-list-tuple" class="headerlink" title="类型互转: str()&#x2F;list()&#x2F;tuple()"></a>类型互转: str()&#x2F;list()&#x2F;tuple()</h4><p>list转str一般用join(), str转list一般用split()</p>
<h4 id="系统函数"><a href="#系统函数" class="headerlink" title="系统函数"></a>系统函数</h4><ul>
<li>len(): 计算长度</li>
<li>max()&#x2F;min(): 求最大&#x2F;最小元素</li>
<li>sorted()&#x2F;reversed(): 排序&#x2F;反转并生成新序列(sort()&#x2F;reverse()直接操作原序列)<code>l_new=sorted(l);l_new2=reversed(l)</code></li>
</ul>
<h3 id="集合-set"><a href="#集合-set" class="headerlink" title="集合 set"></a>集合 set</h3><p>集合是Python中一种映射类型，集合中的元素要是不可变类型（数字、字符串、元祖），元素不重复（自动去重）。</p>
<p>由于集合是基于映射类型（基于hash算法计算得到的元素地址，而不是顺序排列），相比于列表和元祖，集合的查询效率非常高，无论集合中有多少个元素，查询某个元素只需要一次操作。</p>
<p>Python中有可变结合set和不可变集合frozenset两种</p>
<h4 id="创建集合"><a href="#创建集合" class="headerlink" title="创建集合"></a>创建集合</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = &#123;<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>&#125;</span><br><span class="line">s = <span class="built_in">set</span>()  <span class="comment"># 创建空集合</span></span><br><span class="line">s = <span class="built_in">set</span>([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>])  <span class="comment"># 将列表转为集合</span></span><br></pre></td></tr></table></figure>

<h4 id="集合操作"><a href="#集合操作" class="headerlink" title="集合操作"></a>集合操作</h4><p>同数学概念中的集合，Python中的集合也支持交集、并集、差集等操作，集合于集合常见操作符如下：</p>
<ul>
<li>联合(并集): 例如：<code>&#123;&#39;a&#39;, &#39;b&#39; &#125; | &#123;&#39;b&#39;, &#39;c&#39;&#125;</code>，结果为<code>&#123;&#39;a&#39;, &#39;b&#39;, &#39;c&#39;&#125;</code></li>
<li>交集: <code>&amp;</code>: 例如：<code>&#123;&#39;a&#39;, &#39;b&#39; &#125; | &#123;&#39;b&#39;, &#39;c&#39;&#125;</code> ，结果为<code>&#123;&#39;b&#39;&#125;</code></li>
<li>差集: 例如：<code>&#123;&#39;a&#39;, &#39;b&#39; &#125; - &#123;&#39;b&#39;, &#39;c&#39;&#125;</code>，结果为 <code>&#123;&#39;a&#39;&#125;</code>，相反<code>&#123;&#39;b&#39;, &#39;c&#39; &#125; - &#123;&#39;a&#39;, &#39;b&#39;&#125;</code>，结果为<code>&#123;&#39;c&#39;&#125;</code></li>
<li>对称差分(去除相同的项做并集): 例如<code>&#123;&#39;a&#39;, &#39;b&#39; &#125; ^ &#123;&#39;b&#39;, &#39;c&#39;&#125;</code>结果为<code>&#123;&#39;a&#39;, &#39;c&#39;&#125;</code></li>
</ul>
<h4 id="通过集合操作快速对比出一些数据的不同"><a href="#通过集合操作快速对比出一些数据的不同" class="headerlink" title="通过集合操作快速对比出一些数据的不同"></a>通过集合操作快速对比出一些数据的不同</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line">data1 = [&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;王六&#x27;</span>, <span class="string">&#x27;score&#x27;</span>: <span class="number">75</span>&#125;,</span><br><span class="line">         &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;score&#x27;</span>: <span class="number">98</span>&#125;,</span><br><span class="line">         &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;赵六&#x27;</span>, <span class="string">&#x27;score&#x27;</span>: <span class="number">89</span>&#125;,</span><br><span class="line">         &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;score&#x27;</span>: <span class="number">87</span>&#125;,</span><br><span class="line">         &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;李五&#x27;</span>, <span class="string">&#x27;score&#x27;</span>: <span class="number">87</span>&#125;]</span><br><span class="line">data2 = [&#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;赵六&#x27;</span>, <span class="string">&#x27;score&#x27;</span>: <span class="number">89</span>&#125;,</span><br><span class="line">         &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;score&#x27;</span>: <span class="number">98</span>&#125;,</span><br><span class="line">         &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;score&#x27;</span>: <span class="number">98</span>&#125;,</span><br><span class="line">         &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;王五&#x27;</span>, <span class="string">&#x27;score&#x27;</span>: <span class="number">75</span>&#125;,</span><br><span class="line">         &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;王六&#x27;</span>, <span class="string">&#x27;score&#x27;</span>: <span class="number">85</span>&#125;]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将列表中的每一项转为value值组成的不可变元祖, 然后将列表转为集合</span></span><br><span class="line">set1 = <span class="built_in">set</span>([<span class="built_in">tuple</span>(i.values()) <span class="keyword">for</span> i <span class="keyword">in</span> data1])  </span><br><span class="line">set2 = <span class="built_in">set</span>([<span class="built_in">tuple</span>(i.values()) <span class="keyword">for</span> i <span class="keyword">in</span> data2])</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;data2中于data1中不同的有&#x27;</span>, set1-set2)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;data1中于data2中不同的有&#x27;</span>, set2-set1)</span><br></pre></td></tr></table></figure>

<h4 id="集合对象自带方法"><a href="#集合对象自带方法" class="headerlink" title="集合对象自带方法"></a>集合对象自带方法</h4><table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>add()</td>
<td>添加元素</td>
<td>s &#x3D; set(); s.add(‘a’)</td>
</tr>
<tr>
<td>update()</td>
<td>更新集合(批量添加多个)</td>
<td>s &#x3D; {‘a’, ‘b’}; s1&#x3D;set([‘b’, ‘c’]); s.update(s1)</td>
</tr>
<tr>
<td>remove(element)</td>
<td>移除指定元素(如果元素不存在报错)</td>
<td>s &#x3D; {‘a’, ‘b’, ‘c’}; s.remove(‘a’) ;print(s)</td>
</tr>
<tr>
<td>discard(element)</td>
<td>丢弃指定元素(如果元素不存在不报错）</td>
<td>s &#x3D; {‘a’, ‘b’, ‘c’}; s.discard(‘d’) ;print(s)</td>
</tr>
<tr>
<td>pop()</td>
<td>随机移除一个元素</td>
<td>s&#x3D;{‘a’, ‘b’, ‘c’}; s.pop(); print(s)</td>
</tr>
<tr>
<td>copy()</td>
<td>复制集合</td>
<td>s &#x3D; {‘a’, ‘b’, ‘c’}; s1 &#x3D; s.copy(); print(s1)</td>
</tr>
<tr>
<td>clear()</td>
<td>清空集合</td>
<td>s &#x3D; {‘a’, ‘b’, ‘c’}; s.clear() ; print(s)</td>
</tr>
<tr>
<td>difference(s1)</td>
<td>与另一个集合的差别（相当于差集）</td>
<td>s &#x3D; {‘a’, ‘b’};s1 &#x3D; {‘b’, ‘c’};print(s.difference(s1))</td>
</tr>
<tr>
<td>issubset(s1)</td>
<td>是否子集</td>
<td>s &#x3D; {‘a’, ‘b’}; s1 &#x3D; {‘a’, ‘b’, ‘c’}; print(s.issubset(s1))</td>
</tr>
<tr>
<td>issuperset(s)</td>
<td>是否父集</td>
<td>s &#x3D; {‘a’, ‘b’};s1 &#x3D; {‘a’, ‘b’, ‘c’}; print(s1.issuperset(s))</td>
</tr>
<tr>
<td>isdisjoint(s)</td>
<td>是否互斥(彼此都不包含对方元素)</td>
<td>s &#x3D; {‘a’, ‘b’};s1 &#x3D; {‘c’, ‘d’}; print(s1.isdisjoint(s))</td>
</tr>
</tbody></table>
<h4 id="案例1-列表去重"><a href="#案例1-列表去重" class="headerlink" title="案例1: 列表去重"></a><em>案例1</em>: 列表去重</h4><p><code>l=[1,2,3,1,4,3,2,5,6,2];l=list(set(l))</code> (由于集合无序,无法保持原有顺序)</p>
<h4 id="案例2-100w条数据-用列表和集合哪个性能更好"><a href="#案例2-100w条数据-用列表和集合哪个性能更好" class="headerlink" title="案例2: 100w条数据,用列表和集合哪个性能更好?"></a><em>案例2</em>: 100w条数据,用列表和集合哪个性能更好?</h4><p>集合性能要远远优于列表, 集合是基于哈希的, 无论有多少元素,查找元素永远只需要一步操作, 而列表长度多次就可能需要操作多少次(比如元素在列表最后一个位置)</p>
<h3 id="字典-dict"><a href="#字典-dict" class="headerlink" title="字典 dict"></a>字典 dict</h3><p>​		字典是由若干key-value对组成, Python3.6后字典是有序的, 字典的key不能重复,而且必须是可哈希的,通常是字符串</p>
<h4 id="创建字典"><a href="#创建字典" class="headerlink" title="创建字典"></a>创建字典</h4><ul>
<li><p>dict(key1&#x3D;value1, key2&#x3D;value2, …): 创建字典</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d = <span class="built_in">dict</span>(a=<span class="number">1</span>, b=<span class="number">2</span>, c=<span class="number">3</span>)</span><br><span class="line">d = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">3</span>&#125;</span><br></pre></td></tr></table></figure>
</li>
<li><p>dict.fromkeys(key1, key2, key3, … , default): 以默认值创建包含多个键的字典</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">d = <span class="built_in">dict</span>.fromkeys([<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>], <span class="number">1</span>)</span><br><span class="line">d=&#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">1</span>&#125;</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="字典操作"><a href="#字典操作" class="headerlink" title="字典操作"></a>字典操作</h4><ul>
<li>赋值: <code>d = &#123;&quot;a&quot;:1, &quot;b&quot;:2&#125;</code></li>
<li>获取: <code>a = d[&#39;a&#39;]</code>或<code>a = d.get(&quot;a&quot;) # d中不存在&quot;a&quot;元素时不会报错</code></li>
<li>增: <code>d[&quot;c&quot;] = 3; d.update(&#123;&quot;d&quot;:5, &quot;e&quot;: 6&#125;</code></li>
<li>删: <code>d.pop(&quot;d&quot;); d.clear() # 清空</code></li>
<li>查: <code>d.get(&quot;c&quot;)</code></li>
<li>遍历:<ul>
<li>遍历key: <code>for key in d:</code>或<code>for key in d.keys():</code></li>
<li>遍历value: <code>for value in d.values():</code></li>
<li>遍历key-value对: <code>for item in d.items():</code></li>
</ul>
</li>
</ul>
<h4 id="字典常用方法"><a href="#字典常用方法" class="headerlink" title="字典常用方法"></a>字典常用方法</h4><table>
<thead>
<tr>
<th>方法</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>get(key, default&#x3D;None)</td>
<td>获取指定键的值，如果不存在该键，则返回default默认值，</td>
<td>d &#x3D; {‘a’: 1, ‘b’: 2, ‘c’: 3}; print(d.get(e, 5))</td>
</tr>
<tr>
<td>setdefault(key, default)</td>
<td>设置没有字典中该项时的默认值</td>
<td>d &#x3D; {‘a’: 1, ‘b’: 2, ‘c’: 3}; d.set_default(‘e’, 5); print(d[‘e’])</td>
</tr>
<tr>
<td>keys()</td>
<td>所有键的集合(类似列表)</td>
<td>d &#x3D; {‘a’: 1, ‘b’: 2, ‘c’: 3}; print(d.keys())</td>
</tr>
<tr>
<td>values()</td>
<td>所有值的集合(类似列表)</td>
<td>d &#x3D; {‘a’: 1, ‘b’: 2, ‘c’: 3}; print(d.values())</td>
</tr>
<tr>
<td>items()</td>
<td>所有key, value对的集合(类似列表)</td>
<td>d &#x3D; {‘a’: 1, ‘b’: 2, ‘c’: 3}; print(d.items())</td>
</tr>
<tr>
<td>copy()</td>
<td>复制字典(浅拷贝)</td>
<td>d &#x3D; {‘a’: 1, ‘b’: 2, ‘c’: 3}; d2 &#x3D; d.copy(); print(d2)</td>
</tr>
<tr>
<td>update(…)</td>
<td>更新字典</td>
<td>d &#x3D; {‘a’: 1, ‘b’: 2, ‘c’: 3}; d.update({‘c’: 4, ‘d’: 5}; print(d)</td>
</tr>
<tr>
<td>clear()</td>
<td>清空字典</td>
<td>d &#x3D; {‘a’: 1, ‘b’: 2, ‘c’: 3}; d.clear(); print(d)</td>
</tr>
<tr>
<td>pop(key)</td>
<td>取出(移除)指定key并获取对应的值</td>
<td>d &#x3D; {‘a’: 1, ‘b’: 2, ‘c’: 3}; b_value &#x3D; d.pop(‘b’); print(d)</td>
</tr>
<tr>
<td>popitem()</td>
<td>取出(移除)末尾的key-value对</td>
<td>d &#x3D; {‘a’: 1, ‘b’: 2, ‘c’: 3}; print(d.popitem())</td>
</tr>
</tbody></table>
<h4 id="更新字典数据"><a href="#更新字典数据" class="headerlink" title="更新字典数据"></a>更新字典数据</h4><ul>
<li><p>通过key值修改</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">api = &#123;<span class="string">&quot;url&quot;</span>: <span class="string">&quot;/api/user/login&quot;</span>: data: &#123;<span class="string">&quot;username&quot;</span>: <span class="string">&quot;张三&quot;</span>, <span class="string">&quot;password&quot;</span>: <span class="string">&quot;123456&quot;</span>&#125;&#125;</span><br><span class="line">api[<span class="string">&#x27;data&#x27;</span>][<span class="string">&#x27;username&#x27;</span>] = <span class="string">&quot;李四&quot;</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>通过update() 方法修改</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">api = &#123;<span class="string">&quot;url&quot;</span>: <span class="string">&quot;/api/user/login&quot;</span>: data: &#123;<span class="string">&quot;username&quot;</span>: <span class="string">&quot;张三&quot;</span>, <span class="string">&quot;password&quot;</span>: <span class="string">&quot;123456&quot;</span>&#125;&#125;</span><br><span class="line">api[<span class="string">&#x27;data&#x27;</span>].update(&#123;<span class="string">&quot;username&quot;</span>: <span class="string">&quot;李四&quot;</span>&#125;)</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="哈希与可哈希元素"><a href="#哈希与可哈希元素" class="headerlink" title="哈希与可哈希元素"></a>哈希与可哈希元素</h4><ol>
<li>哈希是通过计算得到元素的存储地址(映射), 这就要求不同长度的元素都能计算出地址,相同元素每次计算出的地址都一样, 不同元素计算的地址必须唯一, 基于哈希的查找永远只需要一步操作, 计算一下得到元素相应的地址, 不需要向序列那样遍历, 所以性能较好</li>
<li>可哈希元素: 为了保证每次计算出的地址相同, 要求元素长度是固定的, 如数字&#x2F;字符串&#x2F;只包含数字,字符串的元组, 这些都是可哈希元素</li>
</ol>
<h2 id="分支及循环"><a href="#分支及循环" class="headerlink" title="分支及循环"></a>分支及循环</h2><h3 id="分支"><a href="#分支" class="headerlink" title="分支"></a>分支</h3><h4 id="if条件判断"><a href="#if条件判断" class="headerlink" title="if条件判断"></a>if条件判断</h4><h5 id="if-…"><a href="#if-…" class="headerlink" title="if …"></a>if …</h5><p>如果条件满足，才执行其中语句，例如</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> x&gt;<span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正数&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;结束&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="if-…-else-…"><a href="#if-…-else-…" class="headerlink" title="if … else …"></a>if … else …</h5><p>即，如果条件满足，执行某些语句，否则执行另一些语句，例如</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> x&gt;<span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正数&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;不是正数&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;结束&#x27;</span>)</span><br></pre></td></tr></table></figure>

<h5 id="f…-elif-…-else-…"><a href="#f…-elif-…-else-…" class="headerlink" title="f… elif … else …"></a>f… elif … else …</h5><p>即，如果满足某条件，执行某些语句，否则如果满足另一条件，执行该条件语句，如果都不满足所列条件则执行其他语句。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">x = <span class="number">1</span></span><br><span class="line"><span class="keyword">if</span> x&gt;<span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;正数&quot;</span>)</span><br><span class="line"><span class="keyword">elif</span> x=<span class="number">0</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;0&quot;</span>)</span><br><span class="line"><span class="keyword">else</span>: </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;负数&quot;</span>)</span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;结束&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h4 id="真假值"><a href="#真假值" class="headerlink" title="真假值"></a>真假值</h4><p>​		在Python中False、None，数字0，字符串’0’，以及空字符串’’，空列表[]、空字典{}，空元祖(,)，空集合set()，都被失望假值；否则被视为真。比如可以直接使用if list判断列表为空：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">list</span> = []</span><br><span class="line"><span class="keyword">if</span> <span class="built_in">list</span>:   <span class="comment"># 也可以使用if len(list)&gt;0:</span></span><br><span class="line">   <span class="built_in">print</span>(<span class="string">&#x27;列表不为空&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h4 id="三元表达式"><a href="#三元表达式" class="headerlink" title="三元表达式"></a>三元表达式</h4><p>​	三元表达式即 当条件满足时 变量 为一个值，条件不满足时，变量为另一个值，例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">max</span> = a <span class="keyword">if</span> a &gt; b <span class="keyword">else</span> b</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">当 a&gt;b 为true时</span></span><br><span class="line"><span class="string">max = a</span></span><br><span class="line"><span class="string">若 a&gt;b 为false</span></span><br><span class="line"><span class="string">max = b</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>



<h4 id="逻辑符代替if判断"><a href="#逻辑符代替if判断" class="headerlink" title="逻辑符代替if判断"></a>逻辑符代替if判断</h4><p>在Python语句中and和or也可以用于逻辑判断。</p>
<ul>
<li><code>c = a and b</code>：如果a为假，则c的值为a，否则c的值为b</li>
<li><code>c = a or b</code>：想反，如果a为假，c的值为b，否则c的值为a</li>
</ul>
<p>特别是or语句，常用来确保变量的值非空并赋于默认值，例如：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">d = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>&#125;</span><br><span class="line">c = d.get(<span class="string">&#x27;c&#x27;</span>) <span class="keyword">or</span> <span class="string">&#x27;默认值&#x27;</span>  </span><br><span class="line"><span class="comment"># 如果d.get(&#x27;c&#x27;)的结果为None,0,空字符串等假值，c被赋予默认值</span></span><br></pre></td></tr></table></figure>



<h3 id="循环"><a href="#循环" class="headerlink" title="循环"></a>循环</h3><p>Python中的循环有for循环和while循环两种</p>
<h4 id="for循环"><a href="#for循环" class="headerlink" title="for循环"></a>for循环</h4><p>for循环（也称遍历），是从一个含有多个变量的数据集合中，依次取出每一项，进行操作。</p>
<p>for循环可以对字符串、列表、元祖、集合、字典及生成器、迭代器、文件指针等可以迭代的对象进行遍历输出。</p>
<ul>
<li><p>遍历获取一组顺序的数字</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):  <span class="comment"># range(10)即生成0-9的10个数字，不包括10</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure>
</li>
<li><p>遍历字符串</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">str_var = <span class="string">&#x27;hello,world&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> str_var:  <span class="comment"># i是代表所遍历对象的每一项的一个变量，可以是任意变量名</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure>
</li>
<li><p>遍历列表</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">list_var = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> i <span class="keyword">in</span> list_var:  <span class="comment"># i是代表所遍历对象的每一项的一个变量，可以是任意变量名</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure>

<p>在遍历时如果想连同该项的索引一起输出，可以使用enumerate实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">list_var = [<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="keyword">for</span> index, item <span class="keyword">in</span> <span class="built_in">enumerate</span>(list_var):  <span class="comment"># index代表索引，item代表每一项的值</span></span><br><span class="line">    <span class="built_in">print</span>(index, item)</span><br></pre></td></tr></table></figure>
</li>
<li><p>遍历字典</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">dict_var =&#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>, <span class="string">&#x27;c&#x27;</span>: <span class="number">3</span>&#125;</span><br><span class="line"><span class="comment"># 遍历字典时，需要使用字典的items()方法，得到每一项key,value的组合</span></span><br><span class="line"><span class="keyword">for</span> key, value <span class="keyword">in</span> dict_var.items():  <span class="comment"># i是代表所遍历对象的每一项的一个变量，可以是任意变量名</span></span><br><span class="line">    <span class="built_in">print</span>(key, value)</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="while-循环"><a href="#while-循环" class="headerlink" title="while 循环"></a>while 循环</h4><p>​		while循环用于当指定条件满足时，循环执行某些语句，直到条件不满足。while循环中为了避免死循环，一般循环中要有使循环趋于结束的语句，</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">i = <span class="number">0</span></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">10</span>:  <span class="comment"># 当i&lt;10时，循环执行下面语句</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    i += <span class="number">1</span>  <span class="comment"># i每次自己增加1，等i&gt;=10时，循环自动结束</span></span><br></pre></td></tr></table></figure>



<h4 id="break和continue"><a href="#break和continue" class="headerlink" title="break和continue"></a>break和continue</h4><p>break用于结束当前循环，continue用于结束本次循环，直接开始下次循环</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># break    当有多层循环嵌套时，break每次只能跳出一层循环</span></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span> i &gt; <span class="number">5</span>:  <span class="comment"># 如果大于5，结束循环</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># continue</span></span><br><span class="line"><span class="keyword">for</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span> i % <span class="number">2</span> == <span class="number">0</span>:  <span class="comment"># 如果是偶数，跳过本次循环</span></span><br><span class="line">        <span class="keyword">continue</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br></pre></td></tr></table></figure>



<h4 id="循环中的else"><a href="#循环中的else" class="headerlink" title="循环中的else"></a>循环中的else</h4><p>​		循环结束有break结束和全部循环完结束两种，为了判断是哪种结束方式，可以使用else。当非break结束时执行else。</p>
<p>由于实际不会break，因此运行结果会打印’循环完毕’，while…else的使用和for…else类似：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):</span><br><span class="line">    <span class="keyword">if</span> i &gt; <span class="number">5</span>:  <span class="comment"># 如果大于5，结束循环</span></span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line"><span class="keyword">else</span>:  <span class="comment"># 非break结束时执行</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;非break跳出，循环全部执行完毕&#x27;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">while</span> i &lt; <span class="number">10</span>:</span><br><span class="line">    <span class="keyword">if</span> i &gt; <span class="number">5</span>:</span><br><span class="line">        <span class="keyword">break</span></span><br><span class="line">    <span class="built_in">print</span>(i)</span><br><span class="line">    i += <span class="number">1</span></span><br><span class="line"><span class="keyword">else</span>:  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;非break跳出，循环全部执行完毕&#x27;</span>)</span><br></pre></td></tr></table></figure>





<h2 id="函数"><a href="#函数" class="headerlink" title="函数"></a>函数</h2><p>Python中的函数可以理解为一种<em>预先设定</em>的处理过程。一般过程都会包含输入、处理、和输出三个部分。</p>
<ul>
<li>输入，即函数参数，可以有多个参数；</li>
<li>处理：函数内部的处理过程，可以调用其他函数及模块；</li>
<li>输出：即返回值，也有可以返回多个。</li>
</ul>
<p>数学中的函数指一种映射的变换关系，如<code>f(x)=2x+1</code>，转换为Python函数为：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">f</span>(<span class="params">x</span>):</span><br><span class="line">    <span class="keyword">return</span> x*<span class="number">2</span> + <span class="number">1</span></span><br></pre></td></tr></table></figure>



<h3 id="函数定义和调用"><a href="#函数定义和调用" class="headerlink" title="函数定义和调用"></a>函数定义和调用</h3><p>函数分为函数定义和函数调用两部分。</p>
<ul>
<li>函数定义即设计函数，是对参数、处理过程和返回值的描述。</li>
<li>函数调用及使用函数，是使用实际的数据，运行函数并得到实际的返回值。</li>
</ul>
<h4 id="定义函数"><a href="#定义函数" class="headerlink" title="定义函数"></a>定义函数</h4><p>定义一个函数使用<code>def</code>关键字，格式如下。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">函数名</span>(<span class="params">参数<span class="number">1</span>,参数<span class="number">2</span>, ...</span>):</span><br><span class="line">    处理过程</span><br></pre></td></tr></table></figure>

<h4 id="调用函数"><a href="#调用函数" class="headerlink" title="调用函数"></a>调用函数</h4><p>定义的函数需要调用才能执行，调用是按定义的格式传入和参数对应的实际数据，调用方式如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">函数名(数据<span class="number">1</span>,数据<span class="number">2</span>,...)</span><br></pre></td></tr></table></figure>

<p>如果需要获取函数的返回结果，可以使用将函数调用复制给变量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">变量 = 函数名(数据<span class="number">1</span>,数据<span class="number">2</span>,...) </span><br></pre></td></tr></table></figure>



<h4 id="函数参数"><a href="#函数参数" class="headerlink" title="函数参数"></a>函数参数</h4><p>参数是指使用函数时需要提供的信息，如一个登录函数<code>add(a, b)</code>，需要提供加数和被加数，才能进行运算。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x, y</span>): <span class="comment"># 定义函数</span></span><br><span class="line">    s = x+y     <span class="comment"># 处理过程</span></span><br><span class="line">    <span class="keyword">return</span> s   <span class="comment"># 返回结果</span></span><br></pre></td></tr></table></figure>



<h4 id="形参和实参"><a href="#形参和实参" class="headerlink" title="形参和实参"></a>形参和实参</h4><p>函数分为定义和调用，在定义函数时的参数称为形式参数，如<code>def add(x, y): ...</code>，这里的<code>x</code>和<code>y</code>便是形式参数，形式参数是函数内部使用的。<br>在调用函数时需要传入实际的数据，如<code>add(3,5)</code>，这里的<code>3</code>和<code>5</code>便是实际参数。实际参数也可以是预先定义好的变量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x, y</span>): </span><br><span class="line">    <span class="comment"># 这里的 x,y 便是形参，函数外部不能调用</span></span><br><span class="line">    s = x+y     </span><br><span class="line">    <span class="keyword">return</span> s </span><br><span class="line"></span><br><span class="line">a, b = <span class="number">3</span>, <span class="number">5</span> <span class="comment"># 实参</span></span><br><span class="line">add(a, b)</span><br></pre></td></tr></table></figure>



<h4 id="参数类型注解"><a href="#参数类型注解" class="headerlink" title="参数类型注解"></a>参数类型注解</h4><p>Python3.5版本以后提供了类型注解</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x: <span class="built_in">int</span>, y: <span class="built_in">int</span></span>) -&gt; <span class="built_in">int</span>:   <span class="comment"># 说明x,y应为整型 -&gt; 返回值也会整数</span></span><br><span class="line">    s = x+y </span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"><span class="comment"># 类型注释也可以指定多种类型，同时也可以注释函数返回值类型。</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x: (<span class="params"><span class="built_in">int</span>, <span class="built_in">float</span></span>), y: (<span class="params"><span class="built_in">int</span>, <span class="built_in">float</span></span>)</span>) -&gt; (<span class="built_in">int</span>, <span class="built_in">float</span>):  <span class="comment"># -&gt;指返回值类型</span></span><br><span class="line">    s = x+y</span><br><span class="line">    <span class="keyword">return</span> s</span><br></pre></td></tr></table></figure>





<h4 id="参数默认值-必选和可选参数"><a href="#参数默认值-必选和可选参数" class="headerlink" title="参数默认值-必选和可选参数"></a>参数默认值-必选和可选参数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x, y=<span class="number">1</span></span>): <span class="comment"># x 为必传参数， y 为可选传参数，不传默认值为1； 提供默认值的参数必须写到后面</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 如果加上类型注解，写法为</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x: (<span class="params"><span class="built_in">int</span>,<span class="built_in">float</span></span>), y: (<span class="params"><span class="built_in">int</span>, <span class="built_in">float</span></span>) = <span class="number">1</span></span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>



<h4 id="位置参数和关键字参数"><a href="#位置参数和关键字参数" class="headerlink" title="位置参数和关键字参数"></a>位置参数和关键字参数</h4><p>参数在定义时只有必选和可选之分，可选的参数需要写到后面。<br>但是在函数调用时就有如下两种传参方式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">add(<span class="number">3</span>,<span class="number">5</span>)</span><br><span class="line">add(y=<span class="number">3</span>,x=<span class="number">5</span>) <span class="comment"># 加了y= 就会将3传值给y形数</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x, y</span>): </span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>



<h4 id="不定参数"><a href="#不定参数" class="headerlink" title="不定参数"></a>不定参数</h4><p>​		当一个函数使用方式不确定，需要设计其支持任意多个、任意方式（位置&#x2F;关键字形式）传入时。可以使用<code>*args</code>和<code>**kwargs</code><br>args即参数(复数)：arguments的缩写，kwargs即关键词参数(复数)：keyword arguments的缩写</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">*args, **kwargs</span>):</span><br><span class="line">    s = <span class="number">0</span></span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> args:   <span class="comment"># args得到一个元祖类型，没有位置参数时为空元祖</span></span><br><span class="line">        s += num</span><br><span class="line">    <span class="keyword">for</span> num <span class="keyword">in</span> kwargs.values():  <span class="comment"># kwargs得到一个字典类型，无关键词参数时为空字典</span></span><br><span class="line">        s += num</span><br><span class="line">    <span class="keyword">return</span> s</span><br><span class="line"></span><br><span class="line">add()   <span class="comment"># args 为 空元祖 ()  kwargs 为空字典 &#123;&#125;  结果为 0</span></span><br><span class="line">add(<span class="number">3</span>, <span class="number">5</span>) <span class="comment"># args 为 元祖 (3,5)  kwargs 为空字典 &#123;&#125;  结果为 8</span></span><br><span class="line">add(x=<span class="number">3</span>, y=<span class="number">5</span>)  <span class="comment"># args 为 空元祖 ()  kwargs 为空字典 &#123;&#x27;x&#x27;: 3, &#x27;y&#x27;: 5&#125;  结果为 8</span></span><br><span class="line">add(<span class="number">3</span>, <span class="number">5</span>, z=<span class="number">6</span>)   <span class="comment"># 此时 args为(3,5)  kwargs为 &#123;&#x27;z&#x27;: 6&#125;, 得到 14</span></span><br></pre></td></tr></table></figure>



<h4 id="限定关键字参数"><a href="#限定关键字参数" class="headerlink" title="限定关键字参数"></a>限定关键字参数</h4><p>函数中可以使用<code>*</code>参数，其后的参数在使用时只能按<code>key=value</code>形式使用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">*, a, b</span>):</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(add(<span class="number">1</span>, <span class="number">2</span>)) <span class="comment"># 报错</span></span><br><span class="line"><span class="built_in">print</span>(add(a=<span class="number">1</span>,b=<span class="number">2</span>))</span><br></pre></td></tr></table></figure>



<h4 id="限定位置参数"><a href="#限定位置参数" class="headerlink" title="限定位置参数"></a>限定位置参数</h4><p>函数中可以使用<code>/</code>参数，其前的参数在使用时只能按位置参数形式使用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">a, b, /</span>):</span><br><span class="line">    <span class="keyword">return</span> a + b</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(add(a=<span class="number">1</span>,b=<span class="number">2</span>)) <span class="comment"># 报错</span></span><br><span class="line"><span class="built_in">print</span>(add(<span class="number">1</span>, <span class="number">2</span>))</span><br></pre></td></tr></table></figure>

<p>函数中也可以使用不定参 <code>def add(*args): ...</code> 来仅允许使用位置参数，使用起来不如上述形式方便，例如</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">*args</span>):</span><br><span class="line">    a, b = args</span><br><span class="line">    <span class="built_in">print</span>(a + b)</span><br><span class="line"></span><br><span class="line">add(a=<span class="number">1</span>, b=<span class="number">2</span>)  <span class="comment"># 报错</span></span><br><span class="line">add(<span class="number">1</span>,<span class="number">2</span>)</span><br></pre></td></tr></table></figure>



<h4 id="函数返回值"><a href="#函数返回值" class="headerlink" title="函数返回值"></a>函数返回值</h4><p>函数中使用关键<code>return</code>返回结果，return操作后，函数结束（后面的语句不会再执行)</p>
<p>如果想函数每次调用都返回一个值后并不终止，而是暂停等待下次调用，可以使用<code>yield</code>代替<code>return</code>，这样便得到一个生成器函数。</p>
<h4 id="变量的作用域"><a href="#变量的作用域" class="headerlink" title="变量的作用域"></a>变量的作用域</h4><p>函数内部的变量被称为<em>局部变量</em>，局部变量是私有变量，一般情况下，一个函数无法访问其他函数的局部变量。</p>
<p>如果需要在一个函数中声明一个变量，让所有函数都可以使用，可以使用global关键字声明其为全局变量。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">global</span> z</span><br><span class="line">    z = <span class="number">3</span></span><br><span class="line">    <span class="keyword">return</span> x + y + z</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sub</span>(<span class="params">x, y</span>):</span><br><span class="line">    <span class="keyword">return</span> x - y -z  <span class="comment"># 可以使用全局变量z</span></span><br><span class="line"><span class="comment"># 由于函数都可以访问和改变全局变量，这会导致全局变量的值不可预测，因此需要谨慎使用全局变量。</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">a = <span class="number">3</span>   <span class="comment"># 模块中的全局变量</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>():</span><br><span class="line">    a = a + <span class="number">3</span> <span class="comment"># 将全局变量 进行加3 赋值给局部变量</span></span><br><span class="line">    <span class="built_in">print</span>(a)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">addGlobal</span>():</span><br><span class="line">    <span class="keyword">global</span> a</span><br><span class="line">    a = a + <span class="number">3</span></span><br><span class="line">    <span class="built_in">print</span>(a)</span><br></pre></td></tr></table></figure>



<h4 id="匿名函数"><a href="#匿名函数" class="headerlink" title="匿名函数"></a>匿名函数</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">lambda</span> 参数: 返回值</span><br><span class="line">add = lamda x,y: x+y</span><br></pre></td></tr></table></figure>



<h4 id="高阶函数"><a href="#高阶函数" class="headerlink" title="高阶函数"></a>高阶函数</h4><p>函数用于显示一个函数的信息。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;加法函数&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> x + y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个函数描述的方法</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">info</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="comment"># 使用魔术方法获取func方法的信息并打印</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;函数名称:&#x27;</span>, func.__name__) <span class="comment"># __name__: 可以获取函数的方法名</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;函数描述:&#x27;</span>, func.__doc__)<span class="comment"># __doc__: 可以获取到函数的解析注释</span></span><br><span class="line">    <span class="comment"># 通常情况下，我们不会直接使用 func.__name__ 来获取函数或者方法的名称，通常会使用内置函数 getattr() 来动态地获取对象属性。</span></span><br><span class="line">    function_name = <span class="built_in">getattr</span>(my_function, <span class="string">&#x27;__name__&#x27;</span>)</span><br><span class="line">    method_name = <span class="built_in">getattr</span>(obj.my_method, <span class="string">&#x27;__doc__&#x27;</span>)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;函数名称:&#x27;</span>, function_name)</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;函数描述:&#x27;</span>, method_name) </span><br><span class="line">    </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">info(add) </span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">函数名称: add</span></span><br><span class="line"><span class="string">函数描述: 加法函数</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>



<h4 id="装饰器"><a href="#装饰器" class="headerlink" title="装饰器"></a>装饰器</h4><p>装饰器也是一种典型的以函数为参数的函数，装饰器旨在通过包装，在不改变原函数的情况下，为函数来增加功能。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 直接使用@info为add函数加上装饰器</span></span><br><span class="line"><span class="meta">@info   </span><span class="comment"># @info 装饰器 - 在调用函数add时会自动打印相应的函数信息。</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x,y</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;加法函数&quot;&quot;&quot;</span></span><br><span class="line">    <span class="keyword">return</span> x + y</span><br></pre></td></tr></table></figure>

<h5 id="装饰器的执行流程"><a href="#装饰器的执行流程" class="headerlink" title="装饰器的执行流程"></a>装饰器的执行流程</h5><ol>
<li>定义装饰器函数：首先需要定义一个装饰器函数。这个函数将接收一个被装饰的目标函数作为参数，并返回一个新的内嵌（包裹）了目标函数功能的封闭（wrapper）函数。</li>
<li>应用装饰器：使用 <code>@</code> 符号将定义好的装饰器应用到目标函数上。这相当于将目标函数作为参数传递给了装饰器，并重新赋值给了原来的名称。</li>
<li>装饰过程：当调用被修饰后的原始目标函时数时，实际上调用并执行了封闭（wrapper） 函数。这个封闭函（wrapper）数接收到相同参数并执行了额外操作或者修改后再调用内部保存着目标函数引用 的实际逻辑代码。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">uppercase_decorator</span>(<span class="params">func</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">wrapper</span>():</span><br><span class="line">        result = func() <span class="comment"># 获取原函数的返回值</span></span><br><span class="line">        <span class="keyword">return</span> result.upper() <span class="comment"># 将原函数的返回值进行大写</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> wrapper  </span><br><span class="line"></span><br><span class="line"><span class="meta">@uppercase_decorator</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">greet</span>():</span><br><span class="line">    <span class="keyword">return</span> <span class="string">&quot;hello world&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(greet())  <span class="comment"># 输出: HELLO WORLD</span></span><br></pre></td></tr></table></figure>





<h4 id="常用高阶函数"><a href="#常用高阶函数" class="headerlink" title="常用高阶函数"></a>常用高阶函数</h4><p>map, filter和reduce是Python中常用的3个高阶函数</p>
<ul>
<li><p>map()<br>map用于使用一个函数，对一个序列进行批量操作，示例如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">add1 = <span class="keyword">lambda</span> x: x + <span class="number">1</span>   <span class="comment"># 处理函数，由于一次处理一个，所有只能有一个参数</span></span><br><span class="line">data = [<span class="number">1</span>, <span class="number">3</span>, <span class="number">5</span>, <span class="number">7</span>, <span class="number">9</span>]</span><br><span class="line">new_data = <span class="built_in">list</span>(<span class="built_in">map</span>(add1, data)   <span class="comment"># map(add1,  data)  实际上是一个生成器，不会自动执行，必须遍历或者转成列表才会执行</span></span><br><span class="line"><span class="built_in">print</span>(new_data)  <span class="comment"># 得到列表 [2, 4, 8 , 10]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>filter()<br>filter使用一个函数来过滤数据<br>当某个数据传入函数时返回非”假”值（Python中False,None,0, ‘0’, ‘’,[], {}, (,)都被视为假），则保留。否则抛弃。示例如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">is_even = <span class="keyword">lambda</span> x: x % <span class="number">2</span> == <span class="number">0</span>   <span class="comment">#  过滤函数，x是偶数是 x对2取模==0，返回True，奇数时不等于0，返回False。</span></span><br><span class="line">data = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">6</span>, <span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>]</span><br><span class="line">new_data = <span class="built_in">list</span>(<span class="built_in">filter</span>(is_even, data))   <span class="comment"># filter同样是一个生成器，需要转列表才会执行。</span></span><br><span class="line"><span class="built_in">print</span>(new_data)  <span class="comment"># 得到列表 [2, 4, 6, 8]</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>reduce()<br>reduce使用一个函数，对序列进行累积操作，不同的是，这个函数接受两个参数，操作完将结果作为下一轮的第一个参数，再读入下一个参数。<br>如累加[1, 2, 3, 4, 5,6 ,7, 8, 9, 10]，先传入add(1,2)得到和3，第二轮结果3作为第一个参数，再传入下一个参数3得到add(3,3)结果6，下一轮则为add(6,4)…</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> fuctools <span class="keyword">import</span> reduce  <span class="comment"># 不同于map/filter，reduce需要导入方可使用</span></span><br><span class="line"></span><br><span class="line">add = <span class="keyword">lambda</span> x,y: x + y</span><br><span class="line">data = [<span class="number">1</span>, <span class="number">2</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>,<span class="number">6</span> ,<span class="number">7</span>, <span class="number">8</span>, <span class="number">9</span>, <span class="number">10</span>]</span><br><span class="line">result = reduce(add, data)  <span class="comment"># reduce调用即执行，返回序列操作完的最后结果</span></span><br><span class="line"><span class="built_in">print</span>(result)  <span class="comment"># 得到 55</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>sorted()</p>
<p>Python内置的<code>sorted()</code>函数就可以对list进行排序</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">sorted</span>([<span class="number">36</span>, <span class="number">5</span>, -<span class="number">12</span>, <span class="number">9</span>, -<span class="number">21</span>])</span><br><span class="line">[-<span class="number">21</span>, -<span class="number">12</span>, <span class="number">5</span>, <span class="number">9</span>, <span class="number">36</span>]</span><br></pre></td></tr></table></figure>

<p>它还可以接收一个<code>key</code>函数来实现自定义的排序<br>绝对值大小排序 - key &#x3D; abs</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">sorted</span>([<span class="number">36</span>, <span class="number">5</span>, -<span class="number">12</span>, <span class="number">9</span>, -<span class="number">21</span>], key=<span class="built_in">abs</span>)</span><br><span class="line">[<span class="number">5</span>, <span class="number">9</span>, -<span class="number">12</span>, -<span class="number">21</span>, <span class="number">36</span>]</span><br></pre></td></tr></table></figure>

<p>忽略大小写 - key &#x3D; str.lower </p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">sorted</span>([<span class="string">&#x27;bob&#x27;</span>, <span class="string">&#x27;about&#x27;</span>, <span class="string">&#x27;Zoo&#x27;</span>, <span class="string">&#x27;Credit&#x27;</span>], key=<span class="built_in">str</span>.lower)</span><br><span class="line">[<span class="string">&#x27;about&#x27;</span>, <span class="string">&#x27;bob&#x27;</span>, <span class="string">&#x27;Credit&#x27;</span>, <span class="string">&#x27;Zoo&#x27;</span>]</span><br></pre></td></tr></table></figure>

<p>进行反向排序 - reverse&#x3D;True</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">sorted</span>([<span class="string">&#x27;bob&#x27;</span>, <span class="string">&#x27;about&#x27;</span>, <span class="string">&#x27;Zoo&#x27;</span>, <span class="string">&#x27;Credit&#x27;</span>], key=<span class="built_in">str</span>.lower, reverse=<span class="literal">True</span>)</span><br><span class="line">[<span class="string">&#x27;Zoo&#x27;</span>, <span class="string">&#x27;Credit&#x27;</span>, <span class="string">&#x27;bob&#x27;</span>, <span class="string">&#x27;about&#x27;</span>]</span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="函数嵌套-和闭包"><a href="#函数嵌套-和闭包" class="headerlink" title="函数嵌套 和闭包"></a>函数嵌套 和闭包</h4><h5 id="函数嵌套"><a href="#函数嵌套" class="headerlink" title="函数嵌套"></a>函数嵌套</h5><p>​		函数嵌套是指在一个函数内部定义了另一个函数。这种嵌套的函数被称为内部函数，而包含它的外部函数被称为外部函数</p>
<p>嵌套的内部函数可以访问外部函数的参数，但是外部函数无法访问内部函数的参数。<br>如果想在内部函数内声明一个具有外部函数范围的参数可以使用<code>nolocal</code>关键字声明其为自由变量</p>
<p>优点：内部函数可以使用外部函数中的参数 (当内部函数使用了外部函数的参数时，就形成了闭包。)</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">outer_function</span>():</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">inner_function</span>():</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;This is inner function&quot;</span>)</span><br><span class="line">    </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot;This is outer function&quot;</span>)</span><br><span class="line">    inner_function()</span><br><span class="line">outer_function()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 当嵌套函数传入的参数是函数，则会变成装饰器； 这样便得到一个参数类型，检查装饰器@check</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">check</span>(<span class="params">add</span>):  <span class="comment"># 外部函数，接受一个add函数</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">new_add</span>(<span class="params">x, y</span>):  <span class="comment"># 内部函数</span></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(x, <span class="built_in">int</span>) <span class="keyword">or</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(y, <span class="built_in">int</span>):   <span class="comment"># 参数类型校验</span></span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">&#x27;x,y两个参数必须是整数类型&#x27;</span>)</span><br><span class="line">        result = add(x,y)   <span class="comment"># 可以使用外部函数参数add并得到结果</span></span><br><span class="line">        <span class="comment"># return result</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">return</span> new_add   <span class="comment"># 返回替换后的new_add函数，具有函数add的功能，还加了参数检查功能</span></span><br></pre></td></tr></table></figure>

<h5 id="闭包"><a href="#闭包" class="headerlink" title="闭包"></a>闭包</h5><p>​		闭包是指在一个内层函数中引用了其外层（封闭）作用域中变量的情况。这样的情况下，如果返回了内层函数，则该内层函数将继续保持对其封闭作用域中变量的引用，即使这些变量已经超出了其正常生命周期或者超出了原本作用域。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">counter</span>():</span><br><span class="line">    count = <span class="number">0</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">increment</span>():</span><br><span class="line">        <span class="keyword">nonlocal</span> count</span><br><span class="line">        count += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> count</span><br><span class="line">    </span><br><span class="line">    <span class="keyword">return</span> increment</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建两个计数器实例</span></span><br><span class="line">counter1 = counter()</span><br><span class="line">counter2 = counter()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(counter1()) <span class="comment"># 输出: 1</span></span><br><span class="line"><span class="built_in">print</span>(counter1()) <span class="comment"># 输出: 2</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(counter2()) <span class="comment"># 输出: 1</span></span><br><span class="line"><span class="built_in">print</span>(counter2()) <span class="comment"># 输出: 2</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 注意：每个计数器实例都有自己独立的状态和计数值。</span></span><br></pre></td></tr></table></figure>

<h5 id="总结："><a href="#总结：" class="headerlink" title="总结："></a>总结：</h5><ul>
<li>函数嵌套是指在一个函数里定义另一个子级或者局部级别别名。</li>
<li>当子级或者局势级别师徒能够访问父级别名称空间时就形成了闭包关系。</li>
<li>这种情况下，如果返回了子级或者局势级别师徒则他将会继续保存父亲名称空间数据区块信息</li>
</ul>
<h4 id="递归函数和尾递归"><a href="#递归函数和尾递归" class="headerlink" title="递归函数和尾递归"></a>递归函数和尾递归</h4><h5 id="递归函数"><a href="#递归函数" class="headerlink" title="递归函数"></a>递归函数</h5><ol>
<li>必须有出口条件，如最后一层1，有明确的结果1。</li>
<li>每层只负责乘以本层数字，调用自己推给下一层</li>
<li>整个推导过程要逐步趋于出口</li>
</ol>
<p>递归函数是指在函数的定义中调用函数本身的过程。递归函数通常用于解决可以被分解为相同问题的子问题的情况，每次递归调用都会将问题规模缩小，直到达到基本情况（递归终止条件）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">factorial</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> <span class="number">1</span></span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> n * factorial(n-<span class="number">1</span>) <span class="comment"># 自己调用自己</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">factorial() 函数通过递归调用自身来计算阶乘。当 n 的值为 0 时，递归终止，返回 1。否则，函数会将问题规模缩小，将 n 乘以 factorial(n-1) 的结果。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(factorial(<span class="number">5</span>))  <span class="comment"># 输出: 120</span></span><br></pre></td></tr></table></figure>

<h5 id="尾递归"><a href="#尾递归" class="headerlink" title="尾递归"></a>尾递归</h5><p>尾递归是一种特殊的递归形式，指的是递归函数的最后一个操作是递归调用本身。在尾递归中，递归调用是函数的最后一步操作，不会再有其他操作。</p>
<p>尾递归函数可以通过优化来避免栈溢出的问题，因为它们可以被转换为循环的形式，不会在每次递归调用时创建新的栈帧。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 计算斐波那契数列的尾递归函数的示例</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fibonacci</span>(<span class="params">n, a=<span class="number">0</span>, b=<span class="number">1</span></span>):</span><br><span class="line">    <span class="keyword">if</span> n == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">return</span> a</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="keyword">return</span> fibonacci(n-<span class="number">1</span>, b, a+b)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">fibonacci() 函数使用尾递归的方式计算斐波那契数列。每次递归调用时，更新参数 a 和 b 的值，并将 n 的值减少，直到达到递归终止条件。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(fibonacci(<span class="number">6</span>))  <span class="comment"># 输出: 8</span></span><br></pre></td></tr></table></figure>

<h5 id="总结：-1"><a href="#总结：-1" class="headerlink" title="总结："></a>总结：</h5><ul>
<li>递归函数是指在函数的定义中调用函数本身的过程，用于解决可以被分解为相同问题的子问题的情况。</li>
<li>尾递归是一种特殊的递归形式，指的是递归函数的最后一个操作是递归调用本身。</li>
<li>尾递归函数可以通过优化来避免栈溢出的问题，因为它们可以被转换为循环的形式，不会在每次递归调用时创建新的栈帧。</li>
</ul>
<h2 id="类与对象"><a href="#类与对象" class="headerlink" title="类与对象"></a>类与对象</h2><p>类（Class）和对象（Object），也称作实例（Instance）是面向对象编程（OOP)中的重要概念。类的主要作用如下：</p>
<ul>
<li>在同一模块中，对多个函数进行分组，并共享其中的变量；</li>
<li>按动作主体归类函数动作，使得逻辑更清晰。</li>
</ul>
<h3 id="面向过程及面向对象"><a href="#面向过程及面向对象" class="headerlink" title="面向过程及面向对象"></a>面向过程及面向对象</h3><p>面向过和面向对象是两种编程风格。</p>
<ul>
<li>面向过程：<strong>主要考虑功能的实现步骤和过程</strong>，即怎么去实现，多使用函数相互组合调用实现。</li>
<li>面向对象：<strong>主要考虑动作的主体和相互关系</strong>，即谁去实现，怎么配合，使用类的继承或组合实现。</li>
</ul>
<p>面向过程的实现逻辑如下：</p>
<ul>
<li>拆分过程</li>
<li>定义函数实现每个过程（过程可以包含子过程及相互调用）</li>
<li>在主函数中组合调用各个过程函数，完成整个流程。</li>
</ul>
<p>面向对象实现逻辑如下：</p>
<ul>
<li>根据动作主体进行建模，即需要几种对象（角色），每个对象需要哪些属性和方法</li>
<li>设计各个对象需要的类</li>
<li>在主流程中将每个类生成对象，组合对象完成整个流程操作。</li>
</ul>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/2023/06/14/python%E5%9F%BA%E7%A1%80/%E9%9D%A2%E7%9B%B8%E5%AF%B9%E8%B1%A1%E4%B8%8E%E9%9D%A2%E7%9B%B8%E8%BF%87%E7%A8%8B.png" alt="面相对象与面相过程"></p>
<h3 id="类与对象-实例-的关系"><a href="#类与对象-实例-的关系" class="headerlink" title="类与对象(实例)的关系"></a>类与对象(实例)的关系</h3><p>类是创建实例的模板，而实例则是一个一个具体的对象，各个实例拥有的数据都互相独立，互不影响；</p>
<h3 id="对象初始化方法"><a href="#对象初始化方法" class="headerlink" title="对象初始化方法"></a>对象初始化方法</h3><p>Python类中拥有很多魔术方法，起不同的作用，其中<code>__init__(self)</code>方法称作对象初始化方法，在调用类创建对象时自动调用，通常作用如下：</p>
<ul>
<li>将创建类传人的参数，绑定到对象属性</li>
<li>做一些对象初始化操作</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;我是一个学生&#x27;</span>)</span><br><span class="line">        self.name = name</span><br><span class="line">        self.age = age</span><br><span class="line">        </span><br><span class="line"><span class="comment"># 创建对象时将自动将参数传递给对象，并打印初始化信息</span></span><br><span class="line">lilei = Student(<span class="string">&#x27;李磊&#x27;</span>, <span class="number">18</span>)  <span class="comment"># 创建对象</span></span><br><span class="line"><span class="built_in">print</span>(lilei.name, lilei.age)</span><br></pre></td></tr></table></figure>



<h3 id="类属性及实例属性"><a href="#类属性及实例属性" class="headerlink" title="类属性及实例属性"></a>类属性及实例属性</h3><p>类中的属性称为类属性 ( 类共享)，绑定self的属性称为实例属性 (实例独有)，同时实例自动继承类属性</p>
<ul>
<li>类属性：可以使用类名或对象访问</li>
<li>对象属性：一般使用对象进行访问</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>:</span><br><span class="line">    role = <span class="string">&#x27;学生&#x27;</span>  <span class="comment"># 类属性</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):</span><br><span class="line">        self.name = name  <span class="comment"># 对象属性</span></span><br><span class="line">        self.age = age    <span class="comment"># 对象属性</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">lilei = Student(<span class="string">&#x27;李磊&#x27;</span>, <span class="number">18</span>)  <span class="comment"># 生成对象</span></span><br><span class="line"><span class="built_in">print</span>(lilei.role)  <span class="comment"># 使用对象引用类属性</span></span><br><span class="line"><span class="built_in">print</span>(lilei.name, lilei.age)  <span class="comment"># 使用对象引用对象属性</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(Student.role)  <span class="comment"># 使用类名引用类属性</span></span><br></pre></td></tr></table></figure>



<h3 id="访问限制-私有变量"><a href="#访问限制-私有变量" class="headerlink" title="访问限制 - 私有变量"></a>访问限制 - 私有变量</h3><p>如果要让内部属性不被外部访问，可以把属性的名称前加上两个下划线<code>__</code>，在Python中，实例的变量名如果以<code>__</code>开头，就变成了一个私有变量（private），只有内部可以访问，外部不能访问</p>
<p>不能直接访问<code>__name</code>是因为Python解释器对外把<code>__name</code>变量改成了<code>_Student__name</code>，所以，仍然可以通过<code>_Student__name</code>来访问<code>__name</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, score</span>):</span><br><span class="line">        self.__name = name</span><br><span class="line">        self.__score = score</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">print_score</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;%s: %s&#x27;</span> % (self.__name, self.__score))</span><br><span class="line">        </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_name</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.__name</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set_name</span>(<span class="params">self, name</span>):</span><br><span class="line">        self.__name = name</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_score</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self.__score</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">set_score</span>(<span class="params">self, score</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="number">0</span> &lt;= score &lt;= <span class="number">100</span>:</span><br><span class="line">            self.__score = score</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;bad score&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h3 id="类方法、实例方法及静态方法"><a href="#类方法、实例方法及静态方法" class="headerlink" title="类方法、实例方法及静态方法"></a>类方法、实例方法及静态方法</h3><p>类和实例是两种不同的范畴，因此在类中可以实例方法，也可以有类方法，如果方法根类和实例都没有关系，则可以设置成静态方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> datetime <span class="keyword">import</span> datetime</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>:</span><br><span class="line">    role = <span class="string">&#x27;学生&#x27;</span>  <span class="comment"># 类属性</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):</span><br><span class="line">        self.name = name  <span class="comment"># 对象属性</span></span><br><span class="line">        self.age = age    <span class="comment"># 对象属性</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_name</span>(<span class="params">self</span>):  <span class="comment"># 实例方法，self代表实例本身</span></span><br><span class="line">        <span class="keyword">return</span> self.name</span><br><span class="line"></span><br><span class="line"><span class="meta">    @classmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_class_role</span>(<span class="params">cls</span>):  <span class="comment"># 类方法，cls代表当前类名</span></span><br><span class="line">        <span class="keyword">return</span> cls.role</span><br><span class="line"></span><br><span class="line"><span class="meta">    @staticmethod</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">get_datetime</span>():  <span class="comment"># 静态方法，与类和对象都无关 (无需访问类/对象属性或调用其方法)</span></span><br><span class="line">        <span class="keyword">return</span> datetime.now().strftime(<span class="string">&#x27;%Y%m%d %H:%M:%D&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用对象调用</span></span><br><span class="line">lilei = Student(<span class="string">&#x27;李磊&#x27;</span>, <span class="number">18</span>)  <span class="comment"># 生成对象</span></span><br><span class="line"><span class="built_in">print</span>(lilei.get_name())  <span class="comment"># 对象调用实例方法</span></span><br><span class="line"><span class="built_in">print</span>(lilei.get_class_role())  <span class="comment"># 对象调用类方法</span></span><br><span class="line"><span class="built_in">print</span>(lilei.get_datetime())  <span class="comment"># 对象调用静态方法</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">静态方法和静态类属性是所有类和实例共享的。它们属于类本身，而不是类的实例。因此，无论是通过类还是实例访问和修改静态方法或静态类属性，都会影响到所有的类和实例。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="comment"># 使用类名调用，注意类名后不加括号(加括号是调用类并生成对象，即实际为对象）</span></span><br><span class="line"><span class="built_in">print</span>(Student.get_class_role())  <span class="comment"># 类名调用类方法</span></span><br><span class="line"><span class="built_in">print</span>(Student.get_datetime())    <span class="comment"># 类名调用静态方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 类也可以调用对象实例方法，但是需要传入一个对象本身，将self指向该对象</span></span><br><span class="line"><span class="built_in">print</span>(Student.get_name(lilei))   <span class="comment"># 类名调用对象方法，需要一个对象</span></span><br></pre></td></tr></table></figure>



<h3 id="继承和多态"><a href="#继承和多态" class="headerlink" title="继承和多态"></a>继承和多态</h3><p>在OOP程序设计中，当我们定义一个class的时候，可以从某个现有的class继承，新的class称为子类（Subclass），而被继承的class称为基类、父类或超类（Base class、Super class）。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Animal</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Animal is running...&#x27;</span>)</span><br><span class="line">       </span><br><span class="line"><span class="comment"># 继承可以让子类获得了父类的全部功能</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span>(<span class="title class_ inherited__">Animal</span>):  <span class="comment"># 继承Animal</span></span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cat</span>(<span class="title class_ inherited__">Animal</span>):	<span class="comment"># 继承Animal</span></span><br><span class="line">    <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">    重写是针对继承关系中的父类和子类，子类通过重写方法来改变继承自父类的方法的行为。</span></span><br><span class="line"><span class="string">	重载是在同一个类中定义多个具有相同名称但参数列表不同的方法，通过参数的不同来区分方法的调用。</span></span><br><span class="line"><span class="string">    &#x27;&#x27;&#x27;</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run</span>(<span class="params">self</span>):  <span class="comment"># 重写run方法</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;Animal-Cat is running...&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h3 id="获取对象属性"><a href="#获取对象属性" class="headerlink" title="获取对象属性"></a>获取对象属性</h3><ul>
<li><p>dir()</p>
<p>获得一个对象的所有属性和方法，可以使用<code>dir()</code>函数，它返回一个包含字符串的list</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">dir</span>(<span class="string">&#x27;ABC&#x27;</span>)</span><br><span class="line">[<span class="string">&#x27;__add__&#x27;</span>, <span class="string">&#x27;__class__&#x27;</span>,..., <span class="string">&#x27;__subclasshook__&#x27;</span>, <span class="string">&#x27;capitalize&#x27;</span>, <span class="string">&#x27;casefold&#x27;</span>,..., <span class="string">&#x27;zfill&#x27;</span>]</span><br></pre></td></tr></table></figure>
</li>
<li><p>__len__() or len()</p>
<p><code>len()</code>函数试图获取一个对象的长度，实际上，在<code>len()</code>函数内部，它自动去调用该对象的<code>__len__()</code>方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">len</span>(<span class="string">&#x27;ABC&#x27;</span>)</span><br><span class="line"><span class="number">3</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="string">&#x27;ABC&#x27;</span>.__len__()</span><br><span class="line"><span class="number">3</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 给自己的类写一个__len__()方法</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">class</span> <span class="title class_">MyDog</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">def</span> <span class="title function_">__len__</span>(<span class="params">self</span>):</span><br><span class="line"><span class="meta">... </span>        <span class="keyword">return</span> <span class="number">100</span></span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dog = MyDog()</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">len</span>(dog)</span><br><span class="line"><span class="number">100</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>hasattr()</p>
<p>判断某个对象中是否有该属性</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">hasattr</span>(obj1, <span class="string">&#x27;x&#x27;</span>) <span class="comment"># 有属性&#x27;x&#x27;吗？</span></span><br><span class="line"><span class="literal">True</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>getattr()</p>
<p>获取某个对象中的属性；当前属性不存在时会报错，建议结合hasattr() 使用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="built_in">hasattr</span>(obj1, <span class="string">&#x27;x&#x27;</span>):</span><br><span class="line">    <span class="built_in">getattr</span>(obj1, <span class="string">&#x27;x&#x27;</span>)</span><br><span class="line"><span class="comment"># or</span></span><br><span class="line"><span class="comment"># 通过第三个参数给默认值，当属性不存在时，返回默认值</span></span><br><span class="line"><span class="built_in">getattr</span>(obj1, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;属性不存在&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 通过getattr的返回值，把地址赋给fn变量</span></span><br><span class="line">fn = <span class="built_in">getattr</span>(obj1, <span class="string">&#x27;x&#x27;</span>, <span class="string">&#x27;属性不存在&#x27;</span>)</span><br><span class="line"><span class="comment"># 此时fn() 等同于 obj1.x()</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>setattr()</p>
<p>给某个对象的属性设置新的值</p>
</li>
<li><p>MethodType()</p>
<p>给对象实例绑定方法</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> types <span class="keyword">import</span> MethodType</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">set_age</span>(<span class="params">self, age</span>): <span class="comment"># 定义一个函数作为实例方法</span></span><br><span class="line">	self.age = age</span><br><span class="line">s = Student() <span class="comment"># 创建实例</span></span><br><span class="line"><span class="comment"># MethodType函数的第一个参数是方法，第二个参数是要绑定该方法的实例。</span></span><br><span class="line">s.set_age = MethodType(set_age, s) <span class="comment"># 给实例绑定一个方法</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 扩展：给class绑定方法，所有实例均可调用</span></span><br><span class="line">Student.set_age = set_age</span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="模块与包"><a href="#模块与包" class="headerlink" title="模块与包"></a>模块与包</h2><h3 id="模块"><a href="#模块" class="headerlink" title="模块"></a>模块</h3><h4 id="一个-py脚本就是一个模块"><a href="#一个-py脚本就是一个模块" class="headerlink" title="一个.py脚本就是一个模块"></a>一个.py脚本就是一个模块</h4><p>当程序较为复杂时，我们可以将不同类型的功能拆分成不同的模块，每个模块建立一个.py脚本。这样做的好处是：</p>
<ul>
<li>不同模块负责不同部分的内容，逻辑更清晰；</li>
<li>公共模块部分可以复用；</li>
<li>模块拥有独立的命名空间（不同模块中可以拥有同名的变量&#x2F;函数&#x2F;类型）。</li>
</ul>
<h4 id="模块导入"><a href="#模块导入" class="headerlink" title="模块导入"></a>模块导入</h4><p>一个模块可以导入其他模块，；但要避免循环导入，导入的名不能与当前模块重名</p>
<ul>
<li><p>import moudle</p>
<p>如<code>import time</code>，此时模块名被导入到当前命名空间，使用模块名引用其中的函数，如<code>time.sleep(1)</code></p>
</li>
<li><p>from moudle import …</p>
<p>如果要最小导入到模块，不能直接使用import 导入模块中的变量&#x2F;函数&#x2F;类，如<code>import time.sleep</code>；要使用<code>from .. import ...</code>语句</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 分开导入</span></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> localtime <span class="keyword">as</span> lt <span class="comment"># 如果一个模块的函数名太长，可以使用as别名，在该模块下可以使用别名来使用该函数 localtime() 等同于 lt()</span></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> sleep </span><br><span class="line"></span><br><span class="line"><span class="comment"># 一起导入</span></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> localtime, sleep</span><br><span class="line"></span><br><span class="line"><span class="comment"># 一起导入</span></span><br><span class="line"><span class="keyword">from</span> time <span class="keyword">import</span> (localtime, sleep)</span><br></pre></td></tr></table></figure>
</li>
<li><p>from moudle import *</p>
<p>如，<code>from time import *</code>，将导入<code>time</code>模块所有，非下划线<code>_</code>开头的变量&#x2F;函数&#x2F;类。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># aaa.py</span></span><br><span class="line">__all__ = [<span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>]  <span class="comment"># 设置from b import * 时只导入b和c变量</span></span><br><span class="line"></span><br><span class="line">b = <span class="number">1</span></span><br><span class="line">_b = <span class="number">2</span>  <span class="comment"># 下划线开头到变量视为私有变量，from b import * 时不会被导入</span></span><br><span class="line">c = <span class="number">3</span></span><br><span class="line">d = <span class="number">4</span>  <span class="comment"># __all__ 设置了不会导入d变量</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># bbb.py</span></span><br><span class="line"><span class="keyword">from</span> b <span class="keyword">import</span> *</span><br><span class="line"></span><br><span class="line">c = <span class="number">4</span> <span class="comment"># 将覆盖b中导入的c</span></span><br><span class="line"><span class="built_in">print</span>(b)</span><br><span class="line"><span class="built_in">print</span>(c)</span><br><span class="line"><span class="comment"># print(d)  # 由于没有导入d，因此打印d会报错</span></span><br><span class="line"><span class="comment"># print(_b)  # 由于没有导入d，因此打印d会报错</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">如果想使用b模块的私有变量_b，可以使用import b; print(b._b)，或 from b import _b; print(_b)等方式</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">这种方式是不被推荐的，原因如下：</span></span><br><span class="line"><span class="string">不知道都导入了哪些变量/模块/类；</span></span><br><span class="line"><span class="string">把其他模块的变量全部导入到当前命名空间，可能导致名称覆盖（重复），及来源不清楚。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure></li>
</ul>
<h4 id="模块导入常见问题"><a href="#模块导入常见问题" class="headerlink" title="模块导入常见问题"></a>模块导入常见问题</h4><h5 id="主模块和导入模块"><a href="#主模块和导入模块" class="headerlink" title="主模块和导入模块"></a>主模块和导入模块</h5><p>模块分为主模块和导入模块，当前执行模块被称为主模块，其他被导入的模块称为导入模块。可以使用Python魔术变量<code>__name__</code>（注意不加引号)，来查看当前模块是否主模块。<br>如果当前模块为主模块时，模块名<code>__name__</code>为字符串<code>&#39;__main__&#39;</code>;因此在模块中常用<code>if __name__ == &#39;__main__&#39;</code>来判断当前模块是不是主模块（即是不是以当前脚本为开始运行的）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;b模块，当前模块名&#x27;</span>, __name__)</span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;模块私有代码，只有b模块自己运行才会输出，别的模块导入不会输出&#x27;</span>)</span><br></pre></td></tr></table></figure>



<h5 id="间接导入问题"><a href="#间接导入问题" class="headerlink" title="间接导入问题"></a>间接导入问题</h5><p>间接导入是指a模块导入b模块，b模块导入c模块，运行a模块时c模块被间接导入</p>
<p>根本原因是：相对路径问题</p>
<p>例如：</p>
<figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">假如目录结构为：</span><br><span class="line">project/</span><br><span class="line">    package1/</span><br><span class="line">        __init__.py</span><br><span class="line">        ccc.py</span><br><span class="line">        bbb.py</span><br><span class="line">    package2/</span><br><span class="line">        __init__.py</span><br><span class="line">        aaa.py</span><br></pre></td></tr></table></figure>

<p>aaa.py 导入了bbb.py  ，但是 bbb.py 里面已经导入了ccc.py<br>此时，运行a.py，间接导入c模块时便会出现异常</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">    ...</span><br><span class="line">    <span class="keyword">import</span> ccc</span><br><span class="line">ModuleNotFoundError: No module named <span class="string">&#x27;ccc&#x27;</span></span><br></pre></td></tr></table></figure>

<p>原因为，运行a.py时，间接导入<code>import c</code>时，只会在a.py所在目录（当前运行目录是package2, 在bbb.py 中导入的路径是package1，导致找不到模块ccc.py）及PYTHONPATH、三方包site-packages中查找。而不会切换目录到b.py所在目录进行查找。</p>
<p>需要为当前python模块添加package1添加环境变量</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取当前脚本文件的路径</span></span><br><span class="line">current_file_path = os.path.abspath(__file__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取当前文件所在目录的父目录（即项目根目录）</span></span><br><span class="line">project_root = os.path.dirname(os.path.dirname(current_file_path))</span><br><span class="line"><span class="comment"># 添加到环境变量中</span></span><br><span class="line">sys.path.append(project_root)</span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h5 id="循环导入问题"><a href="#循环导入问题" class="headerlink" title="循环导入问题"></a>循环导入问题</h5><p>​	循环导入指a导入了b模块，b模块又直接或间接导入了a模块</p>
<ul>
<li>使用<code>import 模块</code> 导入时，允许循环导入，模块只在第一次导入时及作为主模块时运行</li>
<li>使用<code>from ... import ...</code>时不允许循环导入</li>
</ul>
<p>处理方法有以下几种：</p>
<ul>
<li>使用<code>import 模块</code>方式导入</li>
<li>将<code>from ... import ...</code>改到函数内部（延迟执行）</li>
<li>使用包<code>__init__.py</code>统一规划导入方式</li>
</ul>
<h5 id="导入立即执行及调用-延迟-执行"><a href="#导入立即执行及调用-延迟-执行" class="headerlink" title="导入立即执行及调用(延迟)执行"></a>导入立即执行及调用(延迟)执行</h5><p>在导入模块时，有些是立即执行，有些时调用时才执行的</p>
<p>第一次导入模块时立即执行的有：</p>
<ul>
<li>直接写模块中的语句</li>
<li>装饰器</li>
<li>类变量</li>
</ul>
<p>调用时才执行的有：</p>
<ul>
<li>定义的函数</li>
<li>定义的类及方法</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">deco</span>(<span class="params">func</span>):   <span class="comment"># 装饰器函数</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;调用 %s&#x27;</span> % func.__name__)</span><br><span class="line">    <span class="keyword">return</span> func</span><br><span class="line"></span><br><span class="line"><span class="meta">@deco  </span><span class="comment"># 装饰器调用，第一次导入模块时立即执行</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">add</span>(<span class="params">x, y</span>):  <span class="comment"># 函数定义，调用函数时执行</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;%s+%s&#x27;</span> % (x, y))</span><br><span class="line">    <span class="keyword">return</span> x + y</span><br><span class="line"></span><br><span class="line">s1 = add(<span class="number">1</span>, <span class="number">2</span>)  <span class="comment"># 模块语句，第一次导入模块时立即执行</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Calc</span>:  <span class="comment"># 类定义，调用类(生成对象时) 执行__init__方法</span></span><br><span class="line">    s2 = add(<span class="number">3</span>, <span class="number">4</span>)  <span class="comment"># 类属性，第一次导入模块时立即执行</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;对象初始化&#x27;</span>)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">sub</span>(<span class="params">self, x, y</span>):  <span class="comment"># 对象方法，调用时执行</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;%s-%s&#x27;</span> % (x, y))</span><br><span class="line">        <span class="keyword">return</span> x - y</span><br></pre></td></tr></table></figure>



<h3 id="包-package"><a href="#包-package" class="headerlink" title="包 package"></a>包 package</h3><h4 id="包Package"><a href="#包Package" class="headerlink" title="包Package"></a>包Package</h4><p>当拥有多个模块时，我们可以使用包来组织同一类别或层次的模块。在Python<br><strong>在Python中，一个目录被视为包</strong>，包中可以包含其他子包（子目录），包中不强制必须有<code>__init__.py</code>文件。<br>包中可以包含<code>__init__.py</code>文件作为包的初始化配置，<code>__init__.py</code>可以为空。<br>在Python3中，目录中是否包含<code>__init__.py</code>机会没有区别，我们可以使用Python魔术变量__pacakge__查看当前模块所在包路径。</p>
<p>ython中常用的魔术变量如下：</p>
<ul>
<li><code>__file__</code>：表示当前脚本路径</li>
<li><code>__name__</code>: 表示当前模块导入路径，作为主模块时（当前运行脚本)，其值为<code>&#39;__main__&#39;</code>，否则为其模块导入路径</li>
<li><code>__package__</code>: 当前包导入路径，作为主模块时（当前运行脚本)，其值为<code>None</code>，否则为其模块所在包导入路径</li>
<li><code>__buildins__</code>: 当前所有可用内置变量&#x2F;函数组成的字典</li>
</ul>
<h4 id="导入包及模块"><a href="#导入包及模块" class="headerlink" title="导入包及模块"></a>导入包及模块</h4><p>同模块导入一样，包的导入也支持<code>import ...</code>和<code>from ... import ...</code>两种导入方式</p>
<h4 id="导入包或子包"><a href="#导入包或子包" class="headerlink" title="导入包或子包"></a>导入包或子包</h4><p>在main.py中，可以使用如下语句导入包或子包</p>
<ul>
<li>import package</li>
<li>import package.sub_package</li>
</ul>
<p>此时实际导入的是<code>package/__init__.py</code>,及<code>package/sub_package/__init__.py</code></p>
<h4 id="包中-init-py的作用"><a href="#包中-init-py的作用" class="headerlink" title="包中__init__.py的作用"></a>包中<code>__init__.py</code>的作用</h4><p>包中的<code>__init__.py</code>常用作包的初始配置，常见使用场景如下：</p>
<ul>
<li>导入包时进行一些初始化操作</li>
<li>修改包中模块的导入设置</li>
</ul>
<p>从包中导入模块时的查找顺序为，先从包<code>__init__.py</code>中查找同名变量，如果没有，则在包所在目录中查找同名脚本（模块）。<br>一般可以使用__init__.py来整理包所要暴露的模块及功能（模块中的变量&#x2F;函数&#x2F;类）</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># package/__init__.py</span></span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> a</span><br><span class="line"><span class="keyword">from</span> . <span class="keyword">import</span> b</span><br><span class="line"><span class="keyword">from</span> .sub_package <span class="keyword">import</span> c</span><br><span class="line"><span class="keyword">from</span> .a <span class="keyword">import</span> var_a</span><br><span class="line"><span class="keyword">from</span> .b <span class="keyword">import</span> var_b</span><br><span class="line"><span class="keyword">from</span> .sub_package.c <span class="keyword">import</span> var_c</span><br></pre></td></tr></table></figure>

<p>此时我们便可以直接通过package导入所暴露的变量，例如在main.py中</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 通过模块直接导入</span></span><br><span class="line"><span class="keyword">from</span> package <span class="keyword">import</span> a, b, c, var_a, var_b, var_c</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(a.var_a, b.var_b, c.var_c)</span><br><span class="line"><span class="built_in">print</span>(var_a, var_b, var_c)</span><br></pre></td></tr></table></figure>

<p>同时，在包<code>__init__.py</code>中也可以下划线开头的私有变量，及使用<code>__all__</code>变量来限制<code>from package import *</code>时导入的全部变量。</p>
<h2 id="文件操作"><a href="#文件操作" class="headerlink" title="文件操作"></a>文件操作</h2><h3 id="纯文本文件读取"><a href="#纯文本文件读取" class="headerlink" title="纯文本文件读取"></a>纯文本文件读取</h3><ul>
<li><p><strong>读取全部内容</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;demo.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">data = f.read()  <span class="comment"># 读取文件全部内容</span></span><br><span class="line"><span class="built_in">print</span>(data)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>按行读取</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;demo.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">line = f.readline()  <span class="comment"># 读取一行(包括结尾的换行符)</span></span><br><span class="line"><span class="built_in">print</span>(line)</span><br><span class="line">line = f.readline()  <span class="comment"># 读取下一行(包括结尾的换行符)</span></span><br><span class="line"><span class="built_in">print</span>(line)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>结合for循环按行读取文件全部内容</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;demo.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line"><span class="keyword">for</span> line <span class="keyword">in</span> f.readlines():   <span class="comment"># 也可以直接 for line in f:</span></span><br><span class="line">    <span class="built_in">print</span>(line)  <span class="comment"># 每一行内容包括结尾的换行符</span></span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="纯文本文件写入"><a href="#纯文本文件写入" class="headerlink" title="纯文本文件写入"></a>纯文本文件写入</h3><ul>
<li><p><strong>写入整段文本</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">data = <span class="string">&#x27;&#x27;&#x27;hello</span></span><br><span class="line"><span class="string">world</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;demo2.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    f.write(data)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure>
</li>
<li><p><strong>写入多行数据</strong><br>有一行一行文本组成的列表型数据，可以使用f.writelines()写入</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">data = [<span class="string">&#x27;hello\n&#x27;</span>, <span class="string">&#x27;world\n&#x27;</span>]</span><br><span class="line">f = <span class="built_in">open</span>(<span class="string">&#x27;demo2.txt&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>)</span><br><span class="line">    f.writelines(data)</span><br><span class="line">f.close()</span><br></pre></td></tr></table></figure></li>
</ul>
<h3 id="使用上下文格式自动关闭文件"><a href="#使用上下文格式自动关闭文件" class="headerlink" title="使用上下文格式自动关闭文件"></a>使用上下文格式自动关闭文件</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 退出with语句(如print时)，自动关闭文件。</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;demo.txt&#x27;</span>, <span class="string">&#x27;r&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line"><span class="built_in">print</span>(data)</span><br></pre></td></tr></table></figure>



<h3 id="非纯文件读写"><a href="#非纯文件读写" class="headerlink" title="非纯文件读写"></a>非纯文件读写</h3><p>二进制格式读写图片等非二进制文件，有一张图片hua.jpg，我们可以读写来复制文件</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 使用二进制读/写模式打开时无需指定编码</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;hua.jpg&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = f.read()</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;hua_copy.jpg&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    f.write(data)</span><br></pre></td></tr></table></figure>



<h3 id="读写模式"><a href="#读写模式" class="headerlink" title="读写模式"></a>读写模式</h3><table>
<thead>
<tr>
<th>标示</th>
<th>文本模式 (默认)。</th>
</tr>
</thead>
<tbody><tr>
<td>x</td>
<td>写模式，新建一个文件，如果该文件已存在则会报错。</td>
</tr>
<tr>
<td>b</td>
<td>二进制模式。</td>
</tr>
<tr>
<td>+</td>
<td>打开一个文件进行更新(可读可写)。</td>
</tr>
<tr>
<td>U</td>
<td>通用换行模式（Python 3 不支持）。</td>
</tr>
<tr>
<td>r</td>
<td>以只读方式打开文件。文件的指针将会放在文件的开头。这是默认模式。</td>
</tr>
<tr>
<td>rb</td>
<td>以二进制格式打开一个文件用于只读。文件指针将会放在文件的开头。这是默认模式。一般用于非文本文件如图片等。</td>
</tr>
<tr>
<td>r+</td>
<td>打开一个文件用于读写。文件指针将会放在文件的开头。</td>
</tr>
<tr>
<td>rb+</td>
<td>以二进制格式打开一个文件用于读写。文件指针将会放在文件的开头。一般用于非文本文件如图片等。</td>
</tr>
<tr>
<td>w</td>
<td>打开一个文件只用于写入。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。</td>
</tr>
<tr>
<td>wb</td>
<td>以二进制格式打开一个文件只用于写入。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。一般用于非文本文件如图片等。</td>
</tr>
<tr>
<td>w+</td>
<td>打开一个文件用于读写。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。</td>
</tr>
<tr>
<td>wb+</td>
<td>以二进制格式打开一个文件用于读写。如果该文件已存在则打开文件，并从开头开始编辑，即原有内容会被删除。如果该文件不存在，创建新文件。一般用于非文本文件如图片等。</td>
</tr>
<tr>
<td>a</td>
<td>打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。</td>
</tr>
<tr>
<td>ab</td>
<td>以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。也就是说，新的内容将会被写入到已有内容之后。如果该文件不存在，创建新文件进行写入。</td>
</tr>
<tr>
<td>a+</td>
<td>打开一个文件用于读写。如果该文件已存在，文件指针将会放在文件的结尾。文件打开时会是追加模式。如果该文件不存在，创建新文件用于读写。</td>
</tr>
<tr>
<td>ab+</td>
<td>以二进制格式打开一个文件用于追加。如果该文件已存在，文件指针将会放在文件的结尾。如果该文件不存在，创建新文件用于读写。</td>
</tr>
</tbody></table>
<h3 id="其他类型文件读取"><a href="#其他类型文件读取" class="headerlink" title="其他类型文件读取"></a>其他类型文件读取</h3><h4 id="数据及配置文件之争"><a href="#数据及配置文件之争" class="headerlink" title="数据及配置文件之争"></a>数据及配置文件之争</h4><p>数据及文件通常有三种类型：</p>
<ol>
<li>配置文件型：如ini，conf，properties文件，适合存储简单变量和配置项，最多支持两层，不适合存储多层嵌套数据</li>
<li>表格矩阵型：如csv，excel等，适合于存储大量同类数据，不适合存储层级结构的数据</li>
<li>多层嵌套型：如XML，HTMl，JSON、YAML，TOML等，适合存储单条或少数多层嵌套数据，不适合存储大量数据</li>
</ol>
<h4 id="CSV文件"><a href="#CSV文件" class="headerlink" title="CSV文件"></a>CSV文件</h4><p>​		CSV(Comma-Separated Values)即逗号分隔值，一种以逗号分隔按行存储的文本文件，所有的值都表现为字符串类型（注意：数字为字符串类型）。<br>​		如果CSV中有中文，应以utf-8编码读写，如果要支持Excel查看，应是要用utf-8 with bom格式及utf-8-sig</p>
<h5 id="Python3操作CSV文件使用自带的csv包"><a href="#Python3操作CSV文件使用自带的csv包" class="headerlink" title="Python3操作CSV文件使用自带的csv包"></a>Python3操作CSV文件使用自带的csv包</h5><ul>
<li>reader&#x3D;csv.reader(f, delimiter&#x3D;’,’)：用来读取数据，reader为生成器，每次读取一行，每行数据为列表格式，可以通过delimiter参数指定分隔符</li>
<li>writer&#x3D;csv.writer(f)：用来写入数据，按行写入，writer支持writerow(列表)单行写入，和writerows(嵌套列表)批量写入多行，无须手动保存。</li>
<li>当文件中有标题行时，可以使用header&#x3D;next(reader)先获取到第一行的数据，再进行遍历所有的数据行。</li>
<li>写入时，可以先使用writer.writerow(标题行列表)，写入标题行，再使用writer.writerows(多行数据嵌套列表)，写入多行数据（也可以逐行写入）。</li>
</ul>
<p>示例：</p>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">// 数据文件data.csv</span><br><span class="line">name,password,status</span><br><span class="line">abc,123456,</span><br><span class="line">张五,123#456,</span><br><span class="line">张#abc123,123456,</span><br><span class="line">666,123456,</span><br><span class="line">a b,123456,</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># getCsvFile.py  读取</span></span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data.csv&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="comment"># 读取数据，reader为生成器，每次读取一行，每行数据为列表格式</span></span><br><span class="line">    reader = csv.reader(f)</span><br><span class="line">    header = <span class="built_in">next</span>(reader)</span><br><span class="line">    <span class="built_in">print</span>(header)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        <span class="built_in">print</span>(row)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">reader必须在文件打开的上下文中使用，否则文件被关闭后reader无法使用</span></span><br><span class="line"><span class="string">所有的数字被作为字符串，如果要使用数字格式，应使用int()/float()做相应转换</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># setCsvFile.py  写入</span></span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line">header = [<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;status&#x27;</span>]</span><br><span class="line"></span><br><span class="line">data = [</span><br><span class="line">    [<span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;PASS&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;张五&#x27;</span>, <span class="string">&#x27;123#456&#x27;</span>, <span class="string">&#x27;PASS&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;张#abc123&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;PASS&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;666&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;PASS&#x27;</span>],</span><br><span class="line">    [<span class="string">&#x27;a b&#x27;</span>, <span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;PASS&#x27;</span>]</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;result.csv&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    writer = csv.writer(f)</span><br><span class="line">    writer.writerow(header)</span><br><span class="line">    writer.writerows(data)</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">打开文件时应指定格式为w, 文本写入，不支持wb,二进制写入，当然，也可以使用a/w+/r+</span></span><br><span class="line"><span class="string">打开文件时，指定不自动添加新行newline=&#x27;&#x27;,否则每写入一行就或多一个空行。</span></span><br><span class="line"><span class="string">如果想写入的文件Excel打开没有乱码，utf-8可以改为utf-8-sig。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>



<h5 id="使用字典格式的数据：DictReader-DictWriter"><a href="#使用字典格式的数据：DictReader-DictWriter" class="headerlink" title="使用字典格式的数据：DictReader, DictWriter"></a>使用字典格式的数据：DictReader, DictWriter</h5><p>​	!!! 使用此方法时，必须有标题行才能使用</p>
<ul>
<li>reader&#x3D;csv.DictReader(f)：直接将标题和每一列数据组装成有序字典（OrderedDict）格式，无须再单独读取标题行</li>
<li>writer&#x3D;csv.DictWriter(f, 标题行列表)：写入时可使用writer.writeheader()写入标题，然后使用writer.writerow(字典格式数据行)或write.writerows(多行数据)</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># getCsvFile.py</span></span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data.csv&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    reader = csv.DictReader(f)</span><br><span class="line">    <span class="keyword">for</span> row <span class="keyword">in</span> reader:</span><br><span class="line">        <span class="built_in">print</span>(row[<span class="string">&#x27;name&#x27;</span>], row[<span class="string">&#x27;password&#x27;</span>],row[<span class="string">&#x27;status&#x27;</span>])</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># setCsvFile.py</span></span><br><span class="line"><span class="keyword">import</span> csv</span><br><span class="line"></span><br><span class="line">header = [<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;password&#x27;</span>, <span class="string">&#x27;status&#x27;</span>]</span><br><span class="line"></span><br><span class="line">data = [</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;abc&#x27;</span>, <span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;status&#x27;</span>:<span class="string">&#x27;PASS&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;张五&#x27;</span>, <span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;123#456&#x27;</span>, <span class="string">&#x27;status&#x27;</span>:<span class="string">&#x27;PASS&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;张#abc123&#x27;</span>, <span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;status&#x27;</span>:<span class="string">&#x27;PASS&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;666&#x27;</span>, <span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;status&#x27;</span>:<span class="string">&#x27;PASS&#x27;</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>:<span class="string">&#x27;a b&#x27;</span>, <span class="string">&#x27;password&#x27;</span>:<span class="string">&#x27;123456&#x27;</span>, <span class="string">&#x27;status&#x27;</span>:<span class="string">&#x27;PASS&#x27;</span>&#125;</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;result2.csv&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>, newline=<span class="string">&#x27;&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    writer = csv.DictWriter(f, header)</span><br><span class="line">    writer.writeheader()</span><br><span class="line">    writer.writerows(data)</span><br></pre></td></tr></table></figure>



<h4 id="ini文件"><a href="#ini文件" class="headerlink" title="ini文件"></a>ini文件</h4><p>​		ini文件即Initialization File初始化文件，在应用程序及框架中常作为配置文件使用，是一种静态纯文本文件，使用记事本即可编辑。<br>​		配置文件的主要功能就是存储一批变量和变量值，在ini文件中使用<code>[章(Section)]</code>对变量进行了分组，基本格式如下。</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># filename: config.ini</span></span><br><span class="line"><span class="section">[user]</span></span><br><span class="line"><span class="attr">name</span>=admin</span><br><span class="line"><span class="attr">password</span>=<span class="number">123456</span></span><br><span class="line"><span class="attr">is_admin</span>=<span class="literal">true</span></span><br><span class="line"></span><br><span class="line"><span class="section">[mysql]</span></span><br><span class="line"><span class="attr">host</span>=<span class="number">10.10</span>.<span class="number">10.10</span></span><br><span class="line"><span class="attr">port</span>=<span class="number">3306</span></span><br><span class="line"><span class="attr">db</span>=apitest</span><br><span class="line"><span class="attr">user</span>=root</span><br><span class="line"><span class="attr">password</span>=<span class="number">123456</span></span><br><span class="line"></span><br><span class="line"><span class="section">[log]</span></span><br><span class="line"><span class="attr">file</span>=run.log</span><br><span class="line"><span class="attr">level</span>=info</span><br></pre></td></tr></table></figure>

<p>以上文件中，有3个Section段，分别user、mysql和log<br>ini文件中使用<code>#</code>或者<code>;</code>添加注释，最好独占一行，不能写在变量后面</p>
<h5 id="读取"><a href="#读取" class="headerlink" title="读取"></a>读取</h5><p>读取ini配置文件需要使用Python3自带的configparser库，使用示例如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> configparser <span class="keyword">import</span> ConfigParser   <span class="comment"># Python2中是from ConfigParser import ConfigParser</span></span><br><span class="line"></span><br><span class="line">conf = ConfigParser()  <span class="comment"># 需要实例化一个ConfigParser对象</span></span><br><span class="line">conf.read(<span class="string">&#x27;config.ini&#x27;</span>)  <span class="comment"># 需要添加上config.ini的路径，不需要open打开，直接给文件路径就读取，也可以指定encoding=&#x27;utf-8&#x27;</span></span><br><span class="line"><span class="comment"># conf对象每个section段的数据类似于一个字典，可以使用[&#x27;变量名&#x27;]或者.get(&#x27;变量名&#x27;)获取对应的值，获取到的是字符串格式。</span></span><br><span class="line"><span class="built_in">print</span>(conf[<span class="string">&#x27;user&#x27;</span>][<span class="string">&#x27;name&#x27;</span>])  <span class="comment"># 读取user段的name变量的值，字符串格式</span></span><br></pre></td></tr></table></figure>

<p>其他常用的读取方法如下：</p>
<ul>
<li>conf.sections(): 获取所有的section名，结果[‘user’, ‘mysql’, ‘log’]</li>
<li>conf[‘mysql’][‘port’]: 获取section端port变量的值，字符串格式</li>
<li>conf[‘mysql’].get(‘port’): 同上，字符串格式</li>
<li>conf.get(‘mysql’, ‘port’): 同上，字符串格式</li>
<li>conf[‘mysql’].getint(‘port’): 获取对应变量的整型值</li>
<li>conf[‘mysql’].getfloat(‘port’): 获取对应变量的浮点型值</li>
<li>conf[‘user’].getboolean(‘is_admin’): 获取对应变量的布尔值，支持配置为<code>yes/no, on/‘off, true/false 和 1/0</code>，都可以转化为Python中的True&#x2F;False</li>
<li>conf.has_section(section)：检查是否有该section</li>
<li>conf.options(section)：输出section中所有的变量名</li>
<li>conf.has_option(section, option)：检查指定section下是否有该变量值</li>
</ul>
<p>如果想遍历一个section所有的变量和值，可以像遍历字典意义操作，示例如下</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> key, value <span class="keyword">in</span> conf[<span class="string">&#x27;mysql&#x27;</span>].items():</span><br><span class="line">    <span class="built_in">print</span>(key, value)</span><br><span class="line"><span class="comment"># ini文件中的变量名是大小写不敏感的，而Section名是大小写敏感的。</span></span><br></pre></td></tr></table></figure>



<h5 id="公共变量"><a href="#公共变量" class="headerlink" title="公共变量"></a>公共变量</h5><p>假如我们每个Section变量组都有一批相同的重复变量，如：</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[dev]</span></span><br><span class="line"><span class="comment"># 开发环境</span></span><br><span class="line"><span class="attr">user</span>=admin</span><br><span class="line"><span class="attr">password</span>=<span class="number">123456</span></span><br><span class="line"><span class="attr">base_url</span>=http://localhost:<span class="number">7777</span></span><br><span class="line"></span><br><span class="line"><span class="section">[test]</span></span><br><span class="line"><span class="comment"># 测试环境</span></span><br><span class="line"><span class="attr">user</span>=admin</span><br><span class="line"><span class="attr">password</span>=<span class="number">123456</span></span><br><span class="line"><span class="attr">base_url</span>=http://test.abc.com</span><br><span class="line"></span><br><span class="line"><span class="section">[prod]</span></span><br><span class="line"><span class="comment"># 生产环境</span></span><br><span class="line"><span class="attr">user</span>=admin</span><br><span class="line"><span class="attr">password</span>=<span class="number">123456</span></span><br><span class="line"><span class="attr">base_url</span>=http://www.abc.com</span><br></pre></td></tr></table></figure>

<p>对应这种，我们可以设置[DEFAULT]段公用变量，公用变量会自动添加到每一个段中，修改后如下</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[DEFAULT]</span></span><br><span class="line"><span class="attr">user</span>=admin</span><br><span class="line"><span class="attr">password</span>=<span class="number">123456</span></span><br><span class="line"></span><br><span class="line"><span class="section">[dev]</span></span><br><span class="line"><span class="comment"># 开发环境</span></span><br><span class="line"><span class="attr">base_url</span>=http://localhost:<span class="number">7777</span></span><br><span class="line"></span><br><span class="line"><span class="section">[test]</span></span><br><span class="line"><span class="comment"># 测试环境</span></span><br><span class="line"><span class="attr">base_url</span>=http://test.abc.com</span><br><span class="line"></span><br><span class="line"><span class="section">[prod]</span></span><br><span class="line"><span class="comment"># 生产环境</span></span><br><span class="line"><span class="attr">base_url</span>=http://www.abc.com</span><br></pre></td></tr></table></figure>



<h5 id="参数化"><a href="#参数化" class="headerlink" title="参数化"></a>参数化</h5><p>在ini文件中我们还可以使用<code>%(变量名)s</code>的占位符进行参数化，这种特性被称为Interpolation(插值)。</p>
<figure class="highlight ini"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="section">[DEFAULT]</span></span><br><span class="line"><span class="attr">url</span> = %(base_url)s/get?a=%(a)s&amp;b=%(b)s</span><br><span class="line"><span class="attr">base_url</span>=https://httpbin.org</span><br><span class="line"></span><br><span class="line"><span class="section">[dev]</span></span><br><span class="line"><span class="comment"># 开发环境</span></span><br><span class="line"><span class="attr">base_url</span>=http://localhost:<span class="number">5555</span></span><br><span class="line"><span class="attr">a</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">b</span>=<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="section">[prod-case1]</span></span><br><span class="line"><span class="comment"># 生成环境-场景1</span></span><br><span class="line"><span class="attr">a</span>=<span class="number">1</span></span><br><span class="line"><span class="attr">b</span>=<span class="number">2</span></span><br><span class="line"></span><br><span class="line"><span class="section">[prod-case2]</span></span><br><span class="line"><span class="comment"># 生成环境-场景2</span></span><br><span class="line"><span class="attr">a</span>=kevin</span><br><span class="line"><span class="attr">b</span>=male</span><br></pre></td></tr></table></figure>

<p>上例中，我们在[DEFAULT]段设置了一个参数化的公用变量url，其中埋设了三个占位符，%(base_url)s、%(a)s、和%(b)s。<br>并且我们设置了base_url变量的默认值为<a target="_blank" rel="noopener" href="https://httpbin.org./">https://httpbin.org。</a><br>当下面的section中没有覆盖该变量时，如prod-case1和prod-case2中，是用base_url的默认值。</p>
<p>!!!  每个section段中，加上默认变量base_url，必须提供所有参数化变量的值，比如此例中每个段最少必须设置a和b的值，否则会报错。</p>
<p>在Python脚本中打印<code>conf[&#39;prod-case2&#39;][&#39;url&#39;]</code>，可以得到组装后的url。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">base_url = conf[<span class="string">&#x27;prod-case2&#x27;</span>][<span class="string">&#x27;url&#x27;</span>] <span class="comment"># https://httpbin.org/get?a=kevin&amp;b=male</span></span><br></pre></td></tr></table></figure>



<h5 id="修改保存"><a href="#修改保存" class="headerlink" title="修改保存"></a>修改保存</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> configparser <span class="keyword">import</span> ConfigParser</span><br><span class="line"><span class="keyword">from</span> configparser <span class="keyword">import</span> ConfigParser</span><br><span class="line"></span><br><span class="line">conf = ConfigParser()</span><br><span class="line"></span><br><span class="line">conf.read(<span class="string">&#x27;httpbin.ini&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="comment"># 如果新建的话就不需要read,如果修改则需要使用read打开</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用set() 方法修改</span></span><br><span class="line">conf.<span class="built_in">set</span>(<span class="string">&#x27;DEFAULT&#x27;</span>, <span class="string">&#x27;url&#x27;</span>, <span class="string">&#x27;%(base_url)s/get?a=%(a)s&amp;b=%(b)s&#x27;</span>)  <span class="comment"># 可以设置DEFAULT段的值</span></span><br><span class="line">conf.<span class="built_in">set</span>(<span class="string">&#x27;DEFAULT&#x27;</span>, <span class="string">&#x27;base_url&#x27;</span>, <span class="string">&#x27;https://httpbin.org&#x27;</span>)  <span class="comment"># 可以设置DEFAULT段的值</span></span><br><span class="line">conf.add_section(<span class="string">&#x27;dev&#x27;</span>)</span><br><span class="line">conf.<span class="built_in">set</span>(<span class="string">&#x27;dev&#x27;</span>, <span class="string">&#x27;base_url&#x27;</span>, <span class="string">&#x27;http://localhost:5555&#x27;</span>)</span><br><span class="line">conf.<span class="built_in">set</span>(<span class="string">&#x27;dev&#x27;</span>, <span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;1&#x27;</span>)  <span class="comment"># 值必须是字符串</span></span><br><span class="line">conf.<span class="built_in">set</span>(<span class="string">&#x27;dev&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;2&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用下标的方式</span></span><br><span class="line">conf[<span class="string">&#x27;prod-case1&#x27;</span>] = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="number">1</span>, <span class="string">&#x27;b&#x27;</span>: <span class="number">2</span>&#125;  <span class="comment"># 直接使用字典添加多个变量</span></span><br><span class="line">conf[<span class="string">&#x27;prod-case2&#x27;</span>] = &#123;<span class="string">&#x27;a&#x27;</span>: <span class="string">&#x27;kevin&#x27;</span>, <span class="string">&#x27;b&#x27;</span>: <span class="string">&#x27;male&#x27;</span>&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(conf.get(<span class="string">&#x27;dev&#x27;</span>, <span class="string">&#x27;url&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(conf.get(<span class="string">&#x27;prod-case1&#x27;</span>, <span class="string">&#x27;url&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(conf.get(<span class="string">&#x27;prod-case2&#x27;</span>, <span class="string">&#x27;url&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 保存csv</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;httpbin.ini&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    conf.write(f)</span><br></pre></td></tr></table></figure>



<h4 id="JSON文件"><a href="#JSON文件" class="headerlink" title="JSON文件"></a>JSON文件</h4><p>JSON(JavaScript Object Notation)即JavaScript对象表示法,一种轻量级，通用的<strong>文本</strong>数据格式。<br>JSON语法支持对象（Object），数组（Array），字符串，数字（int&#x2F;float）以及true&#x2F;false和null。<br>JSON拥有严格的格式，主要格式如下：</p>
<ul>
<li>只能用双引号，不能用单引号</li>
<li>元素之间用逗号隔开，最后一个元素不能有逗号</li>
<li>不支持注释</li>
<li>中文等特殊字符传输时应确保转为ASCII码（\uXXX格式）</li>
<li>支持多层嵌套Object或Array</li>
</ul>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Cactus&quot;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">18</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;skills&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span><span class="string">&quot;Python&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Java&quot;</span><span class="punctuation">,</span> <span class="string">&quot;Go&quot;</span><span class="punctuation">,</span> <span class="string">&quot;NodeJS&quot;</span><span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;has_blog&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">    <span class="attr">&quot;gf&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h5 id="JSON与Python数据类型的对应关系"><a href="#JSON与Python数据类型的对应关系" class="headerlink" title="JSON与Python数据类型的对应关系"></a>JSON与Python数据类型的对应关系</h5><table>
<thead>
<tr>
<th>JSON</th>
<th>Python</th>
</tr>
</thead>
<tbody><tr>
<td>Object</td>
<td>字典</td>
</tr>
<tr>
<td>Array</td>
<td>列表</td>
</tr>
<tr>
<td>字符串</td>
<td>字符串</td>
</tr>
<tr>
<td>数字</td>
<td>数字（int&#x2F;float）</td>
</tr>
<tr>
<td>true&#x2F;false</td>
<td>True&#x2F;False</td>
</tr>
<tr>
<td>null</td>
<td>Null</td>
</tr>
</tbody></table>
<h5 id="JSON字符串与Python字典的相互转换"><a href="#JSON字符串与Python字典的相互转换" class="headerlink" title="JSON字符串与Python字典的相互转换"></a>JSON字符串与Python字典的相互转换</h5><p>!!!  为什么要相互转换，JSON是字符串，方便存储传输，不方便提取值；字典是内存中的数据结构，取值方便，不方便传输和存储</p>
<p>使用Python自带的json包可以完成字典与JSON字符串的相互转换</p>
<ul>
<li>json.dumps(字典)：将字典转为JSON字符串</li>
<li>json.loads(JSON字符串)：将JSON字符串转为字典，如果字符串不是合法的JSON格式，会报JSONDecodeError</li>
</ul>
<p><strong>字典转JSON字符串</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">dict_var = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;Cactus&#x27;</span>, </span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: <span class="number">18</span>, </span><br><span class="line">    <span class="string">&#x27;skills&#x27;</span>: [<span class="string">&#x27;Python&#x27;</span>, <span class="string">&#x27;Java&#x27;</span>, <span class="string">&#x27;Go&#x27;</span>, <span class="string">&#x27;NodeJS&#x27;</span>], </span><br><span class="line">    <span class="string">&#x27;has_blog&#x27;</span>: <span class="literal">True</span>, </span><br><span class="line">    <span class="string">&#x27;gf&#x27;</span>: <span class="literal">None</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(json.dumps(dict_var))</span><br><span class="line"><span class="built_in">print</span>(json.dumps(dict_var, indent=<span class="number">2</span>,sort_keys=<span class="literal">True</span>, ensure_ascii=<span class="literal">False</span>))</span><br></pre></td></tr></table></figure>

<p><strong>JSON字符串转字典</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">json_str = <span class="string">&#x27;&#x27;&#x27;&#123;</span></span><br><span class="line"><span class="string">    &quot;name&quot;: &quot;Cactus&quot;,</span></span><br><span class="line"><span class="string">    &quot;age&quot;: 18,</span></span><br><span class="line"><span class="string">    &quot;skills&quot;: [&quot;Python&quot;, &quot;Java&quot;, &quot;Go&quot;, &quot;NodeJS&quot;],</span></span><br><span class="line"><span class="string">    &quot;has_blog&quot;: true,</span></span><br><span class="line"><span class="string">    &quot;gf&quot;: null</span></span><br><span class="line"><span class="string">&#125;&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(json.loads(json_str))</span><br></pre></td></tr></table></figure>



<h5 id="JSON文件与字典的相互转换"><a href="#JSON文件与字典的相互转换" class="headerlink" title="JSON文件与字典的相互转换"></a>JSON文件与字典的相互转换</h5><p>将字典保存为JSON文件或从JSON文件转为字典</p>
<ul>
<li>json.dump(字典, f)：将字典转为JSON文件（句柄）</li>
<li>json.loads(f)：将打开的JSON文件句柄转为字典</li>
</ul>
<p><strong>字典转成JSON文件</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line">dict_var = &#123;</span><br><span class="line">    <span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;Cactus&#x27;</span>, </span><br><span class="line">    <span class="string">&#x27;age&#x27;</span>: <span class="number">18</span>, </span><br><span class="line">    <span class="string">&#x27;skills&#x27;</span>: [<span class="string">&#x27;Python&#x27;</span>, <span class="string">&#x27;Java&#x27;</span>, <span class="string">&#x27;Go&#x27;</span>, <span class="string">&#x27;NodeJS&#x27;</span>], </span><br><span class="line">    <span class="string">&#x27;has_blog&#x27;</span>: <span class="literal">True</span>, </span><br><span class="line">    <span class="string">&#x27;gf&#x27;</span>: <span class="literal">None</span></span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;demo2.json&quot;</span>, <span class="string">&quot;w&quot;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="comment"># json.dump(dict_var, f)  # 写为一行</span></span><br><span class="line">    json.dump(dict_var, f,indent=<span class="number">2</span>,sort_keys=<span class="literal">True</span>, ensure_ascii=<span class="literal">False</span>)  <span class="comment"># 写为多行</span></span><br></pre></td></tr></table></figure>

<p><strong>JSON文件转成字典</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;demo2.json&quot;</span>, encoding=<span class="string">&quot;utf-8&quot;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    data = json.load(f)</span><br><span class="line"></span><br><span class="line">pritn(data)</span><br></pre></td></tr></table></figure>

<p>!!! 字典转为JSON时，只支持嵌套字典、列表、字符串、数字、True&#x2F;False&#x2F;None等，不支持日期对象以及Python的其他对象<br>!!! 解析复杂嵌套JSON格式，请使用JSONPath</p>
<h4 id="YAML-文件"><a href="#YAML-文件" class="headerlink" title="YAML 文件"></a>YAML 文件</h4><p>​	YAML兼容JSON格式，简洁，强大，灵活，可以很方便的构造层级数据并快速转为Python中的字典。</p>
<h5 id="yaml简介"><a href="#yaml简介" class="headerlink" title="yaml简介"></a>yaml简介</h5><p>​		YAML（YAML Ain’t Markup Language）即一种反标记（XML）语言。强调数据为中心，而非标记。YAML大小写敏感，使用缩进代表层级关系。<br>​		YAML中支持对象Object(对应Python中的字典), 数组Array(对应Python中的列表)以及常量（字符串、数字（int&#x2F;float），true&#x2F;false&#x2F;null）。<br>​		相比于JSON格式，YAML免除了双引号，逗号，大括号，中括号等，（当然也支持原始的JSON格式），并且支持注释，类型转换，跨行，锚点，引用及插入等等。</p>
<h5 id="基本格式"><a href="#基本格式" class="headerlink" title="基本格式"></a>基本格式</h5><ul>
<li>对象：使用<code>key: value</code>表示，<strong>冒号后面有一个空格</strong>，也可以是使用<code>&#123;key: value&#125;</code>（flow流格式）或<code>&#123;&quot;key&quot;: &quot;value&quot;&#125;</code>表示</li>
<li>数组：使用<code>- value</code>表示，**-后面有一个空格**，每项一行，也可以使用<code>[value1,value2,value3,...]</code> （flow流格式）或<code>[&quot;value1&quot;, &quot;value2&quot;, &quot;value3&quot;, ...]</code></li>
<li>字符串：<code>abc</code>或<code>&quot;abc&quot;</code></li>
<li>数字：<code>123</code>或<code>123.45</code></li>
<li>true&#x2F;false：<code>true</code>&#x2F;<code>false</code>,<code>TRUE</code>&#x2F;<code>FALSE</code>,<code>True</code>&#x2F;<code>False</code>或<code>on</code>&#x2F;<code>off</code>, <code>ON</code>&#x2F;<code>OFF</code>, <code>On</code>&#x2F;<code>Off</code></li>
<li>null: <code>null</code>,<code>NULL</code>, <code>Null</code>或<code>~</code></li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 注释：示例yaml文件</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">Cactus</span></span><br><span class="line"><span class="attr">age:</span> <span class="number">18</span></span><br><span class="line"><span class="attr">skills:</span> </span><br><span class="line">  <span class="bullet">-</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Python</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">3</span></span><br><span class="line">  <span class="bullet">-</span></span><br><span class="line">    <span class="bullet">-</span> <span class="string">Java</span></span><br><span class="line">    <span class="bullet">-</span> <span class="number">5</span></span><br><span class="line"><span class="attr">has_blog:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">gf:</span> <span class="string">~</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">// 转译成json文件</span></span><br><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;Cactus&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">18</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;skills&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;Python&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">3</span></span><br><span class="line">    <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">[</span></span><br><span class="line">      <span class="string">&quot;Java&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="number">5</span></span><br><span class="line">    <span class="punctuation">]</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;has_blog&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">true</span></span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;gf&quot;</span><span class="punctuation">:</span> <span class="literal"><span class="keyword">null</span></span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h5 id="类型转换-1"><a href="#类型转换-1" class="headerlink" title="类型转换"></a>类型转换</h5><p>使用<code>!!str</code>, <code>!!float</code>等可以将默认类型转为指定类型</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="bullet">-</span> <span class="type">!!float</span> <span class="number">3</span></span><br><span class="line"><span class="bullet">-</span> <span class="type">!!str</span> <span class="number">4</span></span><br><span class="line"><span class="bullet">-</span> <span class="type">!!str</span> <span class="literal">true</span></span><br></pre></td></tr></table></figure>

<p>对应JSON格式</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">[</span></span><br><span class="line">  <span class="number">3.0</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;4&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="string">&quot;true&quot;</span></span><br><span class="line"><span class="punctuation">]</span></span><br></pre></td></tr></table></figure>





<h5 id="多行文本及拼接"><a href="#多行文本及拼接" class="headerlink" title="多行文本及拼接"></a>多行文本及拼接</h5><ul>
<li><code>|</code> 保留多行文本（保留换行符）</li>
<li><code>&gt;</code> 将多行拼接为一行</li>
</ul>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">a:</span> <span class="string">|</span></span><br><span class="line"><span class="string">  我</span></span><br><span class="line"><span class="string">  喜欢你</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="attr">b:</span> <span class="string">&gt;</span></span><br><span class="line"><span class="string">  我</span></span><br><span class="line"><span class="string">  不喜欢你</span></span><br><span class="line"><span class="string">  才怪</span></span><br></pre></td></tr></table></figure>

<p>对应JSON格式</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;a&quot;</span><span class="punctuation">:</span> <span class="string">&quot;我\n喜欢你\n&quot;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;b&quot;</span><span class="punctuation">:</span> <span class="string">&quot;我 不喜欢你 才怪&quot;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>



<h5 id="锚点，引用及插入"><a href="#锚点，引用及插入" class="headerlink" title="锚点，引用及插入"></a>锚点，引用及插入</h5><p>在<code>-</code>或<code>:</code>后 加上<code>&amp;锚点名</code>为当前字段建立锚点，下面可使用<code>*锚点名</code>引用锚点，或使用<code>&lt;&lt;: *锚点名</code>直接将锚点数据插入到当前的数据中，示例如下：</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="attr">users:</span></span><br><span class="line">  <span class="bullet">-</span> <span class="meta">&amp;zs</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">张三</span></span><br><span class="line">    <span class="attr">password:</span> <span class="type">!!str</span> <span class="number">123456</span></span><br><span class="line">  <span class="bullet">-</span> <span class="meta">&amp;ls</span></span><br><span class="line">    <span class="attr">name:</span> <span class="string">李四</span></span><br><span class="line">    <span class="attr">password:</span> <span class="string">abcdefg</span></span><br><span class="line"></span><br><span class="line"><span class="attr">case1:</span></span><br><span class="line">  <span class="attr">login:</span> <span class="meta">*zs</span></span><br><span class="line"></span><br><span class="line"><span class="attr">case2:</span></span><br><span class="line">  <span class="attr">user:</span></span><br><span class="line">    <span class="string">&lt;&lt;:</span> <span class="meta">*ls</span></span><br><span class="line">    <span class="attr">age:</span> <span class="number">20</span></span><br></pre></td></tr></table></figure>

<p>对应JSON格式：</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="punctuation">&#123;</span></span><br><span class="line">  <span class="attr">&quot;users&quot;</span><span class="punctuation">:</span> <span class="punctuation">[</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;张三&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;123456&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">    <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;李四&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;abcdefg&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">]</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;case1&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;login&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;张三&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;123456&quot;</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span><span class="punctuation">,</span></span><br><span class="line">  <span class="attr">&quot;case2&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">    <span class="attr">&quot;user&quot;</span><span class="punctuation">:</span> <span class="punctuation">&#123;</span></span><br><span class="line">      <span class="attr">&quot;name&quot;</span><span class="punctuation">:</span> <span class="string">&quot;李四&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;password&quot;</span><span class="punctuation">:</span> <span class="string">&quot;abcdefg&quot;</span><span class="punctuation">,</span></span><br><span class="line">      <span class="attr">&quot;age&quot;</span><span class="punctuation">:</span> <span class="number">20</span></span><br><span class="line">    <span class="punctuation">&#125;</span></span><br><span class="line">  <span class="punctuation">&#125;</span></span><br><span class="line"><span class="punctuation">&#125;</span></span><br></pre></td></tr></table></figure>





<h5 id="Python操作YAML文件及字符串"><a href="#Python操作YAML文件及字符串" class="headerlink" title="Python操作YAML文件及字符串"></a>Python操作YAML文件及字符串</h5><p>​		需要安装pyyaml， <code>pip install pyyaml</code></p>
<p>和JSON文件类似，yaml也提供load和dump两种方法。</p>
<ul>
<li><code>yaml.load()</code>或<code>yaml.safe_load(YAML字符串或文件句柄)</code>：yaml -&gt; 字典，如yaml中有中文，需要使用 <code>字符串.encode(&#39;utf-8&#39;)</code>或打开文件时指定<code>encoding=&#39;utf-8&#39;</code></li>
<li><code>yaml.dump(字典)</code>：默认为flow流格式，即字典<code>&#123;b&#39;: &#123;&#39;c&#39;: 3, &#39;d&#39;: 4&#125;&#125;</code>，会被转为<code>b: &#123;c: 3, d: 4&#125;</code>形式，可以使用<code>default_flow_style=False</code>关闭流模式</li>
</ul>
<p>由于<code>yaml.load()</code>支持原生Python对象，不安全，建议使用<code>yaml.safe_load()</code></p>
<h5 id="yaml-字符串-转成-字典"><a href="#yaml-字符串-转成-字典" class="headerlink" title="yaml 字符串 转成 字典"></a>yaml 字符串 转成 字典</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"><span class="comment"># yaml字符串</span></span><br><span class="line">yaml_str = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">name: Cactus</span></span><br><span class="line"><span class="string">age: 18</span></span><br><span class="line"><span class="string">skills: </span></span><br><span class="line"><span class="string">  -</span></span><br><span class="line"><span class="string">    - Python</span></span><br><span class="line"><span class="string">    - 3</span></span><br><span class="line"><span class="string">  -</span></span><br><span class="line"><span class="string">    - Java</span></span><br><span class="line"><span class="string">    - 5</span></span><br><span class="line"><span class="string">has_blog: true</span></span><br><span class="line"><span class="string">gf: ~</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="built_in">print</span>(yaml.safe_load(yaml_str)) </span><br><span class="line"><span class="comment"># 如果有中文，可以使用</span></span><br><span class="line">yaml.load(yaml_str.encoding(<span class="string">&#x27;utf-8&#x27;</span>))</span><br></pre></td></tr></table></figure>





<h5 id="yaml-文件转成字典"><a href="#yaml-文件转成字典" class="headerlink" title="yaml 文件转成字典"></a>yaml 文件转成字典</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;demo.yaml&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:   <span class="comment"># demo.yaml内容同上例yaml字符串 </span></span><br><span class="line">    <span class="built_in">print</span>(yaml.safe_load(f))</span><br></pre></td></tr></table></figure>



<h5 id="字典-转成-yaml字符串或文件"><a href="#字典-转成-yaml字符串或文件" class="headerlink" title="字典 转成 yaml字符串或文件"></a>字典 转成 yaml字符串或文件</h5><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line">dict_var = &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;Cactus&#x27;</span>, <span class="string">&#x27;age&#x27;</span>: <span class="number">18</span>, <span class="string">&#x27;skills&#x27;</span>: [[<span class="string">&#x27;Python&#x27;</span>, <span class="number">3</span>], [<span class="string">&#x27;Java&#x27;</span>, <span class="number">5</span>]], <span class="string">&#x27;has_blog&#x27;</span>: <span class="literal">True</span>, <span class="string">&#x27;gf&#x27;</span>: <span class="literal">None</span>&#125;</span><br><span class="line"><span class="built_in">print</span>(yaml.dump(dict_var,))  <span class="comment"># 转为字符串，使用默认flow流格式</span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;demo5.yaml&#x27;</span>, <span class="string">&#x27;w&#x27;</span>, encoding=<span class="string">&#x27;utf-8&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    yaml.dump(dict_var, f, default_flow_style=<span class="literal">False</span>)  <span class="comment"># 写入文件，不是用flow流格式</span></span><br></pre></td></tr></table></figure>

<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># demo5.yaml</span></span><br><span class="line"><span class="attr">age:</span> <span class="number">18</span></span><br><span class="line"><span class="attr">gf:</span> <span class="literal">null</span></span><br><span class="line"><span class="attr">has_blog:</span> <span class="literal">true</span></span><br><span class="line"><span class="attr">name:</span> <span class="string">Cactus</span></span><br><span class="line"><span class="attr">skills:</span></span><br><span class="line"><span class="bullet">-</span> <span class="bullet">-</span> <span class="string">Python</span></span><br><span class="line">  <span class="bullet">-</span> <span class="number">3</span></span><br><span class="line"><span class="bullet">-</span> <span class="bullet">-</span> <span class="string">Java</span></span><br><span class="line">  <span class="bullet">-</span> <span class="number">5</span></span><br></pre></td></tr></table></figure>



<h5 id="自定义tag"><a href="#自定义tag" class="headerlink" title="自定义tag"></a>自定义tag</h5><p>​		YAML常用于配置文件，当配置文件中需要配置一些用户名密码时，直接写在YAML文件并上传到代码仓库中则很容易造成密码泄露。</p>
<p>解决的方法有两种：</p>
<ol>
<li>配置文件仅本地使用，不传到代码仓库中</li>
<li>将密码配置到执行机器的环境变量中，在YAML中使用特殊标记表示读取一个环境变量 (推荐)</li>
</ol>
<p>在PyYAML中一种tag标识一种类型，常见的tag有：</p>
<table>
<thead>
<tr>
<th>!!null</th>
<th>None</th>
</tr>
</thead>
<tbody><tr>
<td>!!bool</td>
<td>bool</td>
</tr>
<tr>
<td>!!int</td>
<td>int</td>
</tr>
<tr>
<td>!!float</td>
<td>float</td>
</tr>
<tr>
<td>!!binary</td>
<td>bytes</td>
</tr>
<tr>
<td>!!timestamp</td>
<td>datetime.datetime</td>
</tr>
<tr>
<td>!!omap, !!pairs</td>
<td>list of pairs</td>
</tr>
<tr>
<td>!!set</td>
<td>set</td>
</tr>
<tr>
<td>!!str</td>
<td>str</td>
</tr>
<tr>
<td>!!seq</td>
<td>list</td>
</tr>
<tr>
<td>!!map</td>
<td>dict</td>
</tr>
</tbody></table>
<p>我们自定义一个新的tag, <code>!env</code>, 并编写一个对应的处理函数（PyYAML中称为constructor构造器），代码如下：<br>demo.yaml文件</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># demo.yml</span></span><br><span class="line"><span class="attr">user:</span> <span class="type">!env</span> <span class="string">$&#123;USER&#125;</span>  <span class="comment"># 表示环境变量USER，即当前用户名</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tag在python中使用</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> yaml  <span class="comment"># 需要pip install pyyaml</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">env_var_constructor</span>(<span class="params">loader, node</span>):</span><br><span class="line">    value = loader.construct_scalar(node)   <span class="comment"># PyYAML loader的固定方法，用于根据当前节点构造一个变量值</span></span><br><span class="line">    var_name = value.strip(<span class="string">&#x27;$&#123;&#125; &#x27;</span>)  <span class="comment"># 去除变量值（例如$&#123;USER&#125;）前后的特殊字符及空格</span></span><br><span class="line">    <span class="keyword">return</span> os.getenv(var_name, value)  <span class="comment"># 尝试在环境变量中获取变量名（如USER）对应的值，获取不到使用默认值value（即原来的$&#123;USER&#125;）</span></span><br><span class="line"></span><br><span class="line">yaml.SafeLoader.add_constructor(<span class="string">&#x27;!env&#x27;</span>, env_var_constructor)  <span class="comment"># 为SafeLoader添加新的tag和构造器</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;demo.yml&#x27;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">    <span class="built_in">print</span>(yaml.safe_load(f))  <span class="comment"># 打开文件并使用SafeLoader加载文件内容</span></span><br></pre></td></tr></table></figure>

<p><strong>为tag分配匹配模式</strong></p>
<p>此时YAML文件中环境变量只能使用强制类型声明<code>!env $&#123;变量名&#125;</code>来使用，如果想直接使用<code>$&#123;变量名&#125;</code>来使用则需要为该tag指定一种正则匹配模式，即识别到类似<code>$&#123;变量名&#125;</code>格式时自动使用!env这个tag。</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># demo.yml</span></span><br><span class="line"><span class="attr">user:</span> <span class="type">!env</span> <span class="string">$&#123;USER&#125;</span>  <span class="comment"># 表示环境变量USER，即当前用户名</span></span><br><span class="line"><span class="attr">path:</span> <span class="string">$&#123;PATH&#125;</span>  <span class="comment"># 期望可以直接使用</span></span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># tag在python中使用</span></span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">&#x27;\$&#123;\w+&#125;&#x27;</span>)  <span class="comment"># 匹配 $&#123;一个或多个字母或数字&#125;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">env_var_constructor</span>(<span class="params">loader, node</span>):</span><br><span class="line">    value = loader.construct_scalar(node)  </span><br><span class="line">    var_name = value.strip(<span class="string">&#x27;$&#123;&#125; &#x27;</span>)  </span><br><span class="line">    <span class="keyword">return</span> os.getenv(var_name, value)  </span><br><span class="line"></span><br><span class="line">yaml.SafeLoader.add_constructor(<span class="string">&#x27;!env&#x27;</span>, env_var_constructor)  <span class="comment"># 添加新tag即对应的构造器</span></span><br><span class="line">yaml.SafeLoader.add_implicit_resolver(<span class="string">&#x27;!env&#x27;</span>, pattern, <span class="literal">None</span>)    <span class="comment">#  为tag指定一种正则匹配</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;demo.yml&#x27;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">    <span class="built_in">print</span>(yaml.safe_load(f))  <span class="comment"># 打开文件并使用SafeLoader加载文件内容</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>一个节点使用多个变量</strong></p>
<p>如果我们想要在一个节点中使用多个变量，如</p>
<figure class="highlight yaml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># demo.yml</span></span><br><span class="line"><span class="attr">user:</span> <span class="type">!env</span> <span class="string">$&#123;USER&#125;</span></span><br><span class="line"><span class="attr">path:</span> <span class="string">$&#123;PATH&#125;</span></span><br><span class="line"><span class="attr">msg:</span> <span class="string">当前用户名</span> <span class="string">$&#123;USER&#125;</span> <span class="string">系统路径</span> <span class="string">$&#123;PATH&#125;</span></span><br></pre></td></tr></table></figure>

<p>则需要对节点值value(字符串格式)进行逐个替换。<br>首先我们需要修改我们的匹配模式，允许${变量}前后可以拥有多个任意字符</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="keyword">import</span> re</span><br><span class="line"><span class="keyword">import</span> yaml</span><br><span class="line"></span><br><span class="line">pattern = re.<span class="built_in">compile</span>(<span class="string">&#x27;.*?(\$&#123;\w+&#125;).*?&#x27;</span>)  <span class="comment"># 前后可以拥有多个任意字符，使用小括号分组只取当前变量$&#123;变量名&#125;内容，`?`表示非贪婪匹配。</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">env_var_constructor</span>(<span class="params">loader, node</span>):</span><br><span class="line">    value = loader.construct_scalar(node)</span><br><span class="line">    <span class="keyword">for</span> item <span class="keyword">in</span> pattern.findall(value):  <span class="comment"># 遍历所有匹配到到$&#123;变量名&#125;的变量, 如$&#123;USER&#125;</span></span><br><span class="line">        var_name = item.strip(<span class="string">&#x27;$&#123;&#125; &#x27;</span>)    <span class="comment"># 如,USER</span></span><br><span class="line">        value = value.replace(item, os.getenv(var_name, item))  <span class="comment"># 用环境变量中取到的对应值替换当前变量</span></span><br><span class="line">    <span class="keyword">return</span> value                                  <span class="comment"># 如superin替换$&#123;USER&#125;，取不到则使用原值$&#123;USER&#125;</span></span><br><span class="line"></span><br><span class="line">yaml.SafeLoader.add_constructor(<span class="string">&#x27;!env&#x27;</span>, env_var_constructor)</span><br><span class="line">yaml.SafeLoader.add_implicit_resolver(<span class="string">&#x27;!env&#x27;</span>, pattern, <span class="literal">None</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;demo.yml&#x27;</span>) <span class="keyword">as</span> f:</span><br><span class="line">    <span class="built_in">print</span>(yaml.safe_load(f))</span><br></pre></td></tr></table></figure>





<h4 id="Excel文件"><a href="#Excel文件" class="headerlink" title="Excel文件"></a>Excel文件</h4><p>Python中常用的操作Excel的三方包有xlrd,xlwt和openpyxl等</p>
<ul>
<li>xlrd支持读取.xls和.xlsx格式的Excel文件，只支持读取，不支持写入。</li>
<li>xlwt只支持写入.xls格式的文件，不支持读取。</li>
<li>openpyxl不支持.xls格式，但是支持.xlsx格式的读取写入，并且支持写入公式等。</li>
</ul>
<h5 id="读取数据"><a href="#读取数据" class="headerlink" title="读取数据"></a>读取数据</h5><h6 id="读取所有数据"><a href="#读取所有数据" class="headerlink" title="读取所有数据"></a>读取所有数据</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开excel</span></span><br><span class="line">excel = openpyxl.load_workbook(<span class="string">&#x27;apis.xlsx&#x27;</span>)  <span class="comment"># 有路径应带上路径</span></span><br><span class="line"><span class="comment"># 使用指定工作表</span></span><br><span class="line">sheet = excel.active  <span class="comment"># 当前激活的工作表</span></span><br><span class="line"><span class="comment"># sheet = excel.get_sheet_by_name(&#x27;Sheet1&#x27;)</span></span><br><span class="line"><span class="comment"># 读取所有数据</span></span><br><span class="line"><span class="built_in">print</span>(<span class="built_in">list</span>(sheet.values))  <span class="comment"># sheet.values 生成器</span></span><br><span class="line"><span class="built_in">print</span>(sheet.max_column)  <span class="comment"># 最大列数</span></span><br><span class="line"><span class="built_in">print</span>(sheet.max_row)  <span class="comment"># 最大行数</span></span><br></pre></td></tr></table></figure>



<h6 id="按行读取"><a href="#按行读取" class="headerlink" title="按行读取"></a>按行读取</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开excel</span></span><br><span class="line">excel = openpyxl.load_workbook(<span class="string">&#x27;apis.xlsx&#x27;</span>)  <span class="comment"># 有路径应带上路径</span></span><br><span class="line"><span class="comment"># 使用指定工作表</span></span><br><span class="line">sheet = excel.active  <span class="comment"># 当前激活的工作表</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 按行读取</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> sheet.iter_rows(min_row=<span class="number">1</span>, min_col=<span class="number">1</span>, max_col=<span class="number">3</span>, max_row=<span class="number">3</span>): </span><br><span class="line">    <span class="built_in">print</span>(row)</span><br><span class="line"><span class="comment"># 读取标题行</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> sheet.iter_rows(max_row=<span class="number">1</span>):</span><br><span class="line">    title_row = [cell.value <span class="keyword">for</span> cell <span class="keyword">in</span> row]</span><br><span class="line"><span class="built_in">print</span>(title_row)</span><br><span class="line"><span class="comment"># 读取标题行以外数据</span></span><br><span class="line"><span class="keyword">for</span> row <span class="keyword">in</span> sheet.iter_rows(min_row=<span class="number">2</span>):</span><br><span class="line">    row_data = [cell.value <span class="keyword">for</span> cell <span class="keyword">in</span> row]</span><br><span class="line">    <span class="built_in">print</span>(row_data)</span><br></pre></td></tr></table></figure>



<h6 id="读取单元格数据"><a href="#读取单元格数据" class="headerlink" title="读取单元格数据"></a>读取单元格数据</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开excel</span></span><br><span class="line">excel = openpyxl.load_workbook(<span class="string">&#x27;apis.xlsx&#x27;</span>)  <span class="comment"># 有路径应带上路径</span></span><br><span class="line"><span class="comment"># 使用指定工作表</span></span><br><span class="line">sheet = excel.active  <span class="comment"># 当前激活的工作表</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 读取单元格数据</span></span><br><span class="line"><span class="built_in">print</span>(sheet[<span class="string">&#x27;A1&#x27;</span>].value)</span><br><span class="line"><span class="built_in">print</span>(sheet.cell(<span class="number">1</span>,<span class="number">1</span>).value)  <span class="comment"># 索引从1开始</span></span><br></pre></td></tr></table></figure>



<h6 id="写入文件"><a href="#写入文件" class="headerlink" title="写入文件"></a>写入文件</h6><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> openpyxl</span><br><span class="line"></span><br><span class="line"><span class="comment"># 打开excel</span></span><br><span class="line">excel = openpyxl.load_workbook(<span class="string">&#x27;apis.xlsx&#x27;</span>)  <span class="comment"># 有路径应带上路径</span></span><br><span class="line"><span class="comment"># 使用指定工作表</span></span><br><span class="line">sheet = excel.active  <span class="comment"># 当前激活的工作表</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 写入单元格</span></span><br><span class="line">sheet[<span class="string">&#x27;F2&#x27;</span>] = <span class="string">&#x27;PASS&#x27;</span></span><br><span class="line">result_col = title_row.index(<span class="string">&#x27;result&#x27;</span>)+<span class="number">1</span>  <span class="comment"># &#x27;result&#x27;所在的列号</span></span><br><span class="line">sheet.cell(<span class="number">3</span>, result_col).value = <span class="string">&#x27;PASS&#x27;</span></span><br><span class="line"><span class="comment"># 整行写入</span></span><br><span class="line">new_row = [<span class="string">&#x27;post-xml接口&#x27;</span>, <span class="string">&#x27;post&#x27;</span>, <span class="string">&#x27;https://httpbin.org/post&#x27;</span>]</span><br><span class="line">sheet.append(new_row)</span><br><span class="line"><span class="comment"># 保存文件，也可覆盖原文件</span></span><br><span class="line">excel.save(<span class="string">&quot;apis2.xlsx&quot;</span>)</span><br></pre></td></tr></table></figure>



<h4 id="html文件"><a href="#html文件" class="headerlink" title="html文件"></a>html文件</h4><p>lxml支持HTML及XML，解析速度快，兼容性强。使用方式和ElementTree比较像。</p>
<h5 id="安装方法"><a href="#安装方法" class="headerlink" title="安装方法"></a>安装方法</h5><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install lxml</span><br></pre></td></tr></table></figure>



<h5 id="lxml节点对象常用方法："><a href="#lxml节点对象常用方法：" class="headerlink" title="lxml节点对象常用方法："></a>lxml节点对象常用方法：</h5><ul>
<li>xpath(): 使用XPath获取下级节点，结果为列表</li>
<li>text: 节点文本</li>
<li>itertext(): 迭代输出当前节点及下级所有节点文本，例如<code>&#39;&#39;.join(node.itertext())</code> 可以拿到节点中所有文本</li>
<li>attrib: 节点属性字典，如a节点 <code>node.attrib[&#39;href&#39;]</code>可以拿到其url</li>
</ul>
<h5 id="操作步骤"><a href="#操作步骤" class="headerlink" title="操作步骤"></a>操作步骤</h5><ul>
<li><p>第一步：使用etree.HTML()实例化得到根节点，实例化时会自动补全HTML代码</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> lxml <span class="keyword">import</span> etree</span><br><span class="line">html = <span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&lt;div id=&quot;content&quot;&gt;</span></span><br><span class="line"><span class="string">    &lt;ul&gt;</span></span><br><span class="line"><span class="string">        &lt;li id=&quot;top_001&quot; class=&quot;item&quot;&gt;肖申克的救赎&lt;li&gt;</span></span><br><span class="line"><span class="string">        &lt;li id=&quot;top_001&quot; class=&quot;item&quot;&gt;霸王别姬&lt;/li&gt;</span></span><br><span class="line"><span class="string">        &lt;li id=&quot;top_002&quot; class=&quot;item&quot;&gt;阿甘正传&lt;/li&gt;</span></span><br><span class="line"><span class="string">    &lt;/ul&gt;</span></span><br><span class="line"><span class="string">&lt;/div&gt;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">root = etree.HTML(html) </span><br></pre></td></tr></table></figure>
</li>
<li><p>第二步：使用root.xpath()查找节点</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">不同于xml.etree.ElementTree中只支持部分的XPath语法，root.xpath()中支持使用完整的XPath语法，路径不需要使用“.”开始，root.xpath()方法返回查找到的所有节点列表</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">root.xpath(<span class="string">&#x27;/html/body/div&#x27;</span>)：绝对路径查找</span><br><span class="line">root.xpath(<span class="string">&#x27;//ul/li[2]&#x27;</span>) ：相对路径，结合索引</span><br><span class="line">root.xpath(<span class="string">&#x27;//div[@id=&quot;content&quot;]&#x27;</span>)：结合属性查找</span><br><span class="line">root.xpath(<span class="string">&#x27;//li[@id=&quot;top_001&quot; and @class=&quot;item&quot;]&#x27;</span>)：多条件查找</span><br><span class="line">root.xpath(<span class="string">&#x27;//li[text()=&quot;阿甘正传&quot;]&#x27;</span>)：使用text()函数根据元素文本查找</span><br><span class="line">root.xpath(<span class="string">&#x27;//li[contains(text(), &quot;阿甘&quot;)]&#x27;</span>)：使用contains函数查找文本包含</span><br><span class="line">root.xpath(<span class="string">&#x27;//li[1]/following-sibling::li&#x27;</span>)：使用XPath的轴方法获取后面所有的同级元素</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">如果想要获取节点是属性或文本等，可以从返回的节点列表中取出节点，并使用.tag、.text或.attrib获取节点的标签、文本或属性字典，也可以直接在XPath语句中使用/@attribute或/text来获取属性</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">div = root.xpath(<span class="string">&#x27;//div&#x27;</span>)[<span class="number">0</span>] </span><br><span class="line"><span class="built_in">print</span>(div.attrib)</span><br><span class="line"><span class="built_in">print</span>(root.xpath(<span class="string">&#x27;//div/@id&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(root.xpath(<span class="string">&#x27;//ul/li[last()]/text()&#x27;</span>))</span><br><span class="line"></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">由于root.xpath()方法返回节点列表，这里去第一个元素，并打印其属性字典。第三行直接使用XPath表达式取相应节点的id属性，返回属性列表。第四行使用XPath表达式text()函数取节点的文本，返回文本列表</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line">&#123;<span class="string">&#x27;id&#x27;</span>: <span class="string">&#x27;content&#x27;</span>&#125;</span><br><span class="line">[<span class="string">&#x27;content&#x27;</span>]</span><br><span class="line">[<span class="string">&#x27;阿甘正传&#x27;</span>]</span><br><span class="line"></span><br></pre></td></tr></table></figure></li>
</ul>
<h2 id="StringIO和BytesIO"><a href="#StringIO和BytesIO" class="headerlink" title="StringIO和BytesIO"></a>StringIO和BytesIO</h2><h3 id="StringIO"><a href="#StringIO" class="headerlink" title="StringIO"></a>StringIO</h3><p>数据读写不一定是文件，也可以在内存中读写;<br><code>StringIO</code>顾名思义就是在内存中读写<code>str</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> StringIO</span><br><span class="line">f = StringIO() <span class="comment"># 创建 StringIO</span></span><br><span class="line">f.write(<span class="string">&#x27;hello&#x27;</span>) <span class="comment"># 返回写入的长度： 5</span></span><br><span class="line">f.write(<span class="string">&#x27; &#x27;</span>)</span><br><span class="line">f.write(<span class="string">&#x27;world!&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(f.getvalue()) <span class="comment"># 通过 getvalue() 方法读取f的值</span></span><br><span class="line">hello world!</span><br></pre></td></tr></table></figure>

<h3 id="BytesIO"><a href="#BytesIO" class="headerlink" title="BytesIO"></a>BytesIO</h3><p><code>StringIO</code>操作的只能是<code>str</code>，如果要操作二进制数据，就需要使用<code>BytesIO</code></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> io <span class="keyword">import</span> BytesIO</span><br><span class="line">f = BytesIO()</span><br><span class="line"><span class="comment"># 写入的不是str，而是经过UTF-8编码的bytes</span></span><br><span class="line">f.write(<span class="string">&#x27;中文&#x27;</span>.encode(<span class="string">&#x27;utf-8&#x27;</span>)) <span class="comment"># 返回写入的长度 6</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f.getvalue())</span><br><span class="line"><span class="comment">#  b&#x27;\xe4\xb8\xad\xe6\x96\x87&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="os-文件及目录操作"><a href="#os-文件及目录操作" class="headerlink" title="os 文件及目录操作"></a>os 文件及目录操作</h2><h3 id="os-name"><a href="#os-name" class="headerlink" title="os.name"></a>os.name</h3><p>通过name的值可以判断是什么系统<br>如果是<code>posix</code>，说明系统是<code>Linux</code>、<code>Unix</code>或<code>Mac OS X</code>，如果是<code>nt</code>，就是<code>Windows</code>系统。<br>详细信息可以使用 os.uname()</p>
<h3 id="环境变量-os-environ"><a href="#环境变量-os-environ" class="headerlink" title="环境变量 - os.environ"></a>环境变量 - os.environ</h3><p>在操作系统中定义的环境变量，全部保存在<code>os.environ</code>这个变量中, 要获取某个环境变量的值，可以调用<code>os.environ.get(&#39;key&#39;)</code></p>
<h3 id="操作文件和目录"><a href="#操作文件和目录" class="headerlink" title="操作文件和目录"></a>操作文件和目录</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os</span><br><span class="line"><span class="comment"># 查看当前目录的绝对路径:</span></span><br><span class="line">os.path.abspath(<span class="string">&#x27;.&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取当前模块的文件名</span></span><br><span class="line"><span class="built_in">print</span>(__file__)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取命令行参数</span></span><br><span class="line"><span class="keyword">import</span> sys</span><br><span class="line"><span class="built_in">print</span>(sys.argv)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 合并路径</span></span><br><span class="line">os.path.join(<span class="string">&#x27;/Users/michael&#x27;</span>, <span class="string">&#x27;testdir&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个目录</span></span><br><span class="line">os.mkdir(<span class="string">&#x27;/Users/michael/testdir&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删掉一个目录:</span></span><br><span class="line">os.rmdir(<span class="string">&#x27;/Users/michael/testdir&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 拆分路径</span></span><br><span class="line">os.path.split(<span class="string">&#x27;/Users/michael/testdir/file.txt&#x27;</span>)</span><br><span class="line"><span class="comment"># (&#x27;/Users/michael/testdir&#x27;, &#x27;file.txt&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 得到文件扩展名</span></span><br><span class="line">os.path.splitext(<span class="string">&#x27;/path/to/file.txt&#x27;</span>)</span><br><span class="line"><span class="comment"># (&#x27;/path/to/file&#x27;, &#x27;.txt&#x27;)</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件重命名</span></span><br><span class="line">os.rename(<span class="string">&#x27;test.txt&#x27;</span>, <span class="string">&#x27;test.py&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 删掉文件</span></span><br><span class="line">os.remove(<span class="string">&#x27;test.py&#x27;</span>)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 文件复制</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">`shutil`模块提供了`copyfile()`的复制函数，你还可以在`shutil`模块中找到很多实用函数，它们可以看做是`os`模块的补充。</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">import</span> shutil  </span><br><span class="line">	<span class="comment"># 源文件路径  </span></span><br><span class="line">source_file = <span class="string">&#x27;path/to/source/file.txt&#x27;</span>  </span><br><span class="line">	<span class="comment"># 目标文件路径  </span></span><br><span class="line">destination_file = <span class="string">&#x27;path/to/destination/file.txt&#x27;</span>  </span><br><span class="line">	<span class="comment"># 复制文件  </span></span><br><span class="line">shutil.copy(source_file, destination_file)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取文件路径下的所有文件</span></span><br><span class="line">	<span class="comment"># 指定要遍历的文件夹路径  </span></span><br><span class="line">folder_path = <span class="string">&#x27;path/to/your/folder&#x27;</span>  </span><br><span class="line"></span><br><span class="line">	<span class="comment"># 获取指定目录下所有的文件  </span></span><br><span class="line">files_in_folder = [f <span class="keyword">for</span> f <span class="keyword">in</span> os.listdir(folder_path) <span class="keyword">if</span> os.path.isfile(os.path.join(folder_path, f))]  </span><br><span class="line"></span><br><span class="line">	<span class="comment"># 打印输出所有文件名  </span></span><br><span class="line"><span class="keyword">for</span> file_name <span class="keyword">in</span> files_in_folder:  </span><br><span class="line">    <span class="built_in">print</span>(file_name)  </span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment"># 获取目录和子目录</span></span><br><span class="line">	<span class="comment"># 指定要遍历的根路径  </span></span><br><span class="line">root_folder = <span class="string">&#x27;path/to/your/folder&#x27;</span>  </span><br><span class="line"></span><br><span class="line">	<span class="comment"># 使用os.walk()遍历根路径以及其子路径，并打印每个找到项  </span></span><br><span class="line"><span class="keyword">for</span> folder_path, folders, files <span class="keyword">in</span> os.walk(root_folder):  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;当前所在位置: <span class="subst">&#123;folder_path&#125;</span>&#x27;</span>)  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;包含以下子目录：&#x27;</span>)  </span><br><span class="line">    <span class="keyword">for</span> folder <span class="keyword">in</span> folders:  </span><br><span class="line">        <span class="built_in">print</span>(os.path.join(folder_path, folder))</span><br><span class="line">        </span><br><span class="line">        </span><br><span class="line"><span class="comment"># 获取整个树结构</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">list_files</span>(<span class="params">startpath</span>):  </span><br><span class="line">    <span class="keyword">for</span> root, dirs, files <span class="keyword">in</span> os.walk(startpath):  </span><br><span class="line">        level = root.replace(startpath, <span class="string">&#x27;&#x27;</span>).count(os.sep)  </span><br><span class="line">        indent = <span class="string">&#x27; &#x27;</span> * <span class="number">4</span> * (level)  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;&#123;&#125;&#123;&#125;/&#x27;</span>.<span class="built_in">format</span>(indent, os.path.basename(root)))  </span><br><span class="line">        subindent = <span class="string">&#x27; &#x27;</span> * <span class="number">4</span> * (level + <span class="number">1</span>)  </span><br><span class="line">        <span class="keyword">for</span> f <span class="keyword">in</span> files:  </span><br><span class="line">            <span class="built_in">print</span>(<span class="string">&#x27;&#123;&#125;&#123;&#125;&#x27;</span>.<span class="built_in">format</span>(subindent, f))  </span><br><span class="line"></span><br><span class="line"></span><br><span class="line">root_folder = <span class="string">&#x27;path/to/your/folder&#x27;</span>  </span><br><span class="line">list_files(root_folder)  </span><br></pre></td></tr></table></figure>



<h2 id="序列化"><a href="#序列化" class="headerlink" title="序列化"></a>序列化</h2><p>在程序运行的过程中，所有的变量都是在内存中<br>把变量从内存中变成可存储或传输的过程称之为序列化<br>序列化之后，就可以把序列化后的内容写入磁盘，或者通过网络传输到别的机器上。<br>反过来，把变量内容从序列化的对象重新读到内存里称之为反序列化</p>
<p>Python提供了<code>pickle</code>模块来实现序列化。</p>
<p><strong>序列化</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle  </span><br><span class="line">d = <span class="built_in">dict</span>(name=<span class="string">&#x27;Bob&#x27;</span>, age=<span class="number">20</span>, score=<span class="number">88</span>)  </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data.pickle&#x27;</span>, <span class="string">&#x27;wb&#x27;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">    pickle.dump(d, f)</span><br></pre></td></tr></table></figure>

<p><strong>反序列化</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> pickle  </span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&#x27;data.pickle&#x27;</span>, <span class="string">&#x27;rb&#x27;</span>) <span class="keyword">as</span> f:  </span><br><span class="line">    d = pickle.load(f)  </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(d)  <span class="comment"># Output: &#123;&#x27;name&#x27;: &#x27;Bob&#x27;, &#x27;age&#x27;: 20, &#x27;score&#x27;: 88&#125;</span></span><br></pre></td></tr></table></figure>

<h3 id="JSON处理"><a href="#JSON处理" class="headerlink" title="JSON处理"></a>JSON处理</h3><p>如果我们要在不同的编程语言之间传递对象，就必须把对象序列化为标准格式，例如XML，JSON</p>
<table>
<thead>
<tr>
<th>JSON类型</th>
<th>Python类型</th>
</tr>
</thead>
<tbody><tr>
<td>{}</td>
<td>dict</td>
</tr>
<tr>
<td>[]</td>
<td>list</td>
</tr>
<tr>
<td>“string”</td>
<td>str</td>
</tr>
<tr>
<td>1234.56</td>
<td>int或float</td>
</tr>
<tr>
<td>true&#x2F;false</td>
<td>True&#x2F;False</td>
</tr>
<tr>
<td>null</td>
<td>None</td>
</tr>
</tbody></table>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json  </span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MyClass</span>:  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, age</span>):  </span><br><span class="line">        self.name = name  </span><br><span class="line">        self.age = age  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建类的实例  </span></span><br><span class="line">my_object = MyClass(<span class="string">&quot;John&quot;</span>, <span class="number">25</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 将类实例转换为JSON字符串  </span></span><br><span class="line">json_string = json.dumps(my_object.__dict__)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 将JSON字符串序列化到文件中  </span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;data.json&quot;</span>, <span class="string">&quot;w&quot;</span>) <span class="keyword">as</span> file:  </span><br><span class="line">    json.dump(json_string, file)</span><br></pre></td></tr></table></figure>

<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> json  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 从JSON文件中读取数据  </span></span><br><span class="line"><span class="keyword">with</span> <span class="built_in">open</span>(<span class="string">&quot;data.json&quot;</span>, <span class="string">&quot;r&quot;</span>) <span class="keyword">as</span> file:  </span><br><span class="line">    json_string = json.load(file)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 将JSON字符串转换为Python对象  </span></span><br><span class="line">my_object = json.loads(json_string)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 打印Python对象的属性  </span></span><br><span class="line"><span class="built_in">print</span>(my_object[<span class="string">&quot;name&quot;</span>])  </span><br><span class="line"><span class="built_in">print</span>(my_object[<span class="string">&quot;age&quot;</span>])</span><br></pre></td></tr></table></figure>



<h2 id="异常处理"><a href="#异常处理" class="headerlink" title="异常处理"></a>异常处理</h2><h3 id="try…-except"><a href="#try…-except" class="headerlink" title="try… except"></a>try… except</h3><p>一般情况下，异常会导致程序中断退出，为避免程序中断，我们需要对异常进行处理，在Python中我们使用<code>try ... except ...</code>语句处理异常</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">div</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> a / b</span><br><span class="line">    <span class="comment"># 使用Exception代表任何异常, as ex是对异常添加别名，ex就是具体的异常对象</span></span><br><span class="line">    <span class="keyword">except</span> Exception <span class="keyword">as</span> ex:</span><br><span class="line">       <span class="built_in">print</span>(<span class="string">&#x27;出现异常&#x27;</span>, <span class="built_in">type</span>(ex), ex)</span><br><span class="line">       </span><br><span class="line">div(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">div(<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>一般来说，建议对不同类型的异常进行单独处理</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">div</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        <span class="keyword">return</span> a / b</span><br><span class="line">    <span class="keyword">except</span> ZeroDivisionError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;被除数b不能为0&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> TypeError:</span><br><span class="line">       <span class="built_in">print</span>(<span class="string">&#x27;类型错误a和b应为数字&#x27;</span>)</span><br><span class="line">       </span><br><span class="line">div(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">div(<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>)</span><br></pre></td></tr></table></figure>

<p>except也可以一次捕获多个异常，对任意一种异常做同一处理，例如<code>try: ... except: (ZeroDivisionError, TypeError): ...</code></p>
<h3 id="无异常及无论是否有异常都执行的操作"><a href="#无异常及无论是否有异常都执行的操作" class="headerlink" title="无异常及无论是否有异常都执行的操作"></a>无异常及无论是否有异常都执行的操作</h3><p>异常处理支持使用<code>try: ... except: ...</code>后使用<code>else: ...</code>在无异常时执行某些操作，及使用<code>finally: ...</code>，无论是否有异常都执行某些语句</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">div</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">try</span>:</span><br><span class="line">        c = a / b</span><br><span class="line">    <span class="keyword">except</span> ZeroDivisionError:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;被除数b不能为0&#x27;</span>)</span><br><span class="line">    <span class="keyword">except</span> TypeError:</span><br><span class="line">       <span class="built_in">print</span>(<span class="string">&#x27;类型错误a和b应为数字&#x27;</span>)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;结果为&#x27;</span>, c)</span><br><span class="line">        <span class="keyword">return</span> c</span><br><span class="line">    <span class="keyword">finally</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;执行结束...&#x27;</span>)</span><br><span class="line">     </span><br><span class="line">div(<span class="number">4</span>, <span class="number">2</span>)</span><br><span class="line">div(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">div(<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">结果为 2.0</span></span><br><span class="line"><span class="string">执行结束...</span></span><br><span class="line"><span class="string">被除数b不能为0</span></span><br><span class="line"><span class="string">执行结束...</span></span><br><span class="line"><span class="string">类型错误a和b应为数字</span></span><br><span class="line"><span class="string">执行结束...</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="Python中常见异常"><a href="#Python中常见异常" class="headerlink" title="Python中常见异常"></a>Python中常见异常</h3><table>
<thead>
<tr>
<th>异常类型</th>
<th>说明</th>
<th>示例</th>
</tr>
</thead>
<tbody><tr>
<td>SyntaxError</td>
<td>Python语法异常(缩紧或语法错误)</td>
<td>int a &#x3D; 1</td>
</tr>
<tr>
<td>NameError</td>
<td>变量名异常(不存在该变量名)</td>
<td>print(a)</td>
</tr>
<tr>
<td>TypeError</td>
<td>变量类型异常</td>
<td>print(‘a’&#x2F; ‘b’)</td>
</tr>
<tr>
<td>ValueError</td>
<td>值异常(变量值异常)</td>
<td>int(‘a’)</td>
</tr>
<tr>
<td>ZeroDivisionError</td>
<td>0除异常(被除数不能为0)</td>
<td>10&#x2F;0</td>
</tr>
<tr>
<td>IndexError</td>
<td>索引异常(列表等中不存在该索引对应的值)</td>
<td>s &#x3D; [‘a’, ‘b’, ‘c’] ; print(s[5])</td>
</tr>
<tr>
<td>KeyError</td>
<td>键异常(字典中不存在这个Key对应的值)</td>
<td>s &#x3D; {‘a’:1, ‘b’:2, ‘c’:3} ; print(s[‘d’])</td>
</tr>
<tr>
<td>AttributeError</td>
<td>获取属性异常(对象没有该属性)</td>
<td>a &#x3D; ‘hello’; print(a.name)</td>
</tr>
<tr>
<td>AssertionError</td>
<td>断言异常(断言未通过)</td>
<td>assert 1&gt;2</td>
</tr>
<tr>
<td>FileNotFoundError</td>
<td>文件不存在</td>
<td>open(‘abc.txt’)</td>
</tr>
<tr>
<td>OSError</td>
<td>操作系统错误</td>
<td>os.mkdirs(‘&#x2F;ddd&#x2F;xxx’)</td>
</tr>
</tbody></table>
<h3 id="主动抛出异常"><a href="#主动抛出异常" class="headerlink" title="主动抛出异常"></a>主动抛出异常</h3><p>在编写程序中不一定要捕获并处理（抑制）所有异常，有时候快速抛出异常并清楚的说明原因也是一种比较好的使用方式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">div</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(a, (<span class="built_in">int</span>, <span class="built_in">float</span>)) <span class="keyword">or</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(b, (<span class="built_in">int</span>, <span class="built_in">float</span>)):</span><br><span class="line">        <span class="comment"># 使用raise排除异常，终止程序</span></span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&#x27;a和b必须为int或float类型&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> ValueError(<span class="string">&#x27;被除数b不能为0&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> a / b</span><br><span class="line"></span><br><span class="line">div(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">div(<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>也可以自定义异常类型进行抛出，以使的错误类型更清晰</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">NotNumberError</span>(<span class="title class_ inherited__">Exception</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;非数字异常&quot;&quot;&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">CannotBeZeroError</span>(<span class="title class_ inherited__">Exception</span>):</span><br><span class="line">    <span class="string">&quot;&quot;&quot;不能为0异常&quot;&quot;&quot;</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">def</span> <span class="title function_">div</span>(<span class="params">a, b</span>):</span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(a, (<span class="built_in">int</span>, <span class="built_in">float</span>)) <span class="keyword">or</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(b, (<span class="built_in">int</span>, <span class="built_in">float</span>)):</span><br><span class="line">        <span class="keyword">raise</span> NotNumberError(<span class="string">&#x27;a和b必须为int或float类型&#x27;</span>)</span><br><span class="line">    <span class="keyword">if</span> b == <span class="number">0</span>:</span><br><span class="line">        <span class="keyword">raise</span> CannotBeZeroError(<span class="string">&#x27;被除数b不能为0&#x27;</span>)</span><br><span class="line">    <span class="keyword">return</span> a / b</span><br><span class="line"></span><br><span class="line">div(<span class="number">1</span>, <span class="number">0</span>)</span><br><span class="line">div(<span class="number">1</span>, <span class="string">&#x27;a&#x27;</span>)</span><br></pre></td></tr></table></figure>





<h2 id="装饰器-1"><a href="#装饰器-1" class="headerlink" title="装饰器"></a>装饰器</h2><p>装饰器是Python中的一个重要概念，多用于在不修改原函数的基础上，为函数增加额外的功能</p>
<h3 id="基础装饰器"><a href="#基础装饰器" class="headerlink" title="基础装饰器"></a>基础装饰器</h3><p>案例： 你要喝水</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">DrinkWater</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; 喝水(动作) &quot;</span>)</span><br><span class="line">DrinkWater()</span><br></pre></td></tr></table></figure>

<p>但你杯子里没水了，你还需要往杯子里装水</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">drinkWater</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; 喝水(动作) &quot;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 装水</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fillWater</span>(<span class="params">fn</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; 往杯子倒水 &quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> drinkWater</span><br><span class="line"></span><br><span class="line">drinkWater = fillWater(drinkWater)</span><br><span class="line"></span><br><span class="line">drinkWater()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">print 打印：</span></span><br><span class="line"><span class="string">往杯子倒水</span></span><br><span class="line"><span class="string">喝水(动作)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">fillWater 便是一个装饰器，它的参数是一个函数对象，同数字、字符串、列表、字典等数据类型一样，函数和类也可以作为函数的参数使用</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>

<p>装饰器本质上就是以函数作为参数，对函数做一些处理，并替换原函数的一种高阶函数。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 装水</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">fillWater</span>(<span class="params">fn</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; 往杯子倒水 &quot;</span>)</span><br><span class="line">    <span class="keyword">return</span> drinkWater</span><br><span class="line"></span><br><span class="line"><span class="meta">@fillWater  </span><span class="comment"># 挂载装饰器，会自动替换原函数, 我们只需要执行原函数就行</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">drinkWater</span>():</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&quot; 喝水(动作) &quot;</span>)</span><br><span class="line">    </span><br><span class="line">drinkWater() <span class="comment"># 这里的drinkWater() 实际就是装饰后的drinkWater() == fillWater(drinkWater)</span></span><br></pre></td></tr></table></figure>



<h3 id="装饰器处理函数参数"><a href="#装饰器处理函数参数" class="headerlink" title="装饰器处理函数参数"></a>装饰器处理函数参数</h3><p>如果需要给喝水加入一个参数，控制喝几口水</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fillWater</span>(<span class="params">fn</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">new_gift</span>(<span class="params">item</span>):  <span class="comment"># 准备一个新的函数，跟drinkWater()一样传递一个数字</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot; 往杯子倒水 &quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> drinkWater(item)  <span class="comment"># 调用原函数，保证原函数的输出，并return结果出去</span></span><br><span class="line">    <span class="keyword">return</span> new_gift   <span class="comment"># 返回新的喝水函数，包装了倒水动作的新喝水函数</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@fillWater</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">drinkWater</span>(<span class="params">item</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;喝<span class="subst">&#123;item&#125;</span>口水&#x27;</span>)</span><br><span class="line"></span><br><span class="line">drinkWater(<span class="number">2</span>)   <span class="comment"># 通过传递参数喝几口水</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h3 id="带参装饰器"><a href="#带参装饰器" class="headerlink" title="带参装饰器"></a>带参装饰器</h3><p>如果给杯子倒水也加上倒多少毫升，通过装饰器传递多少毫升</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fillWater</span>(<span class="params">ms</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">new_gift</span>(<span class="params">item</span>):  <span class="comment"># 准备一个新的函数，跟drinkWater()一样传递一个数字</span></span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot; 往杯子倒<span class="subst">&#123;ms&#125;</span>毫升水 &quot;</span>)</span><br><span class="line">        <span class="keyword">return</span> drinkWater(item)  <span class="comment"># 调用原函数，保证原函数的输出，并return结果出去</span></span><br><span class="line">    <span class="keyword">return</span> new_gift   <span class="comment"># 返回新的喝水函数，包装了倒水动作的新喝水函数</span></span><br><span class="line"></span><br><span class="line"><span class="meta">@fillWater(<span class="params"><span class="number">500</span></span>)</span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">drinkWater</span>(<span class="params">item</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&#x27;喝<span class="subst">&#123;item&#125;</span>口水&#x27;</span>)</span><br><span class="line"></span><br><span class="line">drinkWater(<span class="number">2</span>)   <span class="comment"># 通过传递参数喝几口水</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>!!! 装饰器在导入模块时立即计算的，即没调用<code>drinkWater()</code>之前就已经执行生成定制后的new_gift</p>
<h2 id="生成器和迭代器"><a href="#生成器和迭代器" class="headerlink" title="生成器和迭代器"></a>生成器和迭代器</h2><h3 id="可迭代对象"><a href="#可迭代对象" class="headerlink" title="可迭代对象"></a>可迭代对象</h3><p>​	实现了__iter__方法, __iter__方法返回一个迭代器</p>
<h3 id="迭代器"><a href="#迭代器" class="headerlink" title="迭代器"></a>迭代器</h3><p>​	按标准的迭代协议实现__iter__和__next__方法,StopIteration结束</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">A</span>:</span><br><span class="line">    start = <span class="number">0</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__iter__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__next__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">if</span> self.start &gt; <span class="number">10</span>:</span><br><span class="line">            <span class="keyword">raise</span> StopIteration</span><br><span class="line">        self.start += <span class="number">1</span></span><br><span class="line">        <span class="keyword">return</span> self.start</span><br></pre></td></tr></table></figure>

<h3 id="生成器"><a href="#生成器" class="headerlink" title="生成器"></a>生成器</h3><p>​	内部实现了迭代器的一种函数,通过yield记录当前位置并返回一次迭代结果</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">fib</span>(<span class="params"><span class="built_in">max</span></span>):</span><br><span class="line">    n, a, b = <span class="number">0</span>, <span class="number">0</span>, <span class="number">1</span></span><br><span class="line">    <span class="keyword">while</span> n &lt; <span class="built_in">max</span>:</span><br><span class="line">        <span class="built_in">print</span>(b)</span><br><span class="line">        a, b = b, a + b</span><br><span class="line">        n = n + <span class="number">1</span></span><br><span class="line">    <span class="keyword">return</span> <span class="string">&#x27;done&#x27;</span></span><br></pre></td></tr></table></figure>



<h3 id="列表推导式"><a href="#列表推导式" class="headerlink" title="列表推导式"></a>列表推导式</h3><p>!!! 推倒式：当我们对一批可迭代的数据（如列表或字典）进行提取或处理，最后要得到一个新的列表或字典时，推导式是一种非常简洁的表达方式。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line">data = [</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">12</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;female&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">10</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;王五&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">20</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;赵六&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">11</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;周七&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;female&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">16</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;孙八&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">13</span>&#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line">names = []  <span class="comment"># 定义一个空列表</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用for循环</span></span><br><span class="line"><span class="keyword">for</span> item <span class="keyword">in</span> data:  <span class="comment"># 遍历数据</span></span><br><span class="line">    name = item[<span class="string">&#x27;name&#x27;</span>]  <span class="comment"># 提取每行中的name</span></span><br><span class="line">    names.append(name)  <span class="comment"># 追加到列表中</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 用推导式</span></span><br><span class="line">names = [item[<span class="string">&#x27;name&#x27;</span>] <span class="keyword">for</span> item <span class="keyword">in</span> data]     <span class="comment"># 遍历data，提取每项中的name生成一个新列表</span></span><br><span class="line"><span class="comment"># 在提取数据时，我们还可以对每一项数据进行</span></span><br><span class="line">names = [<span class="string">&#x27;姓名: &#x27;</span>+item[<span class="string">&#x27;name&#x27;</span>] <span class="keyword">for</span> item <span class="keyword">in</span> data]</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p><strong>多重循环</strong></p>
<p>推导式还支持多重循环</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">5</span>)</span><br><span class="line">    <span class="keyword">if</span> x &gt; <span class="number">2</span></span><br><span class="line">        <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">4</span>)</span><br><span class="line">            <span class="keyword">if</span> y &lt; <span class="number">3</span></span><br><span class="line">                x*y</span><br><span class="line"></span><br><span class="line"><span class="comment"># 用推导式</span></span><br><span class="line">[x*y <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">5</span>) <span class="keyword">if</span> x &gt; <span class="number">2</span> <span class="keyword">for</span> y <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">1</span>,<span class="number">4</span>) <span class="keyword">if</span> y &lt; <span class="number">3</span>]</span><br></pre></td></tr></table></figure>



<p><strong>批量执行操作</strong></p>
<p>推导式就是一种循环操作，我们也可以使用推导式来批量执行一些相似操作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">def</span> <span class="title function_">step1</span>(<span class="params">driver</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;步骤1)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">def step2(driver):</span></span><br><span class="line"><span class="string">    print(&#x27;</span>步骤<span class="number">2</span>)</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">step3</span>(<span class="params">driver</span>):</span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;步骤3)</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string"># 用推导式实现</span></span><br><span class="line"><span class="string"># 我们可以将函数名放到一个列表里，然后使用推导式循环执行</span></span><br><span class="line"><span class="string">steps = [step1, step2, step3]   # 函数名列表</span></span><br><span class="line"><span class="string"></span></span><br><span class="line"><span class="string">[step(driver) for step in steps]  # 不需要变量接收，我们只需要它循环执行</span></span><br></pre></td></tr></table></figure>



<h3 id="字典推导式"><a href="#字典推导式" class="headerlink" title="字典推导式"></a>字典推导式</h3><p>当我们需要遍历一批数据最后得到一个字典时，同样可以使用字典推导式</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">data = [</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">12</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;female&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">10</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;王五&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">20</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;赵六&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">11</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;周七&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;female&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">16</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;孙八&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">13</span>&#125;,</span><br><span class="line">]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用字典推导式</span></span><br><span class="line">persons = &#123;item[<span class="string">&#x27;name&#x27;</span>]: item[<span class="string">&#x27;age&#x27;</span>] <span class="keyword">for</span> item <span class="keyword">in</span> data&#125;</span><br></pre></td></tr></table></figure>



<h3 id="生成器-1"><a href="#生成器-1" class="headerlink" title="生成器"></a>生成器</h3><p>生成器实际上是一种包含初始数据和推导法则的对象</p>
<p>对应大量的数据或者CSV&#x2F;Excel文件中的数据，生成器可以大量的节省内存，比如csv.Reader(f)就是一个生成器，只存了当前位置和读取下一行数据的方法；当你需要遍历时，它再每次给你读取一行数据给你</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line">data = [</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;张三&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">12</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;李四&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;female&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">10</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;王五&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">20</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;赵六&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">11</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;周七&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;female&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">16</span>&#125;,</span><br><span class="line">    &#123;<span class="string">&#x27;name&#x27;</span>: <span class="string">&#x27;孙八&#x27;</span>, <span class="string">&#x27;gender&#x27;</span>: <span class="string">&#x27;male&#x27;</span>,  <span class="string">&#x27;age&#x27;</span>: <span class="number">13</span>&#125;,</span><br><span class="line">]</span><br><span class="line"><span class="comment"># 列表推导式</span></span><br><span class="line">names = [item[<span class="string">&#x27;name&#x27;</span>] <span class="keyword">for</span> item <span class="keyword">in</span> data]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 我们把列表的中括号改为小括号就得到一个生成器</span></span><br><span class="line">names2 = (item[<span class="string">&#x27;name&#x27;</span>] <span class="keyword">for</span> item <span class="keyword">in</span> data)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">!!! 生成器和推导式不同，其中的循环不是立即执行的，只用你遍历这个生成器时才会执行</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="魔术方法"><a href="#魔术方法" class="headerlink" title="魔术方法"></a>魔术方法</h2><table>
<thead>
<tr>
<th>魔术方法</th>
<th>描述</th>
</tr>
</thead>
<tbody><tr>
<td><code>__new__</code></td>
<td>创建类并返回这个类的实例</td>
</tr>
<tr>
<td><code>__init__</code></td>
<td>可理解为“构造函数”，在对象初始化的时候调用，使用传入的参数初始化该实例</td>
</tr>
<tr>
<td><code>__del__</code></td>
<td>可理解为“析构函数”，当一个对象进行垃圾回收时调用</td>
</tr>
<tr>
<td><code>__metaclass__</code></td>
<td>定义当前类的元类</td>
</tr>
<tr>
<td><code>__class__</code></td>
<td>查看对象所属的类</td>
</tr>
<tr>
<td><code>__base__</code></td>
<td>获取当前类的父类</td>
</tr>
<tr>
<td><code>__bases__</code></td>
<td>获取当前类的所有父类</td>
</tr>
<tr>
<td><code>__str__</code></td>
<td>定义当前类的实例的文本显示内容</td>
</tr>
<tr>
<td><code>__getattribute__</code></td>
<td>定义属性被访问时的行为</td>
</tr>
<tr>
<td><code>__getattr__</code></td>
<td>定义试图访问一个不存在的属性时的行为</td>
</tr>
<tr>
<td><code>__setattr__</code></td>
<td>定义对属性进行赋值和修改操作时的行为</td>
</tr>
<tr>
<td><code>__delattr__</code></td>
<td>定义删除属性时的行为</td>
</tr>
<tr>
<td><code>__copy__</code></td>
<td>定义对类的实例调用 copy.copy() 获得对象的一个浅拷贝时所产生的行为</td>
</tr>
<tr>
<td><code>__deepcopy__</code></td>
<td>定义对类的实例调用 copy.deepcopy() 获得对象的一个深拷贝时所产生的行为</td>
</tr>
<tr>
<td><code>__eq__</code></td>
<td>定义相等符号“&#x3D;&#x3D;”的行为</td>
</tr>
<tr>
<td><code>__ne__</code></td>
<td>定义不等符号“!&#x3D;”的行为</td>
</tr>
<tr>
<td><code>__lt__</code></td>
<td>定义小于符号“&lt;”的行为</td>
</tr>
<tr>
<td><code>__gt__</code></td>
<td>定义大于符号“&gt;”的行为</td>
</tr>
<tr>
<td><code>__le__</code></td>
<td>定义小于等于符号“&lt;&#x3D;”的行为</td>
</tr>
<tr>
<td><code>__ge__</code></td>
<td>定义大于等于符号“&gt;&#x3D;”的行为</td>
</tr>
<tr>
<td><code>__add__</code></td>
<td>实现操作符“+”表示的加法</td>
</tr>
<tr>
<td><code>__sub__</code></td>
<td>实现操作符“-”表示的减法</td>
</tr>
<tr>
<td><code>__mul__</code></td>
<td>实现操作符“*”表示的乘法</td>
</tr>
<tr>
<td><code>__div__</code></td>
<td>实现操作符“&#x2F;”表示的除法</td>
</tr>
<tr>
<td><code>__mod__</code></td>
<td>实现操作符“％”表示的取模(求余数)</td>
</tr>
<tr>
<td><code>__pow__</code></td>
<td>实现操作符“**”表示的指数操作</td>
</tr>
<tr>
<td><code>__and__</code></td>
<td>实现按位与操作</td>
</tr>
<tr>
<td><code>__or__</code></td>
<td>实现按位或操作</td>
</tr>
<tr>
<td><code>__xor__</code></td>
<td>实现按位异或操作</td>
</tr>
<tr>
<td><code>__len__</code></td>
<td>用于自定义容器类型，表示容器的长度</td>
</tr>
<tr>
<td><code>__getitem__</code></td>
<td>用于自定义容器类型，定义当某一项被访问时，使用 self[key] 所产生的行为</td>
</tr>
<tr>
<td><code>__setitem__</code></td>
<td>用于自定义容器类型，定义执行 self[key]&#x3D;value 时产生的行为</td>
</tr>
<tr>
<td><code>__delitem__</code></td>
<td>用于自定义容器类型，定义一个项目被删除时的行为</td>
</tr>
<tr>
<td><code>__iter__</code></td>
<td>用于自定义容器类型，一个容器迭代器</td>
</tr>
<tr>
<td><code>__reversed__</code></td>
<td>用于自定义容器类型，定义当 reversed( ) 被调用时的行为</td>
</tr>
<tr>
<td><code>__contains__</code></td>
<td>用于自定义容器类型，定义调用 in 和 not in 来测试成员是否存在的时候所产生的行为</td>
</tr>
<tr>
<td><code>__missing__</code></td>
<td>用于自定义容器类型，定义在容器中找不到 key 时触发的行为</td>
</tr>
</tbody></table>
<h2 id="面向对象-slots"><a href="#面向对象-slots" class="headerlink" title="面向对象 - __slots__"></a>面向对象 - __slots__</h2><p>如果我们想要限制实例的属性怎么办？比如，只允许对Student实例添加<code>name</code>和<code>age</code>属性。</p>
<p>为了达到限制的目的，Python允许在定义<code>class</code>的时候，定义一个特殊的<code>__slots__</code>变量，来限制该<code>class</code>实例能添加的属性：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    __slots__ = (<span class="string">&#x27;name&#x27;</span>, <span class="string">&#x27;age&#x27;</span>) <span class="comment"># 用tuple定义允许绑定的属性名称</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="comment"># 当你给限定之外的属性绑定值，正常情况下会创建新属性，并赋值。但加了限制后会直接报错</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s = Student() <span class="comment"># 创建新的实例</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.name = <span class="string">&#x27;Michael&#x27;</span> <span class="comment"># 绑定属性&#x27;name&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.age = <span class="number">25</span> <span class="comment"># 绑定属性&#x27;age&#x27;</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>s.score = <span class="number">99</span> <span class="comment"># 绑定属性&#x27;score&#x27;</span></span><br><span class="line">Traceback (most recent call last):</span><br><span class="line">  File <span class="string">&quot;&lt;stdin&gt;&quot;</span>, line <span class="number">1</span>, <span class="keyword">in</span> &lt;module&gt;</span><br><span class="line">AttributeError: <span class="string">&#x27;Student&#x27;</span> <span class="built_in">object</span> has no attribute <span class="string">&#x27;score&#x27;</span></span><br></pre></td></tr></table></figure>

<p>!!! 使用<code>__slots__</code>要注意，<code>__slots__</code>定义的属性仅对当前类实例起作用，对继承的子类是不起作用的</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ParentClass</span>:</span><br><span class="line">    __slots__ = [<span class="string">&#x27;attribute1&#x27;</span>, <span class="string">&#x27;attribute2&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ChildClass</span>(<span class="title class_ inherited__">ParentClass</span>):</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 现在 ChildClass 没有定义自己的 __slots__，不受限制</span></span><br><span class="line"></span><br><span class="line">c1 = ChildClass() </span><br><span class="line">c1.attribute3 = <span class="number">1</span> <span class="comment"># success</span></span><br><span class="line"><span class="built_in">print</span>(c1.attribute3)</span><br></pre></td></tr></table></figure>

<p>除非在子类中也定义<code>__slots__</code>，这样，子类实例允许定义的属性就是自身的<code>__slots__</code>加上父类的<code>__slots__</code>。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ParentClass</span>:</span><br><span class="line">    __slots__ = [<span class="string">&#x27;attribute1&#x27;</span>, <span class="string">&#x27;attribute2&#x27;</span>]</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">ChildClass</span>(<span class="title class_ inherited__">ParentClass</span>):</span><br><span class="line">    __slots__ = []</span><br><span class="line">    <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 现在 ChildClass 定义自己的 __slots__，它将会继承父类的 __slots__加上自己的 __slots__</span></span><br><span class="line"></span><br><span class="line">c1 = ChildClass()</span><br><span class="line">c1.attribute3 = <span class="number">1</span> <span class="comment"># 报错</span></span><br><span class="line"><span class="built_in">print</span>(c1.attribute3)</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">c1.attribute3 = 1</span></span><br><span class="line"><span class="string">AttributeError: &#x27;ChildClass&#x27; object has no attribute &#x27;attribute3&#x27;</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>



<h2 id="面相对象-MixIn"><a href="#面相对象-MixIn" class="headerlink" title="面相对象 - MixIn"></a>面相对象 - MixIn</h2><p>通过多重继承，一个子类就可以同时获得多个父类的所有功能</p>
<p>mixln - 可以让一个类除了继承其他类外，再同时集成其他类。这种设计通常称之为MixIn。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 这样一来，我们不需要复杂而庞大的继承链，只要选择组合不同的类的功能，就可以快速构造出所需的子类</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Dog</span>(Mammal, RunnableMixIn, CarnivorousMixIn):</span><br><span class="line">    <span class="keyword">pass</span></span><br></pre></td></tr></table></figure>



<h2 id="面相对象-订制类"><a href="#面相对象-订制类" class="headerlink" title="面相对象 - 订制类"></a>面相对象 - 订制类</h2><h3 id="str"><a href="#str" class="headerlink" title="__str__"></a>__str__</h3><p>打印一个类实例会打印这种信息</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="keyword">class</span> <span class="title class_">Student</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"><span class="meta">... </span>    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name</span>):</span><br><span class="line"><span class="meta">... </span>        self.name = name</span><br><span class="line">...</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="built_in">print</span>(Student(<span class="string">&#x27;Michael&#x27;</span>))</span><br><span class="line">&lt;__main__.Student <span class="built_in">object</span> at <span class="number">0x109afb190</span>&gt;</span><br></pre></td></tr></table></figure>

<p>我们可以通过 __str__ 进行输出格式化操作</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name</span>):</span><br><span class="line">		self.name = name</span><br><span class="line">	<span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):  <span class="comment"># print输出时调用</span></span><br><span class="line">		<span class="keyword">return</span> <span class="string">&#x27;Student object (name: %s)&#x27;</span> % self.name</span><br><span class="line">	__repr__ = __str__  </span><br><span class="line">s = Student(<span class="string">&#x27;Michael&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(s)</span><br><span class="line">s</span><br><span class="line"><span class="comment"># Student object (name: Michael)</span></span><br></pre></td></tr></table></figure>



<p>如果一个类想被用于<code>for ... in</code>循环，类似list或tuple那样，就必须实现一个<code>__iter__()</code>方法，该方法返回一个迭代对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Fib</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        self.a, self.b = <span class="number">0</span>, <span class="number">1</span> <span class="comment"># 初始化两个计数器a，b</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__iter__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self <span class="comment"># 实例本身就是迭代对象，故返回自己</span></span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__next__</span>(<span class="params">self</span>):</span><br><span class="line">        self.a, self.b = self.b, self.a + self.b <span class="comment"># 计算下一个值</span></span><br><span class="line">        <span class="keyword">if</span> self.a &gt; <span class="number">100000</span>: <span class="comment"># 退出循环的条件</span></span><br><span class="line">            <span class="keyword">raise</span> StopIteration()</span><br><span class="line">        <span class="keyword">return</span> self.a <span class="comment"># 返回下一个值</span></span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line"><span class="keyword">for</span> n <span class="keyword">in</span> Fib():</span><br><span class="line">	<span class="built_in">print</span>(n)</span><br></pre></td></tr></table></figure>



<h3 id="getitem"><a href="#getitem" class="headerlink" title="__getitem__"></a>__getitem__</h3><p>__iter__() 可以让类进行遍历，但不能拿到某一个单一的值，因为它不是了列表。不能用下标获取</p>
<p>但可以通过实现__getitem__ 可以实现用下标获取某一个值</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Fib</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getitem__</span>(<span class="params">self, n</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(n, <span class="built_in">int</span>): <span class="comment"># n是索引</span></span><br><span class="line">            a, b = <span class="number">1</span>, <span class="number">1</span></span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(n):</span><br><span class="line">                a, b = b, a + b</span><br><span class="line">            <span class="keyword">return</span> a</span><br><span class="line">        <span class="keyword">if</span> <span class="built_in">isinstance</span>(n, <span class="built_in">slice</span>): <span class="comment"># n是切片</span></span><br><span class="line">            start = n.start</span><br><span class="line">            stop = n.stop</span><br><span class="line">            <span class="keyword">if</span> start <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">                start = <span class="number">0</span></span><br><span class="line">            a, b = <span class="number">1</span>, <span class="number">1</span></span><br><span class="line">            L = []</span><br><span class="line">            <span class="keyword">for</span> x <span class="keyword">in</span> <span class="built_in">range</span>(stop):</span><br><span class="line">                <span class="keyword">if</span> x &gt;= start:</span><br><span class="line">                    L.append(a)</span><br><span class="line">                a, b = b, a + b</span><br><span class="line">            <span class="keyword">return</span> L</span><br><span class="line">    </span><br><span class="line">    </span><br><span class="line">f = Fib()</span><br><span class="line"><span class="built_in">print</span>(f[<span class="number">0</span>]) <span class="comment"># 1</span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(f[<span class="number">0</span>:<span class="number">5</span>]) <span class="comment"># [1, 1, 2, 3, 5]</span></span><br></pre></td></tr></table></figure>



<h3 id="getattr-和-setattr"><a href="#getattr-和-setattr" class="headerlink" title="__getattr__ 和 __setattr__"></a>__getattr__ 和 __setattr__</h3><p><code>__getattr__()</code>方法在访问一个不存在的属性时会被调用，可以在该方法中自定义返回值。<br>而<code>__setattr__()</code>方法在给对象的属性赋值时会被调用，可以在该方法中自定义赋值操作。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># __getattr__</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name</span>):  </span><br><span class="line">        self.name = name  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__getattr__</span>(<span class="params">self, attr</span>):  </span><br><span class="line">        <span class="keyword">return</span> <span class="string">f&quot;<span class="subst">&#123;attr&#125;</span>属性不存在&quot;</span>  </span><br><span class="line"></span><br><span class="line">p = Person(<span class="string">&quot;Tom&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(p.name)  <span class="comment"># 输出 &quot;Tom&quot;  </span></span><br><span class="line"><span class="built_in">print</span>(p.age)   <span class="comment"># 输出 &quot;age属性不存在&quot;</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># __setattr__()</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Person</span>:  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name</span>):  </span><br><span class="line">        self.name = name  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__setattr__</span>(<span class="params">self, attr, value</span>):  </span><br><span class="line">        <span class="keyword">if</span> attr == <span class="string">&quot;name&quot;</span>:  </span><br><span class="line">            self.__dict__[attr] = value.upper()  <span class="comment"># 赋值时，对形参进行特殊处理</span></span><br><span class="line">        <span class="keyword">else</span>:  </span><br><span class="line">            self.__dict__[attr] = value  </span><br><span class="line"></span><br><span class="line">p = Person(<span class="string">&quot;Tom&quot;</span>)  </span><br><span class="line"><span class="built_in">print</span>(p.name)  <span class="comment"># 输出 &quot;TOM&quot;  </span></span><br><span class="line">p.age = <span class="number">18</span>  </span><br><span class="line"><span class="built_in">print</span>(p.age)   <span class="comment"># 输出 18</span></span><br></pre></td></tr></table></figure>



<h3 id="call"><a href="#call" class="headerlink" title="__call__"></a>__call__</h3><p>只需要定义一个<code>__call__()</code>方法，就可以直接对实例进行调用</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name</span>):</span><br><span class="line">        self.name = name</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;hello word %s&#x27;</span> % self.name)</span><br><span class="line">        </span><br><span class="line">s = Student(<span class="string">&#x27;Michael&#x27;</span>)</span><br><span class="line">s() <span class="comment"># 直接调用实例，就会调用__call__方法</span></span><br></pre></td></tr></table></figure>



<h2 id="面向对象-枚举类"><a href="#面向对象-枚举类" class="headerlink" title="面向对象 - 枚举类"></a>面向对象 - 枚举类</h2><ol>
<li>枚举类中的成员是从1开始计数的int常量。</li>
<li>可以通过名称或值来获取对应的枚举成员，使用 <code>EnumName.member_name</code> 或 <code>EnumName(&#39;member_value&#39;)</code>。</li>
<li>枚举成员的值是自动赋给成员的int常量。</li>
<li>枚举类型会自动实现比较和排序功能。</li>
</ol>
<h3 id="列表类型"><a href="#列表类型" class="headerlink" title="列表类型"></a>列表类型</h3><p>当需要定义的类型，只含有值，可以这样定义</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum</span><br><span class="line"></span><br><span class="line">Month = Enum(<span class="string">&#x27;Month&#x27;</span>, (<span class="string">&#x27;Jan&#x27;</span>, <span class="string">&#x27;Feb&#x27;</span>, <span class="string">&#x27;Mar&#x27;</span>, <span class="string">&#x27;Apr&#x27;</span>, <span class="string">&#x27;May&#x27;</span>, <span class="string">&#x27;Jun&#x27;</span>, <span class="string">&#x27;Jul&#x27;</span>, <span class="string">&#x27;Aug&#x27;</span>, <span class="string">&#x27;Sep&#x27;</span>, <span class="string">&#x27;Oct&#x27;</span>, <span class="string">&#x27;Nov&#x27;</span>, <span class="string">&#x27;Dec&#x27;</span>)) <span class="comment"># value属性则是自动赋给成员的int常量，默认从1开始计数。</span></span><br><span class="line"><span class="comment"># 访问枚举成员  </span></span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(Month.Jan)   <span class="comment"># 输出: Month.Jan（通过名称访问）  </span></span><br><span class="line"><span class="built_in">print</span>(Month[<span class="string">&#x27;Jan&#x27;</span>])   <span class="comment"># 输出: Month.Jan（通过名称访问）  </span></span><br><span class="line"><span class="built_in">print</span>(Month(<span class="number">1</span>))     <span class="comment"># 输出: Month.Jan（通过值访问）  </span></span><br><span class="line"><span class="built_in">print</span>(Month.Jan.value)   <span class="comment"># 输出: 1（通过名称访问）  </span></span><br><span class="line"><span class="built_in">print</span>(Month[<span class="string">&#x27;Jan&#x27;</span>].value)   <span class="comment"># 输出: 1（通过名称访问）  </span></span><br><span class="line"><span class="built_in">print</span>(Month(<span class="number">1</span>).value)     <span class="comment"># 输出: 1（通过值访问）  </span></span><br></pre></td></tr></table></figure>

<h3 id="键值对类型"><a href="#键值对类型" class="headerlink" title="键值对类型"></a>键值对类型</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> enum <span class="keyword">import</span> Enum, unique</span><br><span class="line"></span><br><span class="line"><span class="meta">@unique </span><span class="comment"># @unique装饰器可以帮助我们检查保证没有重复值。</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Weekday</span>(<span class="title class_ inherited__">Enum</span>):</span><br><span class="line">    Sun = <span class="number">0</span> <span class="comment"># Sun的value被设定为0</span></span><br><span class="line">    Mon = <span class="number">1</span></span><br><span class="line">    Tue = <span class="number">2</span></span><br><span class="line">    Wed = <span class="number">3</span></span><br><span class="line">    Thu = <span class="number">4</span></span><br><span class="line">    Fri = <span class="number">5</span></span><br><span class="line">    Sat = <span class="number">6</span></span><br><span class="line">    </span><br><span class="line"><span class="comment"># 获取方式</span></span><br><span class="line"><span class="built_in">print</span>(Weekday.Mon)   <span class="comment"># 输出: Weekday.Mon（通过名称访问）  </span></span><br><span class="line"><span class="built_in">print</span>(Weekday[<span class="string">&#x27;Mon&#x27;</span>])   <span class="comment"># 输出: Weekday.Mon（通过名称访问）  </span></span><br><span class="line"><span class="built_in">print</span>(Weekday(<span class="number">1</span>))     <span class="comment"># 输出: Weekday.Mon（通过值访问）</span></span><br><span class="line"><span class="built_in">print</span>(Weekday.Mon.value)   <span class="comment"># 输出: 1（通过名称访问）  </span></span><br><span class="line"><span class="built_in">print</span>(Weekday[<span class="string">&#x27;Mon&#x27;</span>].value)   <span class="comment"># 输出: 1（通过名称访问）  </span></span><br><span class="line"><span class="built_in">print</span>(Weekday(<span class="number">1</span>).value)     <span class="comment"># 输出: 1（通过值访问）</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">Sun =&gt; Weekday.Sun</span></span><br><span class="line"><span class="string">Mon =&gt; Weekday.Mon</span></span><br><span class="line"><span class="string">Tue =&gt; Weekday.Tue</span></span><br><span class="line"><span class="string">Wed =&gt; Weekday.Wed</span></span><br><span class="line"><span class="string">Thu =&gt; Weekday.Thu</span></span><br><span class="line"><span class="string">Fri =&gt; Weekday.Fri</span></span><br><span class="line"><span class="string">Sat =&gt; Weekday.Sat</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br></pre></td></tr></table></figure>





<h2 id="面向对象-property"><a href="#面向对象-property" class="headerlink" title="面向对象 - @property"></a>面向对象 - @property</h2><p>当类中使用私有变量来限制访问，通过get和set方法来获取和设置，属性过多，就需要定义多的get和set方法；@property可以通过装饰器的方式解决这个问题</p>
<ul>
<li><p>@property</p>
<p>该装饰器，可以直接把一个get方法书写方式的返回值</p>
</li>
<li><p>@fn.setter</p>
</li>
<li><p>设置只读属性 - 只定义getter方法，不定义setter方法</p>
</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Student</span>(<span class="title class_ inherited__">object</span>):</span><br><span class="line"></span><br><span class="line"><span class="meta">    @property    </span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">score</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._score</span><br><span class="line"></span><br><span class="line"><span class="meta">    @score.setter</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">score</span>(<span class="params">self, value</span>):</span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> <span class="built_in">isinstance</span>(value, <span class="built_in">int</span>):</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;score must be an integer!&#x27;</span>)</span><br><span class="line">        <span class="keyword">if</span> value &lt; <span class="number">0</span> <span class="keyword">or</span> value &gt; <span class="number">100</span>:</span><br><span class="line">            <span class="keyword">raise</span> ValueError(<span class="string">&#x27;score must between 0 ~ 100!&#x27;</span>)</span><br><span class="line">        self._score = value</span><br><span class="line">        </span><br><span class="line"><span class="meta">	@property    </span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">age</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> self._age</span><br><span class="line"></span><br><span class="line"></span><br><span class="line">s = Student()</span><br><span class="line">s.score = <span class="number">60</span>  <span class="comment"># 这里调用的其实是  def score(self, value)</span></span><br><span class="line"><span class="built_in">print</span>(s.score)  <span class="comment"># 这里调用的其实是  def score(self)</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">比正常的属性. 调用，这种写法可以不写属性，且可以在调用时进行逻辑判断</span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"></span><br></pre></td></tr></table></figure>



<h2 id="面相对象-元类-补充"><a href="#面相对象-元类-补充" class="headerlink" title="面相对象 - 元类 [补充]"></a>面相对象 - 元类 [补充]</h2><h3 id="元类是什么"><a href="#元类是什么" class="headerlink" title="元类是什么"></a>元类是什么</h3><p>​		在面向对象（OOP）编程中，我们可以用不同的类来描述不同的实体及操作，可以通过父类来设计一些“默认”操作，也可以用<strong>MixIn类</strong>来组合扩展一些额外操作，也可以用<strong>抽象类</strong>及<strong>抽象方法</strong>来描述要实现的接口，面向接口编程。</p>
<p>​		元类是一种<code>type</code>（type的子类）,是一种自定义类型，可以定制类的调用、对象创建、初始化、销毁等各种操作。</p>
<h3 id="元类的使用场景"><a href="#元类的使用场景" class="headerlink" title="元类的使用场景"></a>元类的使用场景</h3><p>多数情况下<strong>元类用来对普通类来加以限制和规范</strong>。使用元类（自定义类型）可以在类的创建(<code>__new__</code>)、初始化()比如限制类必须包含特定属性和实现特定方法、限制类只能有一个实例对象。</p>
<p>典型使用场景如下：</p>
<ul>
<li>不允许类实例化</li>
<li>单例模式：每个类只允许创建一个对象</li>
<li>根据属性缓存对象：当某一属性相同时返回同一对象</li>
<li>属性限制：类中必须包含某些属性或实现某些方法</li>
<li>ORM框架：用类及类属性来描述数据库表并转为数据库操作</li>
</ul>
<h3 id="元类使用示例"><a href="#元类使用示例" class="headerlink" title="元类使用示例"></a>元类使用示例</h3><h4 id="不允许类实例化"><a href="#不允许类实例化" class="headerlink" title="不允许类实例化"></a>不允许类实例化</h4><p>在某些情况下，假设我需要限制一些类不允许创建对象（只允许使用类名操作），可以使用元类加以限制</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">NoInstances</span>(<span class="title class_ inherited__">type</span>):  <span class="comment"># 定义元类-继承type</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, *args, **kwargs</span>):  <span class="comment"># 控制类调用（实例化）过程</span></span><br><span class="line">        <span class="string">&quot;&quot;&quot;类调用&quot;&quot;&quot;</span></span><br><span class="line">        <span class="keyword">raise</span> TypeError(<span class="string">&quot;不允许实例化&quot;</span>)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(metaclass=NoInstances):  <span class="comment"># 声明使用元类（该类型）</span></span><br><span class="line">     <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line">user = User()  <span class="comment"># ()即调用类的__call__操作，这里会抛出异常，因此无法直接实例化创建对象</span></span><br></pre></td></tr></table></figure>



<h4 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h4><p>某些情况下仅允许类创建一个实例对象，也可以使用元类进行限制</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">Singleton</span>(<span class="title class_ inherited__">type</span>):   <span class="comment"># 单例类型-定制的元类</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, *args, **kwargs</span>):</span><br><span class="line">        self.__instance = <span class="literal">None</span>   <span class="comment"># 添加一个私有属性，用于保存唯一的实例对象</span></span><br><span class="line">        <span class="built_in">super</span>().__init__(*args, **kwargs)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, *args, **kwargs</span>):  <span class="comment"># 控制类调用</span></span><br><span class="line">        <span class="keyword">if</span> self.__instance <span class="keyword">is</span> <span class="literal">None</span>:</span><br><span class="line">            self.__instance = <span class="built_in">super</span>().__call__(*args, **kwargs)  <span class="comment"># 不存在则创建</span></span><br><span class="line">            <span class="keyword">return</span> self.__instance</span><br><span class="line">        <span class="keyword">else</span>:</span><br><span class="line">            <span class="keyword">return</span> self.__instance    <span class="comment"># 否则返回已创建的</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(metaclass=Singleton):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;创建用户&#x27;</span>)</span><br><span class="line"></span><br><span class="line">user1 = User()  <span class="comment"># 创建对象</span></span><br><span class="line">user2 = User()  <span class="comment"># 创建对象</span></span><br><span class="line"><span class="built_in">print</span>(user1 <span class="keyword">is</span> user2)  <span class="comment"># 返回True，两者是同一对象</span></span><br></pre></td></tr></table></figure>



<h4 id="根据属性缓存对象"><a href="#根据属性缓存对象" class="headerlink" title="根据属性缓存对象"></a>根据属性缓存对象</h4><p>这是单例模式的扩展，针对特定属性，完全相同的属性组合创建同一对象</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> weakref</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Cached</span>(<span class="title class_ inherited__">type</span>):</span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, *args, **kwargs</span>):</span><br><span class="line">       <span class="built_in">super</span>().__init__(*args, **kwargs)</span><br><span class="line">       self.__cache = weakref.WeakValueDictionary()  <span class="comment"># 添加一个缓存字典</span></span><br><span class="line"></span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__call__</span>(<span class="params">self, *args</span>):</span><br><span class="line">       <span class="keyword">if</span> args <span class="keyword">in</span> self.__cache:   <span class="comment"># 通过 参数组合查询缓存字典中有没有对应的对象</span></span><br><span class="line">           <span class="keyword">return</span> self.__cache[args]   </span><br><span class="line">       <span class="keyword">else</span>:</span><br><span class="line">           obj = <span class="built_in">super</span>().__call__(*args)  <span class="comment"># 创建对象</span></span><br><span class="line">           self.__cache[args] = obj  <span class="comment"># 根据参数组合（元祖类型）到缓存字典</span></span><br><span class="line">           <span class="keyword">return</span> obj</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(metaclass=Cached):</span><br><span class="line">   <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name</span>):</span><br><span class="line">       <span class="built_in">print</span>(<span class="string">&#x27;创建用户(&#123;!r&#125;)&#x27;</span>.<span class="built_in">format</span>(name))</span><br><span class="line">       self.name = name</span><br><span class="line"></span><br><span class="line">a = User(<span class="string">&#x27;张三&#x27;</span>)</span><br><span class="line">b = User(<span class="string">&#x27;李四&#x27;</span>)</span><br><span class="line">c = User(<span class="string">&#x27;张三&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(a <span class="keyword">is</span> b)  <span class="comment"># False 名字不同，不是同一对象</span></span><br><span class="line"><span class="built_in">print</span>(a <span class="keyword">is</span> c)  <span class="comment"># True  名字相同，是同一对象</span></span><br></pre></td></tr></table></figure>



<h4 id="限制类必须包含特定属性"><a href="#限制类必须包含特定属性" class="headerlink" title="限制类必须包含特定属性"></a>限制类必须包含特定属性</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">TestCaseType</span>(<span class="title class_ inherited__">type</span>):</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__new__</span>(<span class="params">cls, name, bases, attrs</span>):</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;name&#x27;</span>, name)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;bases&#x27;</span>, bases)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;attrs&#x27;</span>, attrs)</span><br><span class="line">        <span class="keyword">if</span> &#123;<span class="string">&#x27;priority&#x27;</span>, <span class="string">&#x27;timeout&#x27;</span>, <span class="string">&#x27;owner&#x27;</span>, <span class="string">&#x27;status&#x27;</span>, <span class="string">&#x27;run_test&#x27;</span>&#125; - <span class="built_in">set</span>(attrs.keys()):</span><br><span class="line">            <span class="keyword">raise</span> TypeError(<span class="string">&#x27;测试用例类必须包含priority、status、owner、timeout属性并实现run_test方法&#x27;</span>)</span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>().__new__(cls, name, bases, attrs)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">TestA</span>(metaclass=TestCaseType):</span><br><span class="line">    <span class="comment"># priority = &#x27;P1&#x27;</span></span><br><span class="line">    timeout = <span class="number">10</span></span><br><span class="line">    owner = <span class="string">&#x27;kevin&#x27;</span></span><br><span class="line">    status = <span class="string">&#x27;ready&#x27;</span></span><br><span class="line">    </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">run_test</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">pass</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">a = TestA()  <span class="comment"># 这里注释了用例类的priority属性，实例化会报错</span></span><br></pre></td></tr></table></figure>





<h4 id="ORM框架"><a href="#ORM框架" class="headerlink" title="ORM框架"></a>ORM框架</h4><p>​		ORM（Object-Relational Mapping）是一种将对象和关系数据库之间的映射的技术，它可以让我们使用面向对象的方式来操作数据库。</p>
<p>​		Django中的ORM模型、以及SQLAlchemy都是基于元类实现的，将数据库操作映射为 类声明和对象操作，下面是一个基于元类的，简单的ORM框架的实现</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">ModelMeta</span>(<span class="title class_ inherited__">type</span>):  <span class="comment"># 元类</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__new__</span>(<span class="params">cls, name, bases, attrs</span>):</span><br><span class="line">        <span class="keyword">if</span> name == <span class="string">&#x27;Model&#x27;</span>:</span><br><span class="line">            <span class="keyword">return</span> <span class="built_in">super</span>().__new__(cls, name, bases, attrs)</span><br><span class="line"></span><br><span class="line">        table_name = attrs.get(<span class="string">&#x27;__table__&#x27;</span>, name.lower())  <span class="comment"># 如果类中包含table_name属性，则以该属性作为表明</span></span><br><span class="line">        mappings = &#123;&#125;</span><br><span class="line">        fields = []</span><br><span class="line">        primary_key = <span class="literal">None</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> k, v <span class="keyword">in</span> attrs.items():</span><br><span class="line">            <span class="keyword">if</span> <span class="built_in">isinstance</span>(v, Field):</span><br><span class="line">                mappings[k] = v</span><br><span class="line">                <span class="keyword">if</span> v.primary_key:</span><br><span class="line">                    <span class="keyword">if</span> primary_key:</span><br><span class="line">                        <span class="keyword">raise</span> RuntimeError(<span class="string">&#x27;Duplicate primary key for field: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(k))   <span class="comment"># 只允许一个Field声明为主键</span></span><br><span class="line">                    primary_key = k</span><br><span class="line">                <span class="keyword">else</span>:</span><br><span class="line">                    fields.append(k)</span><br><span class="line"></span><br><span class="line">        <span class="keyword">if</span> <span class="keyword">not</span> primary_key:</span><br><span class="line">            <span class="keyword">raise</span> RuntimeError(<span class="string">&#x27;Primary key not found for table: &#123;&#125;&#x27;</span>.<span class="built_in">format</span>(table_name))   <span class="comment"># 不允许没有主键</span></span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> k <span class="keyword">in</span> mappings.keys():</span><br><span class="line">            attrs.pop(k)</span><br><span class="line"></span><br><span class="line">        attrs[<span class="string">&#x27;__table__&#x27;</span>] = table_name</span><br><span class="line">        attrs[<span class="string">&#x27;__mappings__&#x27;</span>] = mappings</span><br><span class="line">        attrs[<span class="string">&#x27;__fields__&#x27;</span>] = fields</span><br><span class="line">        attrs[<span class="string">&#x27;__primary_key__&#x27;</span>] = primary_key</span><br><span class="line"></span><br><span class="line">        <span class="keyword">return</span> <span class="built_in">super</span>().__new__(cls, name, bases, attrs)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Model</span>(metaclass=ModelMeta):  <span class="comment"># 数据模型-对应一张数据库表</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, **kwargs</span>):</span><br><span class="line">        <span class="keyword">for</span> k, v <span class="keyword">in</span> kwargs.items():</span><br><span class="line">            <span class="built_in">setattr</span>(self, k, v)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">save</span>(<span class="params">self</span>):  <span class="comment"># 对象保存方法-对应数据库表插入数据</span></span><br><span class="line">        fields = []</span><br><span class="line">        params = []</span><br><span class="line">        args = []</span><br><span class="line"></span><br><span class="line">        <span class="keyword">for</span> k, v <span class="keyword">in</span> self.__mappings__.items():</span><br><span class="line">            <span class="keyword">if</span> v.primary_key:</span><br><span class="line">                <span class="keyword">continue</span></span><br><span class="line">            fields.append(v.name)</span><br><span class="line">            params.append(<span class="string">&#x27;?&#x27;</span>)</span><br><span class="line">            args.append(<span class="built_in">getattr</span>(self, k, <span class="literal">None</span>))</span><br><span class="line"></span><br><span class="line">        sql = <span class="string">&#x27;INSERT INTO &#123;&#125; (&#123;&#125;) VALUES (&#123;&#125;)&#x27;</span>.<span class="built_in">format</span>(self.__table__, <span class="string">&#x27;,&#x27;</span>.join(fields), <span class="string">&#x27;,&#x27;</span>.join(params))</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;SQL:&#x27;</span>, sql)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&#x27;ARGS:&#x27;</span>, args)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">Field</span>:  <span class="comment"># 数据库字段</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, column_type, primary_key=<span class="literal">False</span></span>):</span><br><span class="line">        self.name = name</span><br><span class="line">        self.column_type = column_type</span><br><span class="line">        self.primary_key = primary_key</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__str__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="keyword">return</span> <span class="string">&#x27;&lt;&#123;&#125;:&#123;&#125;&gt;&#x27;</span>.<span class="built_in">format</span>(self.__class__.__name__, self.name)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">StringField</span>(<span class="title class_ inherited__">Field</span>):  <span class="comment"># 字符串类型字典-对应varchar</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, primary_key=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(name, <span class="string">&#x27;varchar(100)&#x27;</span>, primary_key)</span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">IntegerField</span>(<span class="title class_ inherited__">Field</span>):   <span class="comment"># 整型字典-对应bigint</span></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__init__</span>(<span class="params">self, name, primary_key=<span class="literal">False</span></span>):</span><br><span class="line">        <span class="built_in">super</span>().__init__(name, <span class="string">&#x27;bigint&#x27;</span>, primary_key)</span><br></pre></td></tr></table></figure>

<p>使用这个ORM框架，我们可以定义一个继承自<code>Model</code>的类，并在其中定义字段。例如</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(<span class="title class_ inherited__">Model</span>):</span><br><span class="line">    <span class="built_in">id</span> = IntegerField(<span class="string">&#x27;id&#x27;</span>, primary_key=<span class="literal">True</span>)</span><br><span class="line">    name = StringField(<span class="string">&#x27;username&#x27;</span>)</span><br><span class="line">    email = StringField(<span class="string">&#x27;email&#x27;</span>)</span><br><span class="line">    password = StringField(<span class="string">&#x27;password&#x27;</span>)</span><br><span class="line">    </span><br><span class="line"><span class="comment"># 我们就可以创建一个User对象，并将其保存到数据库中</span></span><br><span class="line">user = User(<span class="built_in">id</span>=<span class="number">1</span>, name=<span class="string">&#x27;Alice&#x27;</span>, email=<span class="string">&#x27;alice@example.com&#x27;</span>, password=<span class="string">&#x27;123456&#x27;</span>)</span><br><span class="line">user.save()</span><br></pre></td></tr></table></figure>





<h2 id="正则表达式"><a href="#正则表达式" class="headerlink" title="正则表达式"></a>正则表达式</h2><h3 id="什么是正则表达式"><a href="#什么是正则表达式" class="headerlink" title="什么是正则表达式"></a>什么是正则表达式</h3><p>　　正则表达式是对字符串（包括普通字符（例如，a 到 z 之间的字母）和特殊字符（称为“元字符”））操作的一种逻辑公式，就是用事先定义好的一些特定字符、及这些特定字符的组合，组成一个“规则字符串”，这个“规则字符串”用来表达对字符串的一种过滤逻辑。正则表达式是一种文本模式，该模式描述在搜索文本时要匹配的一个或多个字符串。</p>
<h3 id="正则表达式可以干什么"><a href="#正则表达式可以干什么" class="headerlink" title="正则表达式可以干什么"></a>正则表达式可以干什么</h3><ul>
<li>快速高效的查找与分析字符串</li>
<li>进行有规律查找比对字符串，也叫：<a target="_blank" rel="noopener" href="https://www.baidu.com/s?wd=%E6%A8%A1%E5%BC%8F%E5%8C%B9%E9%85%8D&tn=SE_PcZhidaonwhc_ngpagmjz&rsv_dl=gh_pc_zhidao">模式匹配</a></li>
<li>具有查找、比对、匹配、替换、插入、添加、删除等能力。</li>
</ul>
<h3 id="re模块"><a href="#re模块" class="headerlink" title="re模块"></a>re模块</h3><p>Python 自1.5版本起增加了re 模块，它提供 Perl 风格的正则表达式模式。re 模块使 Python 语言拥有全部的正则表达式功能。</p>
<p>由于Python的字符串本身也用<code>\</code>转义，所以要特别注意：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">&#x27;ABC\\-001&#x27;</span> <span class="comment"># Python的字符串</span></span><br><span class="line"><span class="comment"># 对应的正则表达式字符串变成：</span></span><br><span class="line"><span class="comment"># &#x27;ABC\-001&#x27;</span></span><br></pre></td></tr></table></figure>

<p>因此建议使用Python的<code>r</code>前缀，就不用考虑转义的问题了：</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">s = <span class="string">r&#x27;ABC\-001&#x27;</span> <span class="comment"># Python的字符串</span></span><br><span class="line"><span class="comment"># 对应的正则表达式字符串不变：</span></span><br><span class="line"><span class="comment"># &#x27;ABC\-001&#x27;</span></span><br></pre></td></tr></table></figure>

<h3 id="正则表达式模式"><a href="#正则表达式模式" class="headerlink" title="正则表达式模式"></a>正则表达式模式</h3><p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i-blog.csdnimg.cn/blog_migrate/a99408c479af61afde137f3ae778afe2.png" alt="在这里插入图片描述"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i-blog.csdnimg.cn/blog_migrate/c7ecf57c665cf086df0e137f9fdd0477.png" alt="在这里插入图片描述"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i-blog.csdnimg.cn/blog_migrate/1cf83c53486642a902cff1145289cbdf.png" alt="在这里插入图片描述"></p>
<p><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i-blog.csdnimg.cn/blog_migrate/920768528b89daf9a864d4665e039ead.png" alt="在这里插入图片描述"></p>
<p>使用特殊符号表示字符：用<code>\d</code>可以匹配一个数字，<code>\w</code>可以匹配一个字母或数字，例如：</p>
<ul>
<li><code>&#39;00\d&#39;</code>可以匹配<code>&#39;007&#39;</code>，但无法匹配<code>&#39;00A&#39;</code>；</li>
<li><code>&#39;\d\d\d&#39;</code>可以匹配<code>&#39;010&#39;</code>；</li>
<li><code>&#39;\w\w\d&#39;</code>可以匹配<code>&#39;py3&#39;。</code></li>
</ul>
<p><code>&#39;.&#39;</code>可以匹配任意字符，所以：</p>
<ul>
<li><code>&#39;py.&#39;</code>可以匹配<code>&#39;pyc&#39;</code>、<code>&#39;py3&#39;</code>、<code>&#39;py!&#39;</code>等等。</li>
</ul>
<p>要匹配变长的字符，在正则表达式中，用<code>*</code>表示任意个字符（包括0个），用<code>+</code>表示至少一个字符，用<code>?</code>表示0个或1个字符，用<code>&#123;n&#125;</code>表示n个字符，用<code>&#123;n,m&#125;</code>表示n-m个字符。</p>
<p>来看一个复杂的例子：<code>\d&#123;3&#125;\s+\d&#123;3,8&#125;</code>。</p>
<p>我们来从左到右解读一下：</p>
<ol>
<li><code>\d&#123;3&#125;</code>表示匹配3个数字，例如<code>&#39;010&#39;</code>；</li>
<li><code>\s</code>可以匹配一个空格（也包括Tab等空白符），所以<code>\s+</code>表示至少有一个空格，例如匹配<code>&#39; &#39;</code>，<code>&#39; &#39;</code>等；</li>
<li><code>\d&#123;3,8&#125;</code>表示3-8个数字，例如<code>&#39;1234567&#39;</code>。</li>
</ol>
<p>综合起来，上面的正则表达式可以匹配以任意个空格隔开的带区号的电话号码。</p>
<p>如果要匹配<code>&#39;010-12345&#39;</code>这样的号码呢？由于<code>&#39;-&#39;</code>是特殊字符，在正则表达式中，要用<code>&#39;\&#39;</code>转义，所以，上面的正则是<code>\d&#123;3&#125;\-\d&#123;3,8&#125;</code>。</p>
<p>但是，仍然无法匹配<code>&#39;010 - 12345&#39;</code>，因为带有空格。所以我们需要更复杂的匹配方式。</p>
<p><strong>进阶</strong></p>
<p>要做更精确地匹配，可以用<code>[]</code>表示范围，比如：</p>
<ul>
<li><code>[0-9a-zA-Z\_]</code>可以匹配一个数字、字母或者下划线；</li>
<li><code>[0-9a-zA-Z\_]+</code>可以匹配至少由一个数字、字母或者下划线组成的字符串，比如<code>&#39;a100&#39;</code>，<code>&#39;0_Z&#39;</code>，<code>&#39;Py3000&#39;</code>等等；</li>
<li><code>[a-zA-Z\_][0-9a-zA-Z\_]*</code>可以匹配由字母或下划线开头，后接任意个由一个数字、字母或者下划线组成的字符串，也就是Python合法的变量；</li>
<li><code>[a-zA-Z\_][0-9a-zA-Z\_]&#123;0, 19&#125;</code>更精确地限制了变量的长度是1-20个字符（前面1个字符+后面最多19个字符）。</li>
</ul>
<p><code>A|B</code>可以匹配A或B，所以<code>(P|p)ython</code>可以匹配<code>&#39;Python&#39;</code>或者<code>&#39;python&#39;</code>。</p>
<p><code>^</code>表示行的开头，<code>^\d</code>表示必须以数字开头。</p>
<p><code>$</code>表示行的结束，<code>\d$</code>表示必须以数字结束。</p>
<p><code>py</code>也可以匹配<code>&#39;python&#39;</code>，但是加上<code>^py$</code>就变成了整行匹配，就只能匹配<code>&#39;py&#39;</code>了。</p>
<h3 id="re模常用方法"><a href="#re模常用方法" class="headerlink" title="re模常用方法"></a>re模常用方法</h3><h4 id="导入模块"><a href="#导入模块" class="headerlink" title="导入模块"></a>导入模块</h4><figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">import re</span><br></pre></td></tr></table></figure>

<h4 id="匹配多种可能"><a href="#匹配多种可能" class="headerlink" title="匹配多种可能 - []"></a>匹配多种可能 - []</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">#&#x27;run&#x27; or &#x27;ran&#x27;</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;r[au]n&#x27;</span>,<span class="string">&#x27;dog runs to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">4</span>, <span class="number">7</span>), <span class="keyword">match</span>=<span class="string">&#x27;run&#x27;</span>&gt; </span><br><span class="line"></span><br><span class="line">res = re.search(<span class="string">r&#x27;r[au]n&#x27;</span>,<span class="string">&#x27;dog rans to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">4</span>, <span class="number">7</span>), <span class="keyword">match</span>=<span class="string">&#x27;ran&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment">#continue 匹配更多种可能</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;r[A-Z]n&#x27;</span>,<span class="string">&#x27;dog rans to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">None</span></span><br><span class="line"></span><br><span class="line">res = re.search(<span class="string">r&#x27;r[a-z]n&#x27;</span>,<span class="string">&#x27;dog rans to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">4</span>, <span class="number">7</span>), <span class="keyword">match</span>=<span class="string">&#x27;ran&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line">res = re.search(<span class="string">r&#x27;r[0-9]n&#x27;</span>,<span class="string">&#x27;dog rans to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line">&gt;&gt;&gt;<span class="literal">None</span></span><br><span class="line"></span><br><span class="line">res = re.search(<span class="string">r&#x27;r[0-9a-z]n&#x27;</span>,<span class="string">&#x27;dog rans to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">4</span>, <span class="number">7</span>), <span class="keyword">match</span>=<span class="string">&#x27;ran&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<h4 id="匹配数字-d-or-D"><a href="#匹配数字-d-or-D" class="headerlink" title="匹配数字 - \d or \D"></a>匹配数字 - \d or \D</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># \d : decimal digit 数字的</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;r\dn&#x27;</span>,<span class="string">&#x27;run r9n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">4</span>, <span class="number">7</span>), <span class="keyword">match</span>=<span class="string">&#x27;r9n&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># \D : any non-decimal digit 任何不是数字的</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;r\Dn&#x27;</span>,<span class="string">&#x27;run r9n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">0</span>, <span class="number">3</span>), <span class="keyword">match</span>=<span class="string">&#x27;run&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<h4 id="匹配空白-s-or-S"><a href="#匹配空白-s-or-S" class="headerlink" title="匹配空白 - \s or \S"></a>匹配空白 - \s or \S</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># \s : any white space [\t \n \r \f \v]</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;r\sn&#x27;</span>,<span class="string">&#x27;r\nn r9n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">0</span>, <span class="number">3</span>), <span class="keyword">match</span>=<span class="string">&#x27;r\nn&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># \S : 和\s相反，any non-white space</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;r\Sn&#x27;</span>,<span class="string">&#x27;r\nn r9n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">4</span>, <span class="number">7</span>), <span class="keyword">match</span>=<span class="string">&#x27;r9n&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<h4 id="匹配所有字母和数字以及-‘-’-w-or-W"><a href="#匹配所有字母和数字以及-‘-’-w-or-W" class="headerlink" title="匹配所有字母和数字以及 ‘_’ - \w or \W"></a>匹配所有字母和数字以及 ‘_’ - \w or \W</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># \w : [a-zA-Z0-9_]</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;r\wn&#x27;</span>,<span class="string">&#x27;r\nn r9n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">4</span>, <span class="number">7</span>), <span class="keyword">match</span>=<span class="string">&#x27;r9n&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># \W : opposite to \w 即与\w相反</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;r\Wn&#x27;</span>,<span class="string">&#x27;r\nn r9n&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">0</span>, <span class="number">3</span>), <span class="keyword">match</span>=<span class="string">&#x27;r\nn&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<h4 id="匹配空白字符串-b-or-B"><a href="#匹配空白字符串-b-or-B" class="headerlink" title="匹配空白字符串 - \b or \B"></a>匹配空白字符串 - \b or \B</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># \b : (only at the start or end of the word)</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;\bruns\b&#x27;</span>,<span class="string">&#x27;dog runs to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">4</span>, <span class="number">8</span>), <span class="keyword">match</span>=<span class="string">&#x27;runs&#x27;</span>&gt;</span><br><span class="line">res = re.search(<span class="string">r&#x27;\bruns\b&#x27;</span>,<span class="string">&#x27;dogrunsto cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">None</span></span><br><span class="line"></span><br><span class="line"><span class="comment"># \B : ( but not at the start or end of the word)</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;\Bruns\B&#x27;</span>,<span class="string">&#x27;dog runs to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">None</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;\Bruns\B&#x27;</span>,<span class="string">&#x27;dogrunsto cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">5</span>, <span class="number">11</span>), <span class="keyword">match</span>=<span class="string">&#x27; runs &#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<h4 id="匹配任意字符-特殊字符-or"><a href="#匹配任意字符-特殊字符-or" class="headerlink" title="匹配任意字符 特殊字符 - \ or ."></a>匹配任意字符 特殊字符 - \ or .</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># \\ : 匹配 \</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;runs\\&#x27;</span>,<span class="string">&#x27;dog runs\ to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">4</span>, <span class="number">9</span>), <span class="keyword">match</span>=<span class="string">&#x27;runs\\&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># . : 匹配 anything （except \n）</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;r.ns&#x27;</span>,<span class="string">&#x27;dog r;ns to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">4</span>, <span class="number">8</span>), <span class="keyword">match</span>=<span class="string">&#x27;r;ns&#x27;</span>&gt;</span><br><span class="line">&gt;res = re.search(<span class="string">r&#x27;r.ns&#x27;</span>,<span class="string">&#x27;dog r\nns to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">None</span></span><br></pre></td></tr></table></figure>

<h4 id="匹配句首句尾-or"><a href="#匹配句首句尾-or" class="headerlink" title="匹配句首句尾 - $ or ^"></a>匹配句首句尾 - $ or ^</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ^ : 匹配line beginning</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;^runs&#x27;</span>,<span class="string">&#x27;dog runs to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">None</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;^dog&#x27;</span>,<span class="string">&#x27;dog runs to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">0</span>, <span class="number">3</span>), <span class="keyword">match</span>=<span class="string">&#x27;dog&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line"><span class="comment"># $ : 匹配line ending</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;runs$&#x27;</span>,<span class="string">&#x27;dog runs to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">None</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;cat$&#x27;</span>,<span class="string">&#x27;dog runs to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">12</span>, <span class="number">15</span>), <span class="keyword">match</span>=<span class="string">&#x27;cat&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<h4 id="是否匹配"><a href="#是否匹配" class="headerlink" title="是否匹配 - ?"></a>是否匹配 - ?</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># ？ ： may or may nt occur</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;r(u)?ns&#x27;</span>,<span class="string">&#x27;dog runs to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">4</span>, <span class="number">8</span>), <span class="keyword">match</span>=<span class="string">&#x27;runs&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line">res = re.search(<span class="string">r&#x27;r(u)?ns&#x27;</span>,<span class="string">&#x27;dog rns to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line">&gt;&gt;&gt;&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">4</span>, <span class="number">7</span>), <span class="keyword">match</span>=<span class="string">&#x27;rns&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<h4 id="多行匹配-re-M"><a href="#多行匹配-re-M" class="headerlink" title="多行匹配 - re.M"></a>多行匹配 - re.M</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 匹配代码后面加上re.M</span></span><br><span class="line">string = <span class="string">&quot;&quot;&quot; 123.</span></span><br><span class="line"><span class="string">dog runs to cat.</span></span><br><span class="line"><span class="string">You run to dog.</span></span><br><span class="line"><span class="string">&quot;&quot;&quot;</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;^You&#x27;</span>,string)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">None</span></span><br><span class="line"></span><br><span class="line">res = re.search(<span class="string">r&#x27;^You&#x27;</span>,string,re.M)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">10</span>, <span class="number">13</span>), <span class="keyword">match</span>=<span class="string">&#x27;run&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<h4 id="匹配零次或多次"><a href="#匹配零次或多次" class="headerlink" title="匹配零次或多次 - *"></a>匹配零次或多次 - *</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># * ： occur 0 or more times</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;ab*&#x27;</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">0</span>, <span class="number">1</span>), <span class="keyword">match</span>=<span class="string">&#x27;a&#x27;</span>&gt;</span><br><span class="line"></span><br><span class="line">res = re.search(<span class="string">r&#x27;ab*&#x27;</span>,<span class="string">&#x27;abbbbbbbbbb&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">0</span>, <span class="number">11</span>), <span class="keyword">match</span>=<span class="string">&#x27;abbbbbbbbbb&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<h4 id="匹配一次或多次"><a href="#匹配一次或多次" class="headerlink" title="匹配一次或多次 - +"></a>匹配一次或多次 - +</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># + ：occur 1 or more times</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;ab+&#x27;</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">None</span></span><br><span class="line"></span><br><span class="line">res = re.search(<span class="string">r&#x27;ab+&#x27;</span>,<span class="string">&#x27;abbbbbbbbbb&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">0</span>, <span class="number">11</span>), <span class="keyword">match</span>=<span class="string">&#x27;abbbbbbbbbb&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<h4 id="可选匹配次数-n-m"><a href="#可选匹配次数-n-m" class="headerlink" title="可选匹配次数 - {n, m}"></a>可选匹配次数 - {n, m}</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># &#123;n, m&#125; : occur n to m times</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;ab&#123;1,10&#125;&#x27;</span>,<span class="string">&#x27;a&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="literal">None</span></span><br><span class="line"></span><br><span class="line">res = re.search(<span class="string">r&#x27;ab&#123;1,10&#125;&#x27;</span>,<span class="string">&#x27;abbbbbbbbbb&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>&lt;re.Match <span class="built_in">object</span>; span=(<span class="number">0</span>, <span class="number">11</span>), <span class="keyword">match</span>=<span class="string">&#x27;abbbbbbbbbb&#x27;</span>&gt;</span><br></pre></td></tr></table></figure>

<p>匹配多个正则公式，利用group添加命名输出</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># group</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;ID: (\d+), Name: (.+)&#x27;</span>,<span class="string">&#x27;ID: 123456789, Name: a/b*c;d&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res.group())</span><br><span class="line"><span class="built_in">print</span>(res.group(<span class="number">1</span>)) <span class="comment"># 利用1, 2 标识顺序</span></span><br><span class="line"><span class="built_in">print</span>(res.group(<span class="number">2</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>ID: <span class="number">123456789</span>, Name: a/b*c;d</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">123456789</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a/b*c;d</span><br><span class="line"></span><br><span class="line"><span class="comment"># 给group组命名  ?P&lt;name&gt;</span></span><br><span class="line">res = re.search(<span class="string">r&#x27;ID: (?P&lt;id&gt;\d+), Name: (?P&lt;name&gt;.+)&#x27;</span>,<span class="string">&#x27;ID: 123456789, Name: a/b*c;d&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res.group(<span class="string">&#x27;id&#x27;</span>))</span><br><span class="line"><span class="built_in">print</span>(res.group(<span class="string">&#x27;name&#x27;</span>))</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span><span class="number">123456789</span></span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>a/b*c;d</span><br></pre></td></tr></table></figure>

<h4 id="去除惰性，寻找所有匹配-findall"><a href="#去除惰性，寻找所有匹配-findall" class="headerlink" title="去除惰性，寻找所有匹配 - findall"></a>去除惰性，寻找所有匹配 - findall</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># re.findall()</span></span><br><span class="line">res = re.findall(<span class="string">r&#x27;r[ua]n&#x27;</span>,<span class="string">&#x27;run ran ren&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="string">&#x27;run&#x27;</span>, <span class="string">&#x27;ran&#x27;</span>]</span><br><span class="line"></span><br><span class="line"><span class="comment"># 另一种写法</span></span><br><span class="line">res = re.findall(<span class="string">r&#x27;(run|ran)&#x27;</span>,<span class="string">&#x27;run ran ren&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="string">&#x27;run&#x27;</span>, <span class="string">&#x27;ran&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h4 id="替换匹配内容-sub"><a href="#替换匹配内容-sub" class="headerlink" title="替换匹配内容 - sub"></a>替换匹配内容 - sub</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># re.sub(   ,replace,   )</span></span><br><span class="line">res = re.sub(<span class="string">r&#x27;runs&#x27;</span>,<span class="string">&#x27;catches&#x27;</span>,<span class="string">&#x27;dog runs to cat&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>dog catches to cat</span><br></pre></td></tr></table></figure>

<h4 id="分裂匹配内容-split"><a href="#分裂匹配内容-split" class="headerlink" title="分裂匹配内容 - split"></a>分裂匹配内容 - split</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># re.split()</span></span><br><span class="line">res = re.split(<span class="string">r&#x27;[,;\.\\]&#x27;</span>, <span class="string">&#x27;a,b;c.d\e&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="string">&#x27;a&#x27;</span>, <span class="string">&#x27;b&#x27;</span>, <span class="string">&#x27;c&#x27;</span>, <span class="string">&#x27;d&#x27;</span>, <span class="string">&#x27;e&#x27;</span>]</span><br></pre></td></tr></table></figure>

<h4 id="将正则匹配规则进行包装-compile"><a href="#将正则匹配规则进行包装-compile" class="headerlink" title="将正则匹配规则进行包装 - compile"></a>将正则匹配规则进行包装 - compile</h4><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># re. compile()</span></span><br><span class="line">compile_re = re.<span class="built_in">compile</span>(<span class="string">r&#x27;r[ua]n&#x27;</span>)</span><br><span class="line">res = compile_re.findall(<span class="string">&#x27;run ran ren&#x27;</span>)</span><br><span class="line"><span class="built_in">print</span>(res)</span><br><span class="line"><span class="meta">&gt;&gt;&gt; </span>[<span class="string">&#x27;run&#x27;</span>, <span class="string">&#x27;ran&#x27;</span>]</span><br></pre></td></tr></table></figure>



<h3 id="一些常见的正则表达式"><a href="#一些常见的正则表达式" class="headerlink" title="一些常见的正则表达式"></a>一些常见的正则表达式</h3><h4 id="校验数字"><a href="#校验数字" class="headerlink" title="校验数字"></a>校验数字</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">1、数字：^[0-9]*$</span><br><span class="line">2、n位的数字：^\d&#123;n&#125;$</span><br><span class="line">3、至少n位的数字：^\d&#123;n,&#125;$</span><br><span class="line">4、m-n位的数字：^\d&#123;m,n&#125;$</span><br><span class="line">5、零和非零开头的数字：^(0|[1-9][0-9]*)$</span><br><span class="line">6、非零开头的最多带两位小数的数字：^([1-9][0-9]*)+(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line">7、带1-2位小数的正数或负数：^(\-)?\d+(\.\d&#123;1,2&#125;)?$</span><br><span class="line">8、正数、负数、和小数：^(\-|\+)?\d+(\.\d+)?$</span><br><span class="line">9、有两位小数的正实数：^[0-9]+(.[0-9]&#123;2&#125;)?$</span><br><span class="line">10、有1~3位小数的正实数：^[0-9]+(.[0-9]&#123;1,3&#125;)?$</span><br><span class="line">11、非零的正整数：^[1-9]\d*$ 或 ^([1-9][0-9]*)&#123;1,3&#125;$ 或 ^\+?[1-9][0-9]*$</span><br><span class="line">12、非零的负整数：^\-[1-9][]0-9&quot;*$ 或 ^-[1-9]\d*$</span><br><span class="line">13、非负整数：^\d+$ 或 ^[1-9]\d*|0$</span><br><span class="line">14、非正整数：^-[1-9]\d*|0$ 或 ^((-\d+)|(0+))$</span><br><span class="line">15、非负浮点数：^\d+(\.\d+)?$ 或 ^[1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0$</span><br><span class="line">16、非正浮点数：^((-\d+(\.\d+)?)|(0+(\.0+)?))$ 或 ^(-([1-9]\d*\.\d*|0\.\d*[1-9]\d*))|0?\.0+|0$</span><br><span class="line">17、正浮点数：^[1-9]\d*\.\d*|0\.\d*[1-9]\d*$ 或 ^(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*))$</span><br><span class="line">18、负浮点数：^-([1-9]\d*\.\d*|0\.\d*[1-9]\d*)$ 或 ^(-(([0-9]+\.[0-9]*[1-9][0-9]*)|([0-9]*[1-9][0-9]*\.[0-9]+)|([0-9]*[1-9][0-9]*)))$</span><br><span class="line">19、浮点数：^(-?\d+)(\.\d+)?$ 或 ^-?([1-9]\d*\.\d*|0\.\d*[1-9]\d*|0?\.0+|0)$</span><br></pre></td></tr></table></figure>

<h4 id="校验字符"><a href="#校验字符" class="headerlink" title="校验字符"></a>校验字符</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">1、汉字：^[\u4e00-\u9fa5]&#123;0,&#125;$</span><br><span class="line">2、英文和数字：^[A-Za-z0-9]+$ 或 ^[A-Za-z0-9]&#123;4,40&#125;$</span><br><span class="line">3、长度为3-20的所有字符：^.&#123;3,20&#125;$</span><br><span class="line">3、由26个英文字母组成的字符串：^[A-Za-z]+$</span><br><span class="line">5、由26个大写英文字母组成的字符串：^[A-Z]+$</span><br><span class="line">6、由26个小写英文字母组成的字符串：^[a-z]+$</span><br><span class="line">7、由数字和26个英文字母组成的字符串：^[A-Za-z0-9]+$</span><br><span class="line">8、由数字、26个英文字母或者下划线组成的字符串：^\w+$ 或 ^\w&#123;3,20&#125;$</span><br><span class="line">9、中文、英文、数字包括下划线：^[\u4E00-\u9FA5A-Za-z0-9_]+$</span><br><span class="line">10、中文、英文、数字但不包括下划线等符号：^[\u4E00-\u9FA5A-Za-z0-9]+$ 或 ^[\u4E00-\u9FA5A-Za-z0-9]&#123;2,20&#125;$</span><br><span class="line">11、可以输入含有^%&amp;&#x27;,;=?$\&quot;等字符：[^%&amp;&#x27;,;=?$\x22]+</span><br><span class="line">12、禁止输入含有~的字符：[^~\x22]+</span><br></pre></td></tr></table></figure>

<h4 id="特殊需求"><a href="#特殊需求" class="headerlink" title="特殊需求"></a>特殊需求</h4><figure class="highlight txt"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line">1、Email地址：^\w+([-+.]\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$</span><br><span class="line">2、域名：[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;(/.[a-zA-Z0-9][-a-zA-Z0-9]&#123;0,62&#125;)+/.?</span><br><span class="line">3、 InternetURL：[a-zA-z]+://[^\s]* 或 ^http://([\w-]+\.)+[\w-]+(/[\w-./?%&amp;=]*)?$</span><br><span class="line">4、手机号码：^(13[0-9]|14[5|7]|15[0|1|2|3|5|6|7|8|9]|18[0|1|2|3|5|6|7|8|9])\d&#123;8&#125;$</span><br><span class="line">5、电话号码(&quot;XXX-XXXXXXX&quot;、&quot;XXXX-XXXXXXXX&quot;、&quot;XXX-XXXXXXX&quot;、&quot;XXX-XXXXXXXX&quot;、&quot;XXXXXXX&quot;和&quot;XXXXXXXX)：^(\(\d&#123;3,4&#125;-)|\d&#123;3.4&#125;-)?\d&#123;7,8&#125;$</span><br><span class="line">6、国内电话号码(0511-4405222、021-87888822)：\d&#123;3&#125;-\d&#123;8&#125;|\d&#123;4&#125;-\d&#123;7&#125;</span><br><span class="line">7、身份证号(15位、18位数字)：^\d&#123;15&#125;|\d&#123;18&#125;$</span><br><span class="line">8、短身份证号码(数字、字母x结尾)：^([0-9])&#123;7,18&#125;(x|X)?$ 或 ^\d&#123;8,18&#125;|[0-9x]&#123;8,18&#125;|[0-9X]&#123;8,18&#125;?$</span><br><span class="line">9、帐号是否合法(字母开头，允许5-16字节，允许字母数字下划线)：^[a-zA-Z][a-zA-Z0-9_]&#123;4,15&#125;$</span><br><span class="line">10、密码(以字母开头，长度在6~18之间，只能包含字母、数字和下划线)：^[a-zA-Z]\w&#123;5,17&#125;$</span><br><span class="line">11、强密码(必须包含大小写字母和数字的组合，不能使用特殊字符，长度在8-10之间)：^(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).&#123;8,10&#125;$</span><br><span class="line">12、日期格式：^\d&#123;4&#125;-\d&#123;1,2&#125;-\d&#123;1,2&#125;</span><br><span class="line">13、一年的12个月(01～09和1～12)：^(0?[1-9]|1[0-2])$</span><br><span class="line">14 、一个月的31天(01～09和1～31)：^((0?[1-9])|((1|2)[0-9])|30|31)$</span><br><span class="line">15、钱的输入格式：</span><br><span class="line">* 有四种钱的表示形式我们可以接受:&quot;10000.00&quot; 和 &quot;10,000.00&quot;, 和没有 &quot;分&quot; 的 &quot;10000&quot; 和 &quot;10,000&quot;：^[1-9][0-9]*$</span><br><span class="line">* 这表示任意一个不以0开头的数字,但是,这也意味着一个字符&quot;0&quot;不通过,所以我们采用下面的形式：^(0|[1-9][0-9]*)$</span><br><span class="line">* 一个0或者一个不以0开头的数字.我们还可以允许开头有一个负号：^(0|-?[1-9][0-9]*)$</span><br><span class="line">* 这表示一个0或者一个可能为负的开头不为0的数字.让用户以0开头好了.把负号的也去掉,因为钱总不能是负的吧.下面我们要加的是说明可能的小数部分：^[0-9]+(.[0-9]+)?$</span><br><span class="line">* 5.必须说明的是,小数点后面至少应该有1位数,所以&quot;10.&quot;是不通过的,但是 &quot;10&quot; 和 &quot;10.2&quot; 是通过的：^[0-9]+(.[0-9]&#123;2&#125;)?$</span><br><span class="line">* 6.这样我们规定小数点后面必须有两位,如果你认为太苛刻了,可以这样：^[0-9]+(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line">* 这样就允许用户只写一位小数.下面我们该考虑数字中的逗号了,我们可以这样：^[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line">* 1到3个数字,后面跟着任意个 逗号+3个数字,逗号成为可选,而不是必须：^([0-9]+|[0-9]&#123;1,3&#125;(,[0-9]&#123;3&#125;)*)(.[0-9]&#123;1,2&#125;)?$</span><br><span class="line">* 备注：这就是最终结果了,别忘了&quot;+&quot;可以用&quot;*&quot;替代如果你觉得空字符串也可</span><br><span class="line">* 以接受的话(奇怪,为什么?)最后,别忘了在用函数时去掉去掉那个反斜杠,一般的错误都在这里</span><br><span class="line">16、xml文件：^([a-zA-Z]+-?)+[a-zA-Z0-9]+\\.[x|X][m|M][l|L]$</span><br><span class="line">17、中文字符的正则表达式：[\u4e00-\u9fa5]</span><br><span class="line">18、双字节字符：[^\x00-\xff] (包括汉字在内，可以用来计算字符串的长度(一个双字节字符长度计2，ASCII字符计1))</span><br><span class="line">19、空白行的正则表达式：\n\s*\r (可以用来删除空白行)</span><br><span class="line">20、HTML标记的正则表达式：&lt;(\S*?)[^&gt;]*&gt;.*?&lt;/\1&gt;|&lt;.*? /&gt; (网上流传的版本太糟糕，上面这个也仅仅能部分，对于复杂的嵌套标记依旧无能为力)</span><br><span class="line">21、首尾空白字符的正则表达式：^\s*|\s*$或(^\s*)|(\s*$) (可以用来删除行首行尾的空白字符(包括空格、制表符、换页符等等)，非常有用的表达式)</span><br><span class="line">22、 腾讯QQ号：[1-9][0-9]&#123;4,&#125; (腾讯QQ号从10000开始)</span><br><span class="line">23、中国邮政编码：[1-9]\d&#123;5&#125;(?!\d) (中国邮政编码为6位数字)</span><br><span class="line">24、IP地址：\d+\.\d+\.\d+\.\d+ (提取IP地址时有用)</span><br><span class="line">25、 IP地址：((?:(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d)\\.)&#123;3&#125;(?:25[0-5]|2[0-4]\\d|[01]?\\d?\\d))</span><br></pre></td></tr></table></figure>



<h2 id="进程和线程"><a href="#进程和线程" class="headerlink" title="进程和线程"></a>进程和线程</h2><p>单核CPU操作系统轮流让各个任务交替执行，任务1执行0.01秒，切换到任务2，任务2执行0.01秒，再切换到任务3，执行0.01秒……这样反复执行下去。表面上看，每个任务都是交替执行的，但是，由于CPU的执行速度实在是太快了，我们感觉就像所有任务都在同时执行一样。</p>
<p>真正的并行执行多任务只能在多核CPU上实现，但是，由于任务数量远远多于CPU的核心数量，所以，操作系统也会自动把很多任务轮流调度到每个核心上执行</p>
<p>对于操作系统来说，一个任务就是一个进程（Process）</p>
<p>Python既支持多进程，又支持多线程。python实现多任务有3中模式：</p>
<ul>
<li>多进程模式；</li>
<li>多线程模式；</li>
<li>多进程+多线程模式。</li>
</ul>
<p>线程是最小的执行单元，而进程由至少一个线程组成。如何调度进程和线程，完全由操作系统决定，程序自己不能决定什么时候执行，执行多长时间。</p>
<p>多进程和多线程的程序涉及到同步、数据共享的问题，编写起来更复杂。</p>
<h3 id="多进程"><a href="#多进程" class="headerlink" title="多进程"></a>多进程</h3><p>Unix&#x2F;Linux操作系统提供了一个<code>fork()</code>系统调用，fork()系统调用在Unix&#x2F;Linux操作系统中非常特殊，它会创建一个新的进程（子进程），该子进程是父进程的副本。父进程和子进程在执行fork()系统调用之后会继续执行接下来的代码。父进程中，fork()函数返回子进程的PID（Process ID），而在子进程中，fork()函数返回0。</p>
<p><strong>调用fork - Unix&#x2F;Linux</strong></p>
<p><code>os</code>模块封装了常见的系统调用，其中<code>fork</code>可以在Python程序中轻松创建子进程</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">child_process</span>():  </span><br><span class="line">    <span class="comment"># 子进程代码  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;I am child process (%s) and my parent is %s.&#x27;</span> % (os.getpid(), os.getppid()))</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parent_process</span>():  </span><br><span class="line">    <span class="comment"># 父进程代码  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;I (%s) just created a child process (%s).&#x27;</span> % (os.getpid(), pid))  </span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(<span class="string">&#x27;Process (%s) start...&#x27;</span> % os.getpid())  </span><br><span class="line">pid = os.fork()  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> pid == <span class="number">0</span>:  </span><br><span class="line">    <span class="comment"># 子进程执行child_process函数  </span></span><br><span class="line">    child_process()  </span><br><span class="line"><span class="keyword">else</span>:  </span><br><span class="line">    <span class="comment"># 父进程执行parent_process函数  </span></span><br><span class="line">    parent_process()</span><br></pre></td></tr></table></figure>

<p><strong>multiprocessing</strong></p>
<p>由于Windows没有<code>fork</code>调用，上面的代码在Windows上无法运行。<br><code>multiprocessing</code>模块就是跨平台版本的多进程模块</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">child_process</span>():  </span><br><span class="line">    <span class="comment"># 子进程代码  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;I am child process (%s) and my parent is %s.&#x27;</span> % (os.getpid(), os.getppid()))  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">parent_process</span>():  </span><br><span class="line">    <span class="comment"># 父进程代码  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;I (%s) just created a child process.&#x27;</span> % os.getpid())  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:  </span><br><span class="line">    <span class="comment"># 主程序开始执行  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Process (%s) start...&#x27;</span> % os.getpid())  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 创建子进程并指定执行的函数为child_process()  </span></span><br><span class="line">    p = multiprocessing.Process(target=child_process)  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 启动子进程  </span></span><br><span class="line">    p.start()  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 等待子进程结束，这样可以确保父进程在子进程完成后再继续执行。  </span></span><br><span class="line">    p.join()  </span><br><span class="line"></span><br><span class="line">    <span class="comment"># 执行parent_process()函数，此时已经是父进程了。  </span></span><br><span class="line">    parent_process()</span><br></pre></td></tr></table></figure>



<p><strong>Pool - 进程池</strong></p>
<p>如果要启动大量的子进程，可以用进程池的方式批量创建子进程</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing  </span><br><span class="line"><span class="keyword">import</span> os  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">worker</span>(<span class="params">num</span>):  </span><br><span class="line">    <span class="comment"># 子进程代码  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Worker %s is running (pid=%s)...&#x27;</span> % (num, os.getpid()))  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:  </span><br><span class="line">    <span class="comment"># 主程序开始执行  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Parent process is running (pid=%s)...&#x27;</span> % os.getpid())  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 创建一个包含4个进程的进程池  </span></span><br><span class="line">    pool = multiprocessing.Pool(processes=<span class="number">4</span>)  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 使用进程池执行worker函数，参数为0~3  </span></span><br><span class="line">    pool.<span class="built_in">map</span>(worker, <span class="built_in">range</span>(<span class="number">4</span>))  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 关闭进程池  </span></span><br><span class="line">    pool.close()  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 等待所有子进程结束  </span></span><br><span class="line">    pool.join()  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 所有子进程结束后，主进程继续执行  </span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;All workers done.&#x27;</span>)</span><br></pre></td></tr></table></figure>



<p><strong>子进程 - 交互</strong></p>
<p>很多时候，子进程并不是自身，而是一个外部进程。我们创建了子进程后，还需要控制子进程的输入和输出。</p>
<p><code>subprocess</code>模块可以让我们非常方便地启动一个子进程，然后控制其输入和输出。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_command</span>(<span class="params">command</span>):</span><br><span class="line">    <span class="comment"># 运行外部命令并获取输出</span></span><br><span class="line">    result = subprocess.run(command, shell=<span class="literal">True</span>, capture_output=<span class="literal">True</span>, text=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查命令是否成功执行</span></span><br><span class="line">    <span class="keyword">if</span> result.returncode == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Command &#x27;<span class="subst">&#123;command&#125;</span>&#x27; executed successfully.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Output:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(result.stdout)</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error executing command &#x27;<span class="subst">&#123;command&#125;</span>&#x27;.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Error output:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(result.stderr)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 主程序开始执行</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Parent process is running (pid=%s)...&#x27;</span> % os.getpid())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 定义要运行的命令，可以根据不同操作系统选择不同的命令</span></span><br><span class="line">    command = <span class="string">&quot;ls -l&quot;</span> <span class="keyword">if</span> os.name != <span class="string">&#x27;nt&#x27;</span> <span class="keyword">else</span> <span class="string">&quot;dir&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 运行命令</span></span><br><span class="line">    run_command(command)</span><br></pre></td></tr></table></figure>

<p>通过 communicate() 方法与进程交互</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> subprocess</span><br><span class="line"><span class="keyword">import</span> os</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_command</span>(<span class="params">command</span>):</span><br><span class="line">    <span class="comment"># 运行外部命令并获取输出</span></span><br><span class="line">    process = subprocess.Popen(command, shell=<span class="literal">True</span>, stdout=subprocess.PIPE, stderr=subprocess.PIPE,stdin=subprocess.PIPE, text=<span class="literal">True</span>)</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 与进程交互，可以向进程输入数据</span></span><br><span class="line">    input_data = <span class="string">&quot;Input data to the process&quot;</span></span><br><span class="line">    process.stdin.write(input_data)</span><br><span class="line">    process.stdin.close()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 获取进程的输出和错误信息</span></span><br><span class="line">    output, error = process.communicate()</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 检查命令是否成功执行</span></span><br><span class="line">    <span class="keyword">if</span> process.returncode == <span class="number">0</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Command &#x27;<span class="subst">&#123;command&#125;</span>&#x27; executed successfully.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Output:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(output.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line">    <span class="keyword">else</span>:</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Error executing command &#x27;<span class="subst">&#123;command&#125;</span>&#x27;.&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(<span class="string">&quot;Error output:&quot;</span>)</span><br><span class="line">        <span class="built_in">print</span>(error.decode(<span class="string">&#x27;utf-8&#x27;</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:</span><br><span class="line">    <span class="comment"># 主程序开始执行</span></span><br><span class="line">    <span class="built_in">print</span>(<span class="string">&#x27;Parent process is running (pid=%s)...&#x27;</span> % os.getpid())</span><br><span class="line"></span><br><span class="line">    <span class="comment"># 定义要运行的命令，可以根据不同操作系统选择不同的命令</span></span><br><span class="line">    command = <span class="string">&quot;ls -l&quot;</span> <span class="keyword">if</span> os.name != <span class="string">&#x27;nt&#x27;</span> <span class="keyword">else</span> <span class="string">&quot;dir&quot;</span></span><br><span class="line"></span><br><span class="line">    <span class="comment"># 运行命令</span></span><br><span class="line">    run_command(command)</span><br></pre></td></tr></table></figure>



<p><strong>进程间通信</strong></p>
<p>进程与进程之间肯定是需要通信的，操作系统提供了很多机制来实现进程间的通信</p>
<p>Python的<code>multiprocessing</code>模块包装了底层的机制，提供了<code>Queue</code>、<code>Pipes</code>等多种方式来交换数据。</p>
<ol>
<li>在使用 <code>multiprocessing</code> 模块进行进程间通信时，需要注意数据的序列化和反序列化问题。因为不同进程之间的内存空间是独立的，所以需要将数据序列化后再传输到另一个进程中进行反序列化。</li>
<li>在使用 <code>subprocess</code> 模块启动子进程并与其进行交互时，需要注意输入和输出的缓冲区问题。如果子进程的输出数据量很大，可能会导致缓冲区溢出，从而导致程序出现异常。可以使用 <code>communicate()</code> 方法来避免这个问题，该方法会等待子进程结束并获取其输出和错误信息。</li>
</ol>
<ul>
<li>Queue - 队列</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">producer</span>(<span class="params">queue</span>):  </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10</span>):  </span><br><span class="line">        queue.put(i)  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Producer put <span class="subst">&#123;i&#125;</span> into queue.&quot;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">consumer</span>(<span class="params">queue</span>):  </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:  </span><br><span class="line">        item = queue.get()  </span><br><span class="line">        <span class="keyword">if</span> item <span class="keyword">is</span> <span class="literal">None</span>:  </span><br><span class="line">            <span class="keyword">break</span>  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Consumer got <span class="subst">&#123;item&#125;</span> from queue.&quot;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:  </span><br><span class="line">    <span class="comment"># 创建一个进程间通信的队列  </span></span><br><span class="line">    queue = multiprocessing.Queue()  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 创建一个生产者进程和一个消费者进程  </span></span><br><span class="line">    producer_process = multiprocessing.Process(target=producer, args=(queue,))  </span><br><span class="line">    consumer_process = multiprocessing.Process(target=consumer, args=(queue,))  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 启动进程  </span></span><br><span class="line">    producer_process.start()  </span><br><span class="line">    consumer_process.start()  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 等待生产者进程结束并向队列中添加结束标志  </span></span><br><span class="line">    producer_process.join()  </span><br><span class="line">    queue.put(<span class="literal">None</span>)  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 等待消费者进程结束  </span></span><br><span class="line">    consumer_process.join()</span><br></pre></td></tr></table></figure>

<ul>
<li>Pipe - 管道</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> multiprocessing  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">sender</span>(<span class="params">conn</span>):  </span><br><span class="line">    conn.send(<span class="string">&quot;Hello, receiver!&quot;</span>)  </span><br><span class="line">    conn.close()  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">receiver</span>(<span class="params">conn</span>):  </span><br><span class="line">    msg = conn.recv()  </span><br><span class="line">    <span class="built_in">print</span>(<span class="string">f&quot;Received message: <span class="subst">&#123;msg&#125;</span>&quot;</span>)  </span><br><span class="line">    conn.close()  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:  </span><br><span class="line">    <span class="comment"># 创建管道  </span></span><br><span class="line">    parent_conn, child_conn = multiprocessing.Pipe()  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 创建发送者进程和接收者进程  </span></span><br><span class="line">    sender_process = multiprocessing.Process(target=sender, args=(parent_conn,))  </span><br><span class="line">    receiver_process = multiprocessing.Process(target=receiver, args=(child_conn,))  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 启动进程  </span></span><br><span class="line">    sender_process.start()  </span><br><span class="line">    receiver_process.start()  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 等待进程结束  </span></span><br><span class="line">    sender_process.join()  </span><br><span class="line">    receiver_process.join()</span><br></pre></td></tr></table></figure>



<h3 id="多线程"><a href="#多线程" class="headerlink" title="多线程"></a>多线程</h3><p>多任务可以由多进程完成，也可以由一个进程内的多线程完成</p>
<p>进程是由若干线程组成的，一个进程至少有一个线程</p>
<p>由于线程是操作系统直接支持的执行单元，因此，高级语言通常都内置多线程的支持</p>
<p><strong>threading</strong></p>
<p>Python的标准库提供了两个模块：<code>_thread</code>和<code>threading</code>，<code>_thread</code>是低级模块，<code>threading</code>是高级模块，对<code>_thread</code>进行了封装。绝大多数情况下，我们只需要使用<code>threading</code>这个高级模块。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> threading  </span><br><span class="line"><span class="keyword">import</span> time  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个函数作为线程的执行体  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">thread_task</span>(<span class="params">name</span>):  </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">5</span>):  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&#x27;Thread <span class="subst">&#123;name&#125;</span>: <span class="subst">&#123;i&#125;</span>&#x27;</span>)  </span><br><span class="line">        time.sleep(<span class="number">1</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建两个线程并启动它们  </span></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:  </span><br><span class="line">    t1 = threading.Thread(target=thread_task, args=(<span class="string">&#x27;A&#x27;</span>,))  </span><br><span class="line">    t2 = threading.Thread(target=thread_task, args=(<span class="string">&#x27;B&#x27;</span>,))  </span><br><span class="line"></span><br><span class="line">    <span class="comment"># 启动线程  </span></span><br><span class="line">    t1.start()  </span><br><span class="line">    t2.start()  </span><br><span class="line"></span><br><span class="line">    <span class="comment"># 等待两个线程结束  </span></span><br><span class="line">    t1.join()  </span><br><span class="line">    t2.join()</span><br></pre></td></tr></table></figure>

<p>注意项：</p>
<ul>
<li>全局变量共享问题：多个线程可以访问和修改相同的全局变量，因此需要确保对共享数据的访问是安全的。</li>
<li>线程同步：使用锁或者其他同步机制来避免多个线程同时修改共享资源。</li>
<li>GIL（全局解释器锁）：Python语言的GIL限制了同一时间只能有一个线程执行Python字节码。因此在CPU密集型任务中，并发性能可能无法得到提升。</li>
</ul>
<p><strong>Lock</strong></p>
<p>多线程和多进程最大的不同在于，多进程中，同一个变量，各自有一份拷贝存在于每个进程中，互不影响，而多线程中，所有变量都由所有线程共享，所以，任何一个变量都可以被任何一个线程修改，因此，线程之间共享数据最大的危险在于多个线程同时改一个变量，把内容给改乱了。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time, threading</span><br><span class="line"></span><br><span class="line"><span class="comment"># 假定这是你的银行存款:  </span></span><br><span class="line">balance = <span class="number">0</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义一个函数用于改变账户余额（模拟存取款操作）  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_it</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">global</span> balance</span><br><span class="line">    <span class="comment"># 先存后取，结果应该为0:  </span></span><br><span class="line">    balance = balance + n</span><br><span class="line">    balance = balance - n</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 线程执行体，对账户进行多次存取款操作  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_thread</span>(<span class="params">n</span>):</span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000000</span>):</span><br><span class="line">        change_it(n)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建并启动两个线程来同时对账户进行存取款操作，两个线程同时一存一取，就可能导致余额不对</span></span><br><span class="line">t1 = threading.Thread(target=run_thread, args=(<span class="number">5</span>,))</span><br><span class="line">t2 = threading.Thread(target=run_thread, args=(<span class="number">8</span>,))</span><br><span class="line">t1.start()</span><br><span class="line">t2.start()</span><br><span class="line">t1.join()</span><br><span class="line">t2.join()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(balance)</span><br><span class="line"></span><br></pre></td></tr></table></figure>

<p>如果我们要确保<code>balance</code>计算正确，就要给<code>change_it()</code>上一把锁，当某个线程开始执行<code>change_it()</code>时，该线程因为获得了锁，因此其他线程不能同时执行<code>change_it()</code>，只能等待，直到锁被释放后，获得该锁以后才能改</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> time, threading  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 假定这是你的银行存款:  </span></span><br><span class="line">balance = <span class="number">0</span>  </span><br><span class="line">lock = threading.Lock()  <span class="comment"># 创建一个锁对象  </span></span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">change_it</span>(<span class="params">n</span>):  </span><br><span class="line">    <span class="keyword">global</span> balance  </span><br><span class="line">    balance += n  </span><br><span class="line">    balance -= n  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">run_thread</span>(<span class="params">n</span>):  </span><br><span class="line">    <span class="keyword">for</span> i <span class="keyword">in</span> <span class="built_in">range</span>(<span class="number">10000000</span>):  </span><br><span class="line">        lock.acquire()  <span class="comment"># 获取锁  </span></span><br><span class="line">        <span class="keyword">try</span>:  </span><br><span class="line">            change_it(n)  </span><br><span class="line">        <span class="keyword">finally</span>:  </span><br><span class="line">            lock.release()  <span class="comment"># 释放锁  </span></span><br><span class="line"></span><br><span class="line">t1 = threading.Thread(target=run_thread, args=(<span class="number">5</span>,))  </span><br><span class="line">t2 = threading.Thread(target=run_thread, args=(<span class="number">8</span>,))  </span><br><span class="line">t1.start()  </span><br><span class="line">t2.start()  </span><br><span class="line">t1.join()</span><br><span class="line">t2.join()</span><br><span class="line"></span><br><span class="line"><span class="built_in">print</span>(balance)</span><br></pre></td></tr></table></figure>



<h3 id="计算密集型-vs-IO密集型"><a href="#计算密集型-vs-IO密集型" class="headerlink" title="计算密集型 vs. IO密集型"></a>计算密集型 vs. IO密集型</h3><p>是否采用多任务的第二个考虑是任务的类型。我们可以把任务分为计算密集型和IO密集型。</p>
<ul>
<li><p>计算密集型</p>
<p>计算密集型任务的特点是要进行大量的计算，消耗CPU资源。这种计算密集型任务虽然也可以用多任务完成，但是任务越多，花在任务切换的时间就越多，CPU执行任务的效率就越低</p>
</li>
<li><p>IO密集型</p>
<p>IO密集型，涉及到网络、磁盘IO的任务都是IO密集型任务，这类任务的特点是CPU消耗很少，任务的大部分时间都在等待IO操作完成。对于IO密集型任务，任务越多，CPU效率越高</p>
</li>
</ul>
<h3 id="异步IO"><a href="#异步IO" class="headerlink" title="异步IO"></a>异步IO</h3><p>CPU和IO之间巨大的速度差异，一个任务在执行的过程中大部分时间都在等待IO操作，单进程单线程模型会导致别的任务无法并行执行，因此，我们才需要多进程模型或者多线程模型来支持多任务并发执行。</p>
<p>现代操作系统对IO操作就是支持异步IO。充分利用操作系统提供的异步IO支持，就可以用单进程单线程模型来执行多任务，这种全新的模型称为事件驱动模型</p>
<h3 id="分布式进程"><a href="#分布式进程" class="headerlink" title="分布式进程"></a>分布式进程</h3><p>Python的<code>multiprocessing</code>模块不但支持多进程，其中<code>managers</code>子模块还支持把多进程分布到多台机器上。一个服务进程可以作为调度者，将任务分布到其他多个进程中，依靠网络通信。</p>
<p>案例：假设我们有两台机器：Machine A 和 Machine B。原先的多进程程序在 Machine A 上运行，包括发送任务的进程和处理任务的进程。现在我们希望将发送任务的进程迁移到 Machine B 上，与处理任务的进程分开运行。</p>
<p><strong>重点难点</strong></p>
<ol>
<li><strong>通信机制更新</strong>：需要更新原先基于 Queue 的通信机制，以适应跨机器通信。</li>
<li><strong>网络配置</strong>：确保两台机器能够相互通信，可以考虑使用网络协议如TCP&#x2F;IP。</li>
<li><strong>错误处理</strong>：处理跨机器通信可能会引入新的错误类型，需要考虑如何处理这些错误情况。</li>
</ol>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 在 Machine A 上运行的发送任务的进程  </span></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process, Queue  </span><br><span class="line"><span class="keyword">import</span> time  </span><br><span class="line"><span class="keyword">import</span> random  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">send_task</span>(<span class="params">queue</span>):  </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:  </span><br><span class="line">        <span class="comment"># 生成一个随机任务  </span></span><br><span class="line">        task = random.randint(<span class="number">1</span>, <span class="number">100</span>)  </span><br><span class="line">        <span class="comment"># 将任务放入队列  </span></span><br><span class="line">        queue.put(task)  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Sent task: <span class="subst">&#123;task&#125;</span>&quot;</span>)  </span><br><span class="line">        <span class="comment"># 等待一段时间再发送下一个任务  </span></span><br><span class="line">        time.sleep(random.randint(<span class="number">1</span>, <span class="number">5</span>))  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:  </span><br><span class="line">    <span class="comment"># 创建一个队列  </span></span><br><span class="line">    queue = Queue()  </span><br><span class="line">    <span class="comment"># 创建一个发送任务的进程  </span></span><br><span class="line">    send_process = Process(target=send_task, args=(queue,))  </span><br><span class="line">    <span class="comment"># 启动发送任务的进程  </span></span><br><span class="line">    send_process.start()  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 在 Machine B 上运行的处理任务的进程  </span></span><br><span class="line"><span class="keyword">from</span> multiprocessing <span class="keyword">import</span> Process, Queue  </span><br><span class="line"><span class="keyword">import</span> time  </span><br><span class="line"></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">process_task</span>(<span class="params">queue</span>):  </span><br><span class="line">    <span class="keyword">while</span> <span class="literal">True</span>:  </span><br><span class="line">        <span class="comment"># 从队列中获取任务  </span></span><br><span class="line">        task = queue.get()  </span><br><span class="line">        <span class="built_in">print</span>(<span class="string">f&quot;Processing task: <span class="subst">&#123;task&#125;</span>&quot;</span>)  </span><br><span class="line">        <span class="comment"># 模拟处理任务的时间  </span></span><br><span class="line">        time.sleep(<span class="number">5</span>)  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&#x27;__main__&#x27;</span>:  </span><br><span class="line">    <span class="comment"># 创建一个队列  </span></span><br><span class="line">    queue = Queue()  </span><br><span class="line">    <span class="comment"># 创建一个处理任务的进程  </span></span><br><span class="line">    process_process = Process(target=process_task, args=(queue,))  </span><br><span class="line">    <span class="comment"># 启动处理任务的进程  </span></span><br><span class="line">    process_process.start()</span><br></pre></td></tr></table></figure>

<p>注意Queue的作用是用来传递任务和接收结果，每个任务的描述数据量要尽量小。比如发送一个处理日志文件的任务，就不要发送几百兆的日志文件本身，而是发送日志文件存放的完整路径，由Worker进程再去共享的磁盘上读取文件。</p>
<h2 id="异步IO-1"><a href="#异步IO-1" class="headerlink" title="异步IO"></a>异步IO</h2><h3 id="协程"><a href="#协程" class="headerlink" title="协程"></a>协程</h3><p>协程，又称微线程</p>
<p>协程是一种轻量级的并发编程方式，它可以在一个线程中实现多个任务的切换和调度。Python中的协程通过使用<code>asyncio</code>库来实现。</p>
<ol>
<li>异步IO操作：协程通常用于处理IO密集型任务，例如网络请求或文件读写。了解如何使用协程来执行异步IO操作，并通过<code>asyncio</code>库中提供的异步IO函数来实现非阻塞的IO操作。</li>
<li>协程的调度和并发：了解如何使用<code>asyncio</code>库来调度和并发执行多个协程任务。这包括使用<code>asyncio</code>提供的事件循环（event loop）来调度协程的执行顺序，以及使用<code>asyncio</code>中的<code>asyncio.gather()</code>函数来并发执行多个协程任务。</li>
<li>错误处理和异常处理：了解如何处理协程中可能出现的错误和异常情况。包括使用<code>try-except</code>语句来捕获和处理异常，以及使用<code>asyncio</code>库中提供的错误处理机制来处理协程中的异常情况。</li>
</ol>
<h3 id="asyncio"><a href="#asyncio" class="headerlink" title="asyncio"></a>asyncio</h3><p><code>asyncio</code>是Python 3.4版本引入的标准库，直接内置了对异步IO的支持。</p>
<p><code>asyncio</code>的编程模型就是一个消息循环。<code>asyncio</code>模块内部实现了<code>EventLoop</code>，把需要执行的协程扔到<code>EventLoop</code>中执行，就实现了异步IO。</p>
<p>用<code>asyncio</code>提供的<code>@asyncio.coroutine</code>可以把一个<code>generator</code>标记为<code>coroutine</code>类型，然后在<code>coroutine</code>内部用<code>yield from</code>调用另一个<code>coroutine</code>实现异步操作。</p>
<p>为了简化并更好地标识异步IO，从Python 3.5开始引入了新的语法<code>async</code>和<code>await</code>，可以让<code>coroutine</code>的代码更简洁易读。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> asyncio</span><br><span class="line"><span class="keyword">import</span> aiohttp</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">fetch_url</span>(<span class="params">url</span>):</span><br><span class="line">    <span class="keyword">async</span> <span class="keyword">with</span> aiohttp.ClientSession() <span class="keyword">as</span> session:</span><br><span class="line">        <span class="keyword">async</span> <span class="keyword">with</span> session.get(url) <span class="keyword">as</span> response:</span><br><span class="line">            <span class="keyword">return</span> <span class="keyword">await</span> response.text()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">async</span> <span class="keyword">def</span> <span class="title function_">main</span>():</span><br><span class="line">    urls = [</span><br><span class="line">        <span class="string">&#x27;https://www.baidu.com&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.taobao.com&#x27;</span>,</span><br><span class="line">        <span class="string">&#x27;https://www.jd.com&#x27;</span></span><br><span class="line">    ]</span><br><span class="line"></span><br><span class="line">    tasks = [fetch_url(url) <span class="keyword">for</span> url <span class="keyword">in</span> urls]</span><br><span class="line"></span><br><span class="line">    results = <span class="keyword">await</span> asyncio.gather(*tasks)</span><br><span class="line"></span><br><span class="line">    <span class="keyword">for</span> result <span class="keyword">in</span> results:</span><br><span class="line">        <span class="built_in">print</span>(result)</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> __name__ == <span class="string">&quot;__main__&quot;</span>:</span><br><span class="line">    loop = asyncio.get_event_loop()</span><br><span class="line">    loop.run_until_complete(main())</span><br></pre></td></tr></table></figure>



<h3 id="aiohttp"><a href="#aiohttp" class="headerlink" title="aiohttp"></a>aiohttp</h3><p>pass</p>
<h2 id="数据库操作"><a href="#数据库操作" class="headerlink" title="数据库操作"></a>数据库操作</h2><h3 id="SQLite"><a href="#SQLite" class="headerlink" title="SQLite"></a>SQLite</h3><p>SQLite是一种嵌入式数据库，它的数据库就是一个文件。由于SQLite本身是C写的，而且体积很小，所以，经常被集成到各种应用程序中，甚至在iOS和Android的App中都可以集成。</p>
<p>Python就内置了SQLite3，所以，在Python中使用SQLite，不需要安装任何东西，直接使用。</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> sqlite3  </span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">SQLiteConnection</span>:  </span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__enter__</span>(<span class="params">self</span>):  </span><br><span class="line">        <span class="comment"># 连接到SQLite数据库  </span></span><br><span class="line">        <span class="comment"># 数据库文件是test.db  </span></span><br><span class="line">        <span class="comment"># 如果文件不存在，会自动在当前目录创建  </span></span><br><span class="line">        self.conn = sqlite3.connect(<span class="string">&#x27;test.db&#x27;</span>)  </span><br><span class="line">        <span class="comment"># 创建一个Cursor  </span></span><br><span class="line">        self.cursor = self.conn.cursor()  </span><br><span class="line">        <span class="keyword">return</span> self.cursor  </span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__exit__</span>(<span class="params">self, exc_type, exc_val, exc_tb</span>):  </span><br><span class="line">        <span class="comment"># 关闭Cursor  </span></span><br><span class="line">        <span class="keyword">if</span> self.cursor:  </span><br><span class="line">            self.cursor.close()  </span><br><span class="line">        <span class="comment"># 提交事务并关闭连接  </span></span><br><span class="line">        <span class="keyword">if</span> self.conn:  </span><br><span class="line">            self.conn.commit()  </span><br><span class="line">            self.conn.close()  </span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> SQLiteConnection() <span class="keyword">as</span> cursor:  </span><br><span class="line">    <span class="comment"># 插入一条记录  </span></span><br><span class="line">    cursor.execute(<span class="string">&#x27;insert into user (id, name) values (?, ?)&#x27;</span>, (<span class="string">&#x27;2&#x27;</span>, <span class="string">&#x27;Alice&#x27;</span>))  </span><br><span class="line">    <span class="built_in">print</span>(cursor.rowcount)  </span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> SQLiteConnection() <span class="keyword">as</span> cursor:  </span><br><span class="line">    <span class="comment"># 更新记录  </span></span><br><span class="line">    cursor.execute(<span class="string">&#x27;update user set name = ? where id = ?&#x27;</span>, (<span class="string">&#x27;Bob&#x27;</span>, <span class="string">&#x27;2&#x27;</span>))  </span><br><span class="line">    <span class="built_in">print</span>(cursor.rowcount)  </span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> SQLiteConnection() <span class="keyword">as</span> cursor:  </span><br><span class="line">    <span class="comment"># 删除记录  </span></span><br><span class="line">    cursor.execute(<span class="string">&#x27;delete from user where id = ?&#x27;</span>, (<span class="string">&#x27;2&#x27;</span>,))  </span><br><span class="line">    <span class="built_in">print</span>(cursor.rowcount)</span><br></pre></td></tr></table></figure>



<h3 id="MySQL"><a href="#MySQL" class="headerlink" title="MySQL"></a>MySQL</h3><p><strong>安装mysql驱动</strong></p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install mysql-connector-python </span><br></pre></td></tr></table></figure>

<p><strong>使用案例</strong></p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> mysql.connector</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">MySQLConnection</span>:</span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__enter__</span>(<span class="params">self</span>):</span><br><span class="line">        <span class="comment"># 建立数据库连接</span></span><br><span class="line">        self.conn = mysql.connector.connect(user=<span class="string">&#x27;root&#x27;</span>, password=<span class="string">&#x27;root&#x27;</span>, database=<span class="string">&#x27;blog&#x27;</span>)</span><br><span class="line">        <span class="comment"># 创建游标对象</span></span><br><span class="line">        self.cursor = self.conn.cursor()</span><br><span class="line">        <span class="keyword">return</span> self.cursor</span><br><span class="line"></span><br><span class="line">    <span class="keyword">def</span> <span class="title function_">__exit__</span>(<span class="params">self, exc_type, exc_val, exc_tb</span>):</span><br><span class="line">        <span class="comment"># 关闭游标</span></span><br><span class="line">        <span class="keyword">if</span> self.cursor:</span><br><span class="line">            self.cursor.close()</span><br><span class="line">            <span class="comment"># 提交事务并关闭连接</span></span><br><span class="line">        <span class="keyword">if</span> self.conn:</span><br><span class="line">            self.conn.commit()</span><br><span class="line">            self.conn.close()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> MySQLConnection() <span class="keyword">as</span> cursor:</span><br><span class="line">    <span class="comment"># 创建user表</span></span><br><span class="line">    cursor.execute(<span class="string">&#x27;create table user (id varchar(20) primary key, name varchar(20))&#x27;</span>)</span><br><span class="line">    <span class="comment"># 插入一行记录</span></span><br><span class="line">    cursor.execute(<span class="string">&#x27;insert into user (id, name) values (%s, %s)&#x27;</span>, [<span class="string">&#x27;1&#x27;</span>, <span class="string">&#x27;Michael&#x27;</span>])</span><br><span class="line">    <span class="built_in">print</span>(cursor.rowcount)</span><br><span class="line"></span><br><span class="line"><span class="keyword">with</span> MySQLConnection() <span class="keyword">as</span> cursor:</span><br><span class="line">    <span class="comment"># 查询记录</span></span><br><span class="line">    cursor.execute(<span class="string">&#x27;select * from t_user where id = %s&#x27;</span>, (<span class="string">&#x27;1&#x27;</span>,))</span><br><span class="line">    row = cursor.fetchone()</span><br><span class="line">    columns = [col[<span class="number">0</span>] <span class="keyword">for</span> col <span class="keyword">in</span> cursor.description]  <span class="comment"># 获取列名</span></span><br><span class="line">    data = <span class="built_in">dict</span>(<span class="built_in">zip</span>(columns, row))  <span class="comment"># 将列名和数据对应转换成字典</span></span><br><span class="line">    <span class="built_in">print</span>(data)</span><br><span class="line"></span><br></pre></td></tr></table></figure>





<h3 id="SQLAlchemy"><a href="#SQLAlchemy" class="headerlink" title="SQLAlchemy"></a>SQLAlchemy</h3><ul>
<li><p>连接已有数据库</p>
<p>连接mysql需要额外安装mysql驱动 mysql-connector-python , 才能成功连接</p>
<figure class="highlight bash"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">pip install mysql-connector-python  </span><br></pre></td></tr></table></figure></li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> Column, String, create_engine, DateTime, Integer</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> sessionmaker</span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> declarative_base</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建对象的基类:</span></span><br><span class="line">Base = declarative_base()</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义User对象:</span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(<span class="title class_ inherited__">Base</span>):</span><br><span class="line">    __tablename__ = <span class="string">&#x27;t_user&#x27;</span></span><br><span class="line">	</span><br><span class="line">    <span class="comment"># 数据库表结构  可以在mysql中DESCRIBE t_user; 查看表结构</span></span><br><span class="line">    <span class="built_in">id</span> = Column(String(<span class="number">20</span>), primary_key=<span class="literal">True</span>)</span><br><span class="line">    avatar = Column(String(<span class="number">255</span>))</span><br><span class="line">    create_time = Column(DateTime)</span><br><span class="line">    email = Column(String(<span class="number">255</span>))</span><br><span class="line">    nickname = Column(String(<span class="number">255</span>))</span><br><span class="line">    password = Column(String(<span class="number">255</span>))</span><br><span class="line">    <span class="built_in">type</span> = Column(Integer)</span><br><span class="line">    update_time = Column(DateTime)</span><br><span class="line">    username = Column(String(<span class="number">255</span>))</span><br><span class="line"></span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化数据库连接:</span></span><br><span class="line">engine = create_engine(<span class="string">&#x27;mysql+mysqlconnector://root:root@localhost:3306/blog&#x27;</span>)</span><br><span class="line"><span class="comment"># 创建DBSession类型:</span></span><br><span class="line">DBSession = sessionmaker(bind=engine)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>查找数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">## 所有查找 等同于 select * from t_user;</span></span><br><span class="line"><span class="comment"># 创建会话</span></span><br><span class="line">session = DBSession()</span><br><span class="line"><span class="comment"># 查询所有用户数据</span></span><br><span class="line">users = session.query(User).<span class="built_in">all</span>()</span><br><span class="line"><span class="comment"># 打印用户数据</span></span><br><span class="line"><span class="keyword">for</span> user <span class="keyword">in</span> users:</span><br><span class="line">    <span class="built_in">print</span>(user.<span class="built_in">id</span>, user.username)  <span class="comment"># 根据实际列名打印相应的数据</span></span><br><span class="line"><span class="comment"># 关闭会话</span></span><br><span class="line">session.close()</span><br><span class="line"></span><br><span class="line"><span class="comment">## 过滤查找 等同于 select * from t_user where id=&#x27;admin&#x27;;</span></span><br><span class="line"><span class="comment"># 创建会话  </span></span><br><span class="line">session = DBSession()  </span><br><span class="line"><span class="comment"># 查询用户名为 &quot;admin&quot; 的用户  </span></span><br><span class="line">user = session.query(User).filter_by(username=<span class="string">&quot;admin&quot;</span>).first()</span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="string">.first() 是 SQLAlchemy 查询的方法，用于获取查询结果中的第一个对象。如果查询返回多个结果，则只返回第一个匹配的对象；如果查询没有找到匹配项，则返回 None。</span></span><br><span class="line"><span class="string">如果要匹配多个结果，你可以使用 .all() 方法来获取查询返回的所有对象。</span></span><br><span class="line"><span class="string">users = session.query(User).filter_by(username=&quot;example_username&quot;).all()  </span></span><br><span class="line"><span class="string">for user in users:  </span></span><br><span class="line"><span class="string">    print(user.id, user.avatar, user.email)  </span></span><br><span class="line"><span class="string">&#x27;&#x27;&#x27;</span></span><br><span class="line"><span class="keyword">if</span> user:  </span><br><span class="line">    <span class="built_in">print</span>(user.<span class="built_in">id</span>, user.avatar, user.email)  </span><br><span class="line"><span class="comment"># 关闭会话  </span></span><br><span class="line">session.close()</span><br></pre></td></tr></table></figure>
</li>
<li><p>更新数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建会话  </span></span><br><span class="line">session = DBSession()  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询需要更新的用户  </span></span><br><span class="line">user = session.query(User).filter_by(username=<span class="string">&quot;admin&quot;</span>).first()  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> user:  </span><br><span class="line">    user.nickname = <span class="string">&quot;admin123&quot;</span>  <span class="comment"># 更新昵称  </span></span><br><span class="line">    session.commit()  <span class="comment"># 提交更改  </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭会话  </span></span><br><span class="line">session.close()</span><br></pre></td></tr></table></figure>
</li>
<li><p>新增数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建会话</span></span><br><span class="line">session = DBSession()</span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建一个新用户对象并填充所有字段</span></span><br><span class="line">new_user = User(</span><br><span class="line">    avatar=<span class="string">&#x27;https://example.com/avatar.jpg&#x27;</span>,</span><br><span class="line">    create_time=datetime.utcnow(),</span><br><span class="line">    email=<span class="string">&#x27;new_email@example.com&#x27;</span>,</span><br><span class="line">    nickname=<span class="string">&#x27;New User&#x27;</span>,</span><br><span class="line">    password=<span class="string">&#x27;new_password123&#x27;</span>,</span><br><span class="line">    <span class="built_in">type</span>=<span class="number">2</span>,</span><br><span class="line">    update_time=datetime.utcnow(),</span><br><span class="line">    username=<span class="string">&#x27;new_username&#x27;</span></span><br><span class="line">)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 将新用户对象添加到会话中</span></span><br><span class="line">session.add(new_user)</span><br><span class="line"></span><br><span class="line"><span class="comment"># 提交更改至数据库</span></span><br><span class="line">session.commit()</span><br></pre></td></tr></table></figure>
</li>
<li><p>删除数据</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 创建会话  </span></span><br><span class="line">session = DBSession()  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 查询需要删除的用户  </span></span><br><span class="line">user = session.query(User).filter_by(username=<span class="string">&quot;admin&quot;</span>).first()  </span><br><span class="line"></span><br><span class="line"><span class="keyword">if</span> user:  </span><br><span class="line">    session.delete(user)  <span class="comment"># 删除用户  </span></span><br><span class="line">    session.commit()  <span class="comment"># 提交更改  </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 关闭会话  </span></span><br><span class="line">session.close()</span><br></pre></td></tr></table></figure>
</li>
<li><p>多表查询</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 连接 User, UserPost, 和 Post 表  </span></span><br><span class="line">query = session.query(User).join(User.posts).join(Post)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 添加查询条件  </span></span><br><span class="line">query = query.<span class="built_in">filter</span>(User.username == <span class="string">&#x27;admin&#x27;</span>)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 获取查询结果  </span></span><br><span class="line">results = query.<span class="built_in">all</span>()  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 遍历结果并访问属性  </span></span><br><span class="line"><span class="keyword">for</span> user, post <span class="keyword">in</span> results:  </span><br><span class="line">    <span class="built_in">print</span>(user.username, post.title, post.content)</span><br></pre></td></tr></table></figure>
</li>
<li><p>匹配以特定字符串开头的值：</p>
</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">query <span class="operator">=</span> session.query(<span class="keyword">User</span>).<span class="keyword">filter</span>(User.username.like(<span class="string">&#x27;prefix%&#x27;</span>))  </span><br><span class="line"># 	这将返回所有用户名以 &quot;prefix&quot; 开头的用户。</span><br></pre></td></tr></table></figure>

<ul>
<li>匹配以特定字符串结尾的值：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">query <span class="operator">=</span> session.query(<span class="keyword">User</span>).<span class="keyword">filter</span>(User.username.like(<span class="string">&#x27;%suffix&#x27;</span>)) </span><br><span class="line"># 这将返回所有用户名以 &quot;suffix&quot; 结尾的用户。</span><br></pre></td></tr></table></figure>

<ul>
<li>匹配包含特定字符串的值：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">query <span class="operator">=</span> session.query(<span class="keyword">User</span>).<span class="keyword">filter</span>(User.username.like(<span class="string">&#x27;%keyword%&#x27;</span>))  </span><br><span class="line"># 这将返回所有用户名中包含 &quot;keyword&quot; 的用户。</span><br></pre></td></tr></table></figure>

<ul>
<li>匹配特定长度的字符串：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">query <span class="operator">=</span> session.query(<span class="keyword">User</span>).<span class="keyword">filter</span>(User.username.like(<span class="string">&#x27;___&#x27;</span>))  </span><br><span class="line"># 这将返回用户名长度为 <span class="number">3</span> 的用户。</span><br></pre></td></tr></table></figure>

<ul>
<li>区间查询：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">query <span class="operator">=</span> session.query(<span class="keyword">User</span>).<span class="keyword">filter</span>(User.age.between(<span class="number">18</span>, <span class="number">30</span>))  </span><br><span class="line"># 这将返回所有年龄在 <span class="number">18</span> 到 <span class="number">30</span> 岁之间的用户。</span><br></pre></td></tr></table></figure>

<ul>
<li>区间排序：</li>
</ul>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">query <span class="operator">=</span> session.query(<span class="keyword">User</span>).order_by(User.age.asc())    </span><br><span class="line"># 这将返回按年龄升序排列的所有用户。</span><br><span class="line"></span><br><span class="line">query <span class="operator">=</span> session.query(<span class="keyword">User</span>).order_by(User.age.desc())</span><br><span class="line"># 这将返回按年龄降序排列的所有用户。</span><br></pre></td></tr></table></figure>

<ul>
<li>回滚操作</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 回滚操作示例  </span></span><br><span class="line"><span class="keyword">try</span>:  </span><br><span class="line">    <span class="comment"># 执行一些数据库操作  </span></span><br><span class="line">    session.commit()  </span><br><span class="line"><span class="keyword">except</span>:  </span><br><span class="line">    <span class="comment"># 如果出现异常，执行回滚操作  </span></span><br><span class="line">    session.rollback()  </span><br></pre></td></tr></table></figure>

<ul>
<li>函数操作</li>
</ul>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 函数操作示例  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_user_by_id</span>(<span class="params">user_id</span>):  </span><br><span class="line">    <span class="keyword">return</span> session.query(User).<span class="built_in">filter</span>(User.<span class="built_in">id</span> == user_id).first()  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 使用函数获取用户对象  </span></span><br><span class="line">user = get_user_by_id(<span class="number">3</span>)  </span><br><span class="line"><span class="built_in">print</span>(user.username)</span><br></pre></td></tr></table></figure>

<ul>
<li><p>缓存</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">from</span> sqlalchemy <span class="keyword">import</span> Column, String, create_engine, DateTime, Integer, Index  </span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> sessionmaker  </span><br><span class="line"><span class="keyword">from</span> sqlalchemy.orm <span class="keyword">import</span> declarative_base  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 创建对象的基类:  </span></span><br><span class="line">Base = declarative_base()  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 定义User对象:  </span></span><br><span class="line"><span class="keyword">class</span> <span class="title class_">User</span>(<span class="title class_ inherited__">Base</span>):  </span><br><span class="line">    __tablename__ = <span class="string">&#x27;t_user&#x27;</span>  </span><br><span class="line">    </span><br><span class="line">    <span class="comment"># 数据库表结构  </span></span><br><span class="line">    <span class="built_in">id</span> = Column(String(<span class="number">20</span>), primary_key=<span class="literal">True</span>)  </span><br><span class="line">    avatar = Column(String(<span class="number">255</span>))  </span><br><span class="line">    create_time = Column(DateTime)  </span><br><span class="line">    email = Column(String(<span class="number">255</span>))  </span><br><span class="line">    nickname = Column(String(<span class="number">255</span>))  </span><br><span class="line">    password = Column(String(<span class="number">255</span>))  </span><br><span class="line">    <span class="built_in">type</span> = Column(Integer)  </span><br><span class="line">    update_time = Column(DateTime)  </span><br><span class="line">    username = Column(String(<span class="number">255</span>))</span><br><span class="line"></span><br><span class="line"><span class="comment"># 初始化数据库连接:  </span></span><br><span class="line">engine = create_engine(<span class="string">&#x27;mysql+mysqlconnector://root:root@localhost:3306/blog&#x27;</span>)  </span><br><span class="line"><span class="comment"># 创建DBSession类型:  </span></span><br><span class="line">DBSession = sessionmaker(bind=engine)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 缓存操作示例（需要第三方库支持）：  </span></span><br><span class="line"><span class="keyword">from</span> flask_caching <span class="keyword">import</span> Cache  </span><br><span class="line"></span><br><span class="line">cache = Cache()  </span><br><span class="line"></span><br><span class="line"><span class="meta">@cache.memoize(<span class="params">timeout=<span class="number">60</span></span>)  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">get_user_by_id</span>(<span class="params">user_id</span>):  </span><br><span class="line">    <span class="keyword">return</span> DBSession().query(User).<span class="built_in">filter</span>(User.<span class="built_in">id</span> == user_id).first()  </span><br><span class="line"></span><br><span class="line">user1 = get_user_by_id(<span class="number">1</span>)  <span class="comment"># 第一次查询会被缓存  </span></span><br><span class="line">user2 = get_user_by_id(<span class="number">1</span>)  <span class="comment"># 第二次不会请求数据库，直接取缓存</span></span><br></pre></td></tr></table></figure>
</li>
<li><p>缓存更新策略</p>
<figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment"># 缓存更新策略示例：  </span></span><br><span class="line"><span class="comment"># 1. 缓存失效策略：在数据更新后使缓存失效  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">update_user</span>(<span class="params">user_id</span>):  </span><br><span class="line">    <span class="comment"># 更新用户信息的操作  </span></span><br><span class="line">    <span class="comment"># 在更新完成后，使缓存失效  </span></span><br><span class="line">    cache.delete_memoized(get_user_by_id, user_id)  </span><br><span class="line"></span><br><span class="line"><span class="comment"># 2. 定时刷新策略：定期刷新缓存  </span></span><br><span class="line"><span class="keyword">from</span> apscheduler.schedulers.background <span class="keyword">import</span> BackgroundScheduler  </span><br><span class="line"></span><br><span class="line">scheduler = BackgroundScheduler()  </span><br><span class="line">scheduler.add_job(update_cache, <span class="string">&#x27;interval&#x27;</span>, minutes=<span class="number">30</span>)  <span class="comment"># 每30分钟刷新一次缓存  </span></span><br><span class="line"></span><br><span class="line"><span class="comment"># 3. 事件驱动更新：使用事件机制通知缓存更新  </span></span><br><span class="line"><span class="comment"># 假设有一个事件触发器在用户信息更新时触发事件  </span></span><br><span class="line"><span class="keyword">def</span> <span class="title function_">on_user_update</span>(<span class="params">user_id</span>):  </span><br><span class="line">    <span class="comment"># 更新用户信息后，触发事件通知缓存更新  </span></span><br><span class="line">    cache.delete_memoized(get_user_by_id, user_id)</span><br></pre></td></tr></table></figure></li>
</ul>
</article><div class="tag_share"><div class="post-meta__tag-list"><a class="post-meta__tags" href="/tags/python/">python</a></div><div class="post_share"></div></div><nav class="pagination-post" id="pagination"><div class="prev-post pull-left"><a href="/2023/06/08/%E5%AF%B9%E8%B1%A1%E5%AD%97%E9%9D%A2%E9%87%8F%E4%BB%A3%E6%9B%BFswitch/" title="对象字面量代替Switch"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tse3-mm.cn.bing.net/th/id/OIP-C.kicojpcD6RPFCjEsEmD8ugHaHa?w=180&amp;h=180&amp;c=7&amp;r=0&amp;o=5&amp;dpr=1.3&amp;pid=1.7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of previous post"><div class="pagination-info"><div class="label">上一篇</div><div class="prev_info">对象字面量代替Switch</div></div></a></div><div class="next-post pull-right"><a href="/2023/08/25/%E5%8E%9F%E7%94%9Fjs%E5%AE%9E%E7%8E%B0%E8%B7%AF%E7%94%B1/" title="原生Js实现路由"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tse3-mm.cn.bing.net/th/id/OIP-C.kicojpcD6RPFCjEsEmD8ugHaHa?w=180&amp;h=180&amp;c=7&amp;r=0&amp;o=5&amp;dpr=1.3&amp;pid=1.7" onerror="onerror=null;src='/img/404.jpg'" alt="cover of next post"><div class="pagination-info"><div class="label">下一篇</div><div class="next_info">原生Js实现路由</div></div></a></div></nav><div class="relatedPosts"><div class="headline"><i class="fas fa-thumbs-up fa-fw"></i><span>相关推荐</span></div><div class="relatedPosts-list"><div><a href="/2023/12/21/Flask%E6%A1%86%E6%9E%B6/" title="Flask框架"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tse1-mm.cn.bing.net/th/id/OIP-C.aYKhp2p8j4T7TXmV73jzmAHaDt?w=320&h=175&c=7&r=0&o=5&dpr=1.3&pid=1.7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2023-12-21</div><div class="title">Flask框架</div></div></a></div><div><a href="/2024/04/23/Selenium-Web%E8%87%AA%E5%8A%A8%E5%8C%96%E6%B5%8B%E8%AF%95%E5%B7%A5%E5%85%B7/" title="Selenium-Web自动化测试工具"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://www.bugraptors.com/blog/storage/app/public/logo/why-we-choose-selenium-webdriver-over-selenium-ide-dyvpg-1000x700.webp" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-23</div><div class="title">Selenium-Web自动化测试工具</div></div></a></div><div><a href="/2024/04/28/python-%E5%88%97%E8%A1%A8%E6%8E%A8%E5%AF%BC%E3%80%81%E5%AD%97%E5%85%B8%E6%8E%A8%E5%AF%BC%E4%B8%8E%E9%9B%86%E5%90%88%E6%8E%A8%E5%AF%BC/" title="Python-列表推导、字典推导与集合推导"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tse2-mm.cn.bing.net/th/id/OIP-C.dSMliGMR1gP-nfkwknp26QHaDt?w=314&h=175&c=7&r=0&o=5&dpr=1.3&pid=1.7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-04-28</div><div class="title">Python-列表推导、字典推导与集合推导</div></div></a></div><div><a href="/2024/03/29/pytest%E6%B5%8B%E8%AF%95%E6%A1%86%E6%9E%B6/" title="Pytest测试框架"><img class="cover" src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tse1-mm.cn.bing.net/th/id/OIP-C._mSAAIu-LtTpte92lrJCSwHaFj?w=233&h=180&c=7&r=0&o=5&dpr=1.3&pid=1.7" alt="cover"><div class="content is-center"><div class="date"><i class="far fa-calendar-alt fa-fw"></i> 2024-03-29</div><div class="title">Pytest测试框架</div></div></a></div></div></div></div><div class="aside-content" id="aside-content"><div class="card-widget card-info"><div class="is-center"><div class="avatar-img"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="/img/fafafa.jpg" onerror="this.onerror=null;this.src='/img/friend_404.gif'" alt="avatar"/></div><div class="author-info__name">fafafa</div><div class="author-info__description">记录笔记日志</div></div><div class="card-info-data site-data is-center"><a href="/archives/"><div class="headline">文章</div><div class="length-num">40</div></a><a href="/tags/"><div class="headline">标签</div><div class="length-num">22</div></a><a href="/categories/"><div class="headline">分类</div><div class="length-num">25</div></a></div><div class="card-info-social-icons is-center"><a class="social-icon" href="https://github.com/xxxxx" target="_blank" title="Github"><i class="fab fa-github" style="color: #24292e;"></i></a><a class="social-icon" href="/fafafabaobei@163.com" target="_blank" title="Email"><i class="fas fa-envelope" style="color: #4a7dbe;"></i></a><a class="social-icon" href="tencent://AddContact/?fromId=45&amp;fromSubId=1&amp;subcmd=all&amp;uin=728831102&amp;website=www.oicqzone.com" target="_blank" title="QQ"><i class="fab fa-qq"></i></a></div></div><div class="sticky_layout"><div class="card-widget" id="card-toc"><div class="item-headline"><i class="fas fa-stream"></i><span>目录</span><span class="toc-percentage"></span></div><div class="toc-content"><ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80"><span class="toc-number">1.</span> <span class="toc-text">基础</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%AE%80%E4%BB%8B"><span class="toc-number">1.1.</span> <span class="toc-text">简介</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E6%90%AD%E5%BB%BA"><span class="toc-number">1.2.</span> <span class="toc-text">环境搭建</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%85%E7%AE%A1%E7%90%86%E5%B7%A5%E5%85%B7-pip"><span class="toc-number">1.3.</span> <span class="toc-text">包管理工具-pip</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%9C%A8%E7%BA%BF%E5%AE%89%E8%A3%85%E5%BA%93%E6%96%87%E4%BB%B6"><span class="toc-number">1.3.1.</span> <span class="toc-text">在线安装库文件</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9pip%E6%BA%90"><span class="toc-number">1.3.2.</span> <span class="toc-text">修改pip源</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#pip-%E7%A6%BB%E7%BA%BF%E5%AE%89%E8%A3%85"><span class="toc-number">1.3.3.</span> <span class="toc-text">pip 离线安装</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%AD%E6%B3%95"><span class="toc-number">1.4.</span> <span class="toc-text">语法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%BC%A9%E8%BF%9B"><span class="toc-number">1.4.1.</span> <span class="toc-text">缩进</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E8%A1%8C%E5%A4%9A%E6%9D%A1%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.4.2.</span> <span class="toc-text">一行多条语句</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%96%AD%E8%A1%8C"><span class="toc-number">1.4.3.</span> <span class="toc-text">断行</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%B3%A8%E9%87%8A"><span class="toc-number">1.4.4.</span> <span class="toc-text">注释</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E6%B3%A8%E9%87%8A"><span class="toc-number">1.4.5.</span> <span class="toc-text">类型注释</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%87%8F"><span class="toc-number">1.4.6.</span> <span class="toc-text">变量</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%90%E7%AE%97%E7%AC%A6"><span class="toc-number">1.4.7.</span> <span class="toc-text">运算符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%90%E7%AE%97%E7%AC%A6%E4%BC%98%E5%85%88%E7%BA%A7-%E4%BB%8E%E9%AB%98%E5%88%B0%E4%BD%8E"><span class="toc-number">1.4.8.</span> <span class="toc-text">运算符优先级 ( 从高到低)</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A1%A8%E8%BE%BE%E5%BC%8F%E4%B8%8E%E8%AF%AD%E5%8F%A5"><span class="toc-number">1.4.9.</span> <span class="toc-text">表达式与语句</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.5.</span> <span class="toc-text">基本数据类型</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.5.1.</span> <span class="toc-text">数据类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E7%AC%A6"><span class="toc-number">1.5.2.</span> <span class="toc-text">操作符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.5.3.</span> <span class="toc-text">类型转换</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%BF%9B%E5%88%B6%E8%BD%AC%E6%8D%A2"><span class="toc-number">1.5.4.</span> <span class="toc-text">进制转换</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">1.6.</span> <span class="toc-text">字符串</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E6%96%B9%E6%B3%95"><span class="toc-number">1.6.1.</span> <span class="toc-text">系统方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%BC%E5%BC%8F%E5%8C%96%E8%BE%93%E5%87%BA"><span class="toc-number">1.6.2.</span> <span class="toc-text">格式化输出</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%97%E8%A1%A8list"><span class="toc-number">1.7.</span> <span class="toc-text">列表list</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E6%93%8D%E4%BD%9C"><span class="toc-number">1.7.1.</span> <span class="toc-text">列表操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E7%B3%BB%E7%BB%9F%E6%96%B9%E6%B3%95"><span class="toc-number">1.7.2.</span> <span class="toc-text">列表系统方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%83%E7%A5%96tuple"><span class="toc-number">1.8.</span> <span class="toc-text">元祖tuple</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%85%83%E7%A5%96%E5%AF%B9%E8%B1%A1%E6%93%8D%E4%BD%9C%E6%96%B9%E6%B3%95"><span class="toc-number">1.8.1.</span> <span class="toc-text">元祖对象操作方法</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E7%B1%BB%E5%9E%8B%E7%9B%B8%E5%85%B3%E6%93%8D%E4%BD%9C%E6%96%B9%E6%B3%95"><span class="toc-number">1.9.</span> <span class="toc-text">序列类型相关操作方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E7%B1%BB%E5%9E%8B-%E7%B4%A2%E5%BC%95"><span class="toc-number">1.9.1.</span> <span class="toc-text">序列类型 - 索引</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E7%B1%BB%E5%9E%8B-%E5%88%87%E7%89%87"><span class="toc-number">1.9.2.</span> <span class="toc-text">序列类型 - 切片</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E7%B1%BB%E5%9E%8B-%E9%81%8D%E5%8E%86"><span class="toc-number">1.9.3.</span> <span class="toc-text">序列类型-遍历</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%81%8D%E5%8E%86%E5%BA%8F%E5%88%97%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.9.4.</span> <span class="toc-text">遍历序列类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%81%8D%E5%8E%86%E9%9D%9E%E5%BA%8F%E5%88%97%E7%B1%BB%E5%9E%8B"><span class="toc-number">1.9.5.</span> <span class="toc-text">遍历非序列类型</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E5%90%88-set-%E7%A4%BA%E4%BE%8B%EF%BC%9A"><span class="toc-number">1.9.6.</span> <span class="toc-text">集合 (set) 示例：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E5%85%B8-dict-%E7%A4%BA%E4%BE%8B%EF%BC%9A"><span class="toc-number">1.9.7.</span> <span class="toc-text">字典 (dict) 示例：</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%BA%E5%88%AB%E4%B8%8E%E6%B3%A8%E6%84%8F%E7%82%B9"><span class="toc-number">1.9.8.</span> <span class="toc-text">区别与注意点</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%89%A9%E5%B1%95-%E8%BF%9E%E6%8E%A5-%E6%B7%BB%E5%8A%A0%E5%A4%9A%E4%B8%AA%E5%85%83%E7%B4%A0"><span class="toc-number">1.9.9.</span> <span class="toc-text">扩展&#x2F;连接(添加多个元素</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E4%BA%92%E8%BD%AC-str-list-tuple"><span class="toc-number">1.9.10.</span> <span class="toc-text">类型互转: str()&#x2F;list()&#x2F;tuple()</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%B3%BB%E7%BB%9F%E5%87%BD%E6%95%B0"><span class="toc-number">1.9.11.</span> <span class="toc-text">系统函数</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9B%86%E5%90%88-set"><span class="toc-number">1.10.</span> <span class="toc-text">集合 set</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E9%9B%86%E5%90%88"><span class="toc-number">1.10.1.</span> <span class="toc-text">创建集合</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C"><span class="toc-number">1.10.2.</span> <span class="toc-text">集合操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%9A%E8%BF%87%E9%9B%86%E5%90%88%E6%93%8D%E4%BD%9C%E5%BF%AB%E9%80%9F%E5%AF%B9%E6%AF%94%E5%87%BA%E4%B8%80%E4%BA%9B%E6%95%B0%E6%8D%AE%E7%9A%84%E4%B8%8D%E5%90%8C"><span class="toc-number">1.10.3.</span> <span class="toc-text">通过集合操作快速对比出一些数据的不同</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%9B%86%E5%90%88%E5%AF%B9%E8%B1%A1%E8%87%AA%E5%B8%A6%E6%96%B9%E6%B3%95"><span class="toc-number">1.10.4.</span> <span class="toc-text">集合对象自带方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B1-%E5%88%97%E8%A1%A8%E5%8E%BB%E9%87%8D"><span class="toc-number">1.10.5.</span> <span class="toc-text">案例1: 列表去重</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A1%88%E4%BE%8B2-100w%E6%9D%A1%E6%95%B0%E6%8D%AE-%E7%94%A8%E5%88%97%E8%A1%A8%E5%92%8C%E9%9B%86%E5%90%88%E5%93%AA%E4%B8%AA%E6%80%A7%E8%83%BD%E6%9B%B4%E5%A5%BD"><span class="toc-number">1.10.6.</span> <span class="toc-text">案例2: 100w条数据,用列表和集合哪个性能更好?</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E5%85%B8-dict"><span class="toc-number">1.11.</span> <span class="toc-text">字典 dict</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%9B%E5%BB%BA%E5%AD%97%E5%85%B8"><span class="toc-number">1.11.1.</span> <span class="toc-text">创建字典</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E5%85%B8%E6%93%8D%E4%BD%9C"><span class="toc-number">1.11.2.</span> <span class="toc-text">字典操作</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AD%97%E5%85%B8%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">1.11.3.</span> <span class="toc-text">字典常用方法</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%B4%E6%96%B0%E5%AD%97%E5%85%B8%E6%95%B0%E6%8D%AE"><span class="toc-number">1.11.4.</span> <span class="toc-text">更新字典数据</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%93%88%E5%B8%8C%E4%B8%8E%E5%8F%AF%E5%93%88%E5%B8%8C%E5%85%83%E7%B4%A0"><span class="toc-number">1.11.5.</span> <span class="toc-text">哈希与可哈希元素</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%88%86%E6%94%AF%E5%8F%8A%E5%BE%AA%E7%8E%AF"><span class="toc-number">2.</span> <span class="toc-text">分支及循环</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E6%94%AF"><span class="toc-number">2.1.</span> <span class="toc-text">分支</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#if%E6%9D%A1%E4%BB%B6%E5%88%A4%E6%96%AD"><span class="toc-number">2.1.1.</span> <span class="toc-text">if条件判断</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#if-%E2%80%A6"><span class="toc-number">2.1.1.1.</span> <span class="toc-text">if …</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#if-%E2%80%A6-else-%E2%80%A6"><span class="toc-number">2.1.1.2.</span> <span class="toc-text">if … else …</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#f%E2%80%A6-elif-%E2%80%A6-else-%E2%80%A6"><span class="toc-number">2.1.1.3.</span> <span class="toc-text">f… elif … else …</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%9C%9F%E5%81%87%E5%80%BC"><span class="toc-number">2.1.2.</span> <span class="toc-text">真假值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%89%E5%85%83%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">2.1.3.</span> <span class="toc-text">三元表达式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%BB%E8%BE%91%E7%AC%A6%E4%BB%A3%E6%9B%BFif%E5%88%A4%E6%96%AD"><span class="toc-number">2.1.4.</span> <span class="toc-text">逻辑符代替if判断</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF"><span class="toc-number">2.2.</span> <span class="toc-text">循环</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#for%E5%BE%AA%E7%8E%AF"><span class="toc-number">2.2.1.</span> <span class="toc-text">for循环</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#while-%E5%BE%AA%E7%8E%AF"><span class="toc-number">2.2.2.</span> <span class="toc-text">while 循环</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#break%E5%92%8Ccontinue"><span class="toc-number">2.2.3.</span> <span class="toc-text">break和continue</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E4%B8%AD%E7%9A%84else"><span class="toc-number">2.2.4.</span> <span class="toc-text">循环中的else</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%87%BD%E6%95%B0"><span class="toc-number">3.</span> <span class="toc-text">函数</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%AE%9A%E4%B9%89%E5%92%8C%E8%B0%83%E7%94%A8"><span class="toc-number">3.1.</span> <span class="toc-text">函数定义和调用</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AE%9A%E4%B9%89%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.1.</span> <span class="toc-text">定义函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%B0%83%E7%94%A8%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.2.</span> <span class="toc-text">调用函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0"><span class="toc-number">3.1.3.</span> <span class="toc-text">函数参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%BD%A2%E5%8F%82%E5%92%8C%E5%AE%9E%E5%8F%82"><span class="toc-number">3.1.4.</span> <span class="toc-text">形参和实参</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E7%B1%BB%E5%9E%8B%E6%B3%A8%E8%A7%A3"><span class="toc-number">3.1.5.</span> <span class="toc-text">参数类型注解</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E9%BB%98%E8%AE%A4%E5%80%BC-%E5%BF%85%E9%80%89%E5%92%8C%E5%8F%AF%E9%80%89%E5%8F%82%E6%95%B0"><span class="toc-number">3.1.6.</span> <span class="toc-text">参数默认值-必选和可选参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%BD%8D%E7%BD%AE%E5%8F%82%E6%95%B0%E5%92%8C%E5%85%B3%E9%94%AE%E5%AD%97%E5%8F%82%E6%95%B0"><span class="toc-number">3.1.7.</span> <span class="toc-text">位置参数和关键字参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%AE%9A%E5%8F%82%E6%95%B0"><span class="toc-number">3.1.8.</span> <span class="toc-text">不定参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%99%90%E5%AE%9A%E5%85%B3%E9%94%AE%E5%AD%97%E5%8F%82%E6%95%B0"><span class="toc-number">3.1.9.</span> <span class="toc-text">限定关键字参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%99%90%E5%AE%9A%E4%BD%8D%E7%BD%AE%E5%8F%82%E6%95%B0"><span class="toc-number">3.1.10.</span> <span class="toc-text">限定位置参数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E8%BF%94%E5%9B%9E%E5%80%BC"><span class="toc-number">3.1.11.</span> <span class="toc-text">函数返回值</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%9C%E7%94%A8%E5%9F%9F"><span class="toc-number">3.1.12.</span> <span class="toc-text">变量的作用域</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%BF%E5%90%8D%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.13.</span> <span class="toc-text">匿名函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.14.</span> <span class="toc-text">高阶函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E8%A3%85%E9%A5%B0%E5%99%A8"><span class="toc-number">3.1.15.</span> <span class="toc-text">装饰器</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%A3%85%E9%A5%B0%E5%99%A8%E7%9A%84%E6%89%A7%E8%A1%8C%E6%B5%81%E7%A8%8B"><span class="toc-number">3.1.15.1.</span> <span class="toc-text">装饰器的执行流程</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B8%B8%E7%94%A8%E9%AB%98%E9%98%B6%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.16.</span> <span class="toc-text">常用高阶函数</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%B5%8C%E5%A5%97-%E5%92%8C%E9%97%AD%E5%8C%85"><span class="toc-number">3.1.17.</span> <span class="toc-text">函数嵌套 和闭包</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%87%BD%E6%95%B0%E5%B5%8C%E5%A5%97"><span class="toc-number">3.1.17.1.</span> <span class="toc-text">函数嵌套</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%AD%E5%8C%85"><span class="toc-number">3.1.17.2.</span> <span class="toc-text">闭包</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%80%BB%E7%BB%93%EF%BC%9A"><span class="toc-number">3.1.17.3.</span> <span class="toc-text">总结：</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%80%92%E5%BD%92%E5%87%BD%E6%95%B0%E5%92%8C%E5%B0%BE%E9%80%92%E5%BD%92"><span class="toc-number">3.1.18.</span> <span class="toc-text">递归函数和尾递归</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%80%92%E5%BD%92%E5%87%BD%E6%95%B0"><span class="toc-number">3.1.18.1.</span> <span class="toc-text">递归函数</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%B0%BE%E9%80%92%E5%BD%92"><span class="toc-number">3.1.18.2.</span> <span class="toc-text">尾递归</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%80%BB%E7%BB%93%EF%BC%9A-1"><span class="toc-number">3.1.18.3.</span> <span class="toc-text">总结：</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1"><span class="toc-number">4.</span> <span class="toc-text">类与对象</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E8%BF%87%E7%A8%8B%E5%8F%8A%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1"><span class="toc-number">4.1.</span> <span class="toc-text">面向过程及面向对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E4%B8%8E%E5%AF%B9%E8%B1%A1-%E5%AE%9E%E4%BE%8B-%E7%9A%84%E5%85%B3%E7%B3%BB"><span class="toc-number">4.2.</span> <span class="toc-text">类与对象(实例)的关系</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AF%B9%E8%B1%A1%E5%88%9D%E5%A7%8B%E5%8C%96%E6%96%B9%E6%B3%95"><span class="toc-number">4.3.</span> <span class="toc-text">对象初始化方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E5%B1%9E%E6%80%A7%E5%8F%8A%E5%AE%9E%E4%BE%8B%E5%B1%9E%E6%80%A7"><span class="toc-number">4.4.</span> <span class="toc-text">类属性及实例属性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%BF%E9%97%AE%E9%99%90%E5%88%B6-%E7%A7%81%E6%9C%89%E5%8F%98%E9%87%8F"><span class="toc-number">4.5.</span> <span class="toc-text">访问限制 - 私有变量</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%B1%BB%E6%96%B9%E6%B3%95%E3%80%81%E5%AE%9E%E4%BE%8B%E6%96%B9%E6%B3%95%E5%8F%8A%E9%9D%99%E6%80%81%E6%96%B9%E6%B3%95"><span class="toc-number">4.6.</span> <span class="toc-text">类方法、实例方法及静态方法</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BB%A7%E6%89%BF%E5%92%8C%E5%A4%9A%E6%80%81"><span class="toc-number">4.7.</span> <span class="toc-text">继承和多态</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%8E%B7%E5%8F%96%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7"><span class="toc-number">4.8.</span> <span class="toc-text">获取对象属性</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E4%B8%8E%E5%8C%85"><span class="toc-number">5.</span> <span class="toc-text">模块与包</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97"><span class="toc-number">5.1.</span> <span class="toc-text">模块</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%80%E4%B8%AA-py%E8%84%9A%E6%9C%AC%E5%B0%B1%E6%98%AF%E4%B8%80%E4%B8%AA%E6%A8%A1%E5%9D%97"><span class="toc-number">5.1.1.</span> <span class="toc-text">一个.py脚本就是一个模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5"><span class="toc-number">5.1.2.</span> <span class="toc-text">模块导入</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A8%A1%E5%9D%97%E5%AF%BC%E5%85%A5%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98"><span class="toc-number">5.1.3.</span> <span class="toc-text">模块导入常见问题</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%B8%BB%E6%A8%A1%E5%9D%97%E5%92%8C%E5%AF%BC%E5%85%A5%E6%A8%A1%E5%9D%97"><span class="toc-number">5.1.3.1.</span> <span class="toc-text">主模块和导入模块</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%97%B4%E6%8E%A5%E5%AF%BC%E5%85%A5%E9%97%AE%E9%A2%98"><span class="toc-number">5.1.3.2.</span> <span class="toc-text">间接导入问题</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%BE%AA%E7%8E%AF%E5%AF%BC%E5%85%A5%E9%97%AE%E9%A2%98"><span class="toc-number">5.1.3.3.</span> <span class="toc-text">循环导入问题</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E7%AB%8B%E5%8D%B3%E6%89%A7%E8%A1%8C%E5%8F%8A%E8%B0%83%E7%94%A8-%E5%BB%B6%E8%BF%9F-%E6%89%A7%E8%A1%8C"><span class="toc-number">5.1.3.4.</span> <span class="toc-text">导入立即执行及调用(延迟)执行</span></a></li></ol></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8C%85-package"><span class="toc-number">5.2.</span> <span class="toc-text">包 package</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%85Package"><span class="toc-number">5.2.1.</span> <span class="toc-text">包Package</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E5%8C%85%E5%8F%8A%E6%A8%A1%E5%9D%97"><span class="toc-number">5.2.2.</span> <span class="toc-text">导入包及模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E5%8C%85%E6%88%96%E5%AD%90%E5%8C%85"><span class="toc-number">5.2.3.</span> <span class="toc-text">导入包或子包</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%85%E4%B8%AD-init-py%E7%9A%84%E4%BD%9C%E7%94%A8"><span class="toc-number">5.2.4.</span> <span class="toc-text">包中__init__.py的作用</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%96%87%E4%BB%B6%E6%93%8D%E4%BD%9C"><span class="toc-number">6.</span> <span class="toc-text">文件操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%AF%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-number">6.1.</span> <span class="toc-text">纯文本文件读取</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%BA%AF%E6%96%87%E6%9C%AC%E6%96%87%E4%BB%B6%E5%86%99%E5%85%A5"><span class="toc-number">6.2.</span> <span class="toc-text">纯文本文件写入</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E4%B8%8A%E4%B8%8B%E6%96%87%E6%A0%BC%E5%BC%8F%E8%87%AA%E5%8A%A8%E5%85%B3%E9%97%AD%E6%96%87%E4%BB%B6"><span class="toc-number">6.3.</span> <span class="toc-text">使用上下文格式自动关闭文件</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%9D%9E%E7%BA%AF%E6%96%87%E4%BB%B6%E8%AF%BB%E5%86%99"><span class="toc-number">6.4.</span> <span class="toc-text">非纯文件读写</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AF%BB%E5%86%99%E6%A8%A1%E5%BC%8F"><span class="toc-number">6.5.</span> <span class="toc-text">读写模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%B6%E4%BB%96%E7%B1%BB%E5%9E%8B%E6%96%87%E4%BB%B6%E8%AF%BB%E5%8F%96"><span class="toc-number">6.6.</span> <span class="toc-text">其他类型文件读取</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%8F%8A%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6%E4%B9%8B%E4%BA%89"><span class="toc-number">6.6.1.</span> <span class="toc-text">数据及配置文件之争</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#CSV%E6%96%87%E4%BB%B6"><span class="toc-number">6.6.2.</span> <span class="toc-text">CSV文件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#Python3%E6%93%8D%E4%BD%9CCSV%E6%96%87%E4%BB%B6%E4%BD%BF%E7%94%A8%E8%87%AA%E5%B8%A6%E7%9A%84csv%E5%8C%85"><span class="toc-number">6.6.2.1.</span> <span class="toc-text">Python3操作CSV文件使用自带的csv包</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BD%BF%E7%94%A8%E5%AD%97%E5%85%B8%E6%A0%BC%E5%BC%8F%E7%9A%84%E6%95%B0%E6%8D%AE%EF%BC%9ADictReader-DictWriter"><span class="toc-number">6.6.2.2.</span> <span class="toc-text">使用字典格式的数据：DictReader, DictWriter</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ini%E6%96%87%E4%BB%B6"><span class="toc-number">6.6.3.</span> <span class="toc-text">ini文件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96"><span class="toc-number">6.6.3.1.</span> <span class="toc-text">读取</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%85%AC%E5%85%B1%E5%8F%98%E9%87%8F"><span class="toc-number">6.6.3.2.</span> <span class="toc-text">公共变量</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%8F%82%E6%95%B0%E5%8C%96"><span class="toc-number">6.6.3.3.</span> <span class="toc-text">参数化</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E4%BF%AE%E6%94%B9%E4%BF%9D%E5%AD%98"><span class="toc-number">6.6.3.4.</span> <span class="toc-text">修改保存</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#JSON%E6%96%87%E4%BB%B6"><span class="toc-number">6.6.4.</span> <span class="toc-text">JSON文件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#JSON%E4%B8%8EPython%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B%E7%9A%84%E5%AF%B9%E5%BA%94%E5%85%B3%E7%B3%BB"><span class="toc-number">6.6.4.1.</span> <span class="toc-text">JSON与Python数据类型的对应关系</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#JSON%E5%AD%97%E7%AC%A6%E4%B8%B2%E4%B8%8EPython%E5%AD%97%E5%85%B8%E7%9A%84%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2"><span class="toc-number">6.6.4.2.</span> <span class="toc-text">JSON字符串与Python字典的相互转换</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#JSON%E6%96%87%E4%BB%B6%E4%B8%8E%E5%AD%97%E5%85%B8%E7%9A%84%E7%9B%B8%E4%BA%92%E8%BD%AC%E6%8D%A2"><span class="toc-number">6.6.4.3.</span> <span class="toc-text">JSON文件与字典的相互转换</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#YAML-%E6%96%87%E4%BB%B6"><span class="toc-number">6.6.5.</span> <span class="toc-text">YAML 文件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#yaml%E7%AE%80%E4%BB%8B"><span class="toc-number">6.6.5.1.</span> <span class="toc-text">yaml简介</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%9F%BA%E6%9C%AC%E6%A0%BC%E5%BC%8F"><span class="toc-number">6.6.5.2.</span> <span class="toc-text">基本格式</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E7%B1%BB%E5%9E%8B%E8%BD%AC%E6%8D%A2-1"><span class="toc-number">6.6.5.3.</span> <span class="toc-text">类型转换</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%A4%9A%E8%A1%8C%E6%96%87%E6%9C%AC%E5%8F%8A%E6%8B%BC%E6%8E%A5"><span class="toc-number">6.6.5.4.</span> <span class="toc-text">多行文本及拼接</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E9%94%9A%E7%82%B9%EF%BC%8C%E5%BC%95%E7%94%A8%E5%8F%8A%E6%8F%92%E5%85%A5"><span class="toc-number">6.6.5.5.</span> <span class="toc-text">锚点，引用及插入</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#Python%E6%93%8D%E4%BD%9CYAML%E6%96%87%E4%BB%B6%E5%8F%8A%E5%AD%97%E7%AC%A6%E4%B8%B2"><span class="toc-number">6.6.5.6.</span> <span class="toc-text">Python操作YAML文件及字符串</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#yaml-%E5%AD%97%E7%AC%A6%E4%B8%B2-%E8%BD%AC%E6%88%90-%E5%AD%97%E5%85%B8"><span class="toc-number">6.6.5.7.</span> <span class="toc-text">yaml 字符串 转成 字典</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#yaml-%E6%96%87%E4%BB%B6%E8%BD%AC%E6%88%90%E5%AD%97%E5%85%B8"><span class="toc-number">6.6.5.8.</span> <span class="toc-text">yaml 文件转成字典</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AD%97%E5%85%B8-%E8%BD%AC%E6%88%90-yaml%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%88%96%E6%96%87%E4%BB%B6"><span class="toc-number">6.6.5.9.</span> <span class="toc-text">字典 转成 yaml字符串或文件</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%87%AA%E5%AE%9A%E4%B9%89tag"><span class="toc-number">6.6.5.10.</span> <span class="toc-text">自定义tag</span></a></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#Excel%E6%96%87%E4%BB%B6"><span class="toc-number">6.6.6.</span> <span class="toc-text">Excel文件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%95%B0%E6%8D%AE"><span class="toc-number">6.6.6.1.</span> <span class="toc-text">读取数据</span></a><ol class="toc-child"><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E6%89%80%E6%9C%89%E6%95%B0%E6%8D%AE"><span class="toc-number">6.6.6.1.1.</span> <span class="toc-text">读取所有数据</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E6%8C%89%E8%A1%8C%E8%AF%BB%E5%8F%96"><span class="toc-number">6.6.6.1.2.</span> <span class="toc-text">按行读取</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E8%AF%BB%E5%8F%96%E5%8D%95%E5%85%83%E6%A0%BC%E6%95%B0%E6%8D%AE"><span class="toc-number">6.6.6.1.3.</span> <span class="toc-text">读取单元格数据</span></a></li><li class="toc-item toc-level-6"><a class="toc-link" href="#%E5%86%99%E5%85%A5%E6%96%87%E4%BB%B6"><span class="toc-number">6.6.6.1.4.</span> <span class="toc-text">写入文件</span></a></li></ol></li></ol></li><li class="toc-item toc-level-4"><a class="toc-link" href="#html%E6%96%87%E4%BB%B6"><span class="toc-number">6.6.7.</span> <span class="toc-text">html文件</span></a><ol class="toc-child"><li class="toc-item toc-level-5"><a class="toc-link" href="#%E5%AE%89%E8%A3%85%E6%96%B9%E6%B3%95"><span class="toc-number">6.6.7.1.</span> <span class="toc-text">安装方法</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#lxml%E8%8A%82%E7%82%B9%E5%AF%B9%E8%B1%A1%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95%EF%BC%9A"><span class="toc-number">6.6.7.2.</span> <span class="toc-text">lxml节点对象常用方法：</span></a></li><li class="toc-item toc-level-5"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%AD%A5%E9%AA%A4"><span class="toc-number">6.6.7.3.</span> <span class="toc-text">操作步骤</span></a></li></ol></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#StringIO%E5%92%8CBytesIO"><span class="toc-number">7.</span> <span class="toc-text">StringIO和BytesIO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#StringIO"><span class="toc-number">7.1.</span> <span class="toc-text">StringIO</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#BytesIO"><span class="toc-number">7.2.</span> <span class="toc-text">BytesIO</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#os-%E6%96%87%E4%BB%B6%E5%8F%8A%E7%9B%AE%E5%BD%95%E6%93%8D%E4%BD%9C"><span class="toc-number">8.</span> <span class="toc-text">os 文件及目录操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#os-name"><span class="toc-number">8.1.</span> <span class="toc-text">os.name</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F-os-environ"><span class="toc-number">8.2.</span> <span class="toc-text">环境变量 - os.environ</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%93%8D%E4%BD%9C%E6%96%87%E4%BB%B6%E5%92%8C%E7%9B%AE%E5%BD%95"><span class="toc-number">8.3.</span> <span class="toc-text">操作文件和目录</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BA%8F%E5%88%97%E5%8C%96"><span class="toc-number">9.</span> <span class="toc-text">序列化</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#JSON%E5%A4%84%E7%90%86"><span class="toc-number">9.1.</span> <span class="toc-text">JSON处理</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86"><span class="toc-number">10.</span> <span class="toc-text">异常处理</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#try%E2%80%A6-except"><span class="toc-number">10.1.</span> <span class="toc-text">try… except</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%97%A0%E5%BC%82%E5%B8%B8%E5%8F%8A%E6%97%A0%E8%AE%BA%E6%98%AF%E5%90%A6%E6%9C%89%E5%BC%82%E5%B8%B8%E9%83%BD%E6%89%A7%E8%A1%8C%E7%9A%84%E6%93%8D%E4%BD%9C"><span class="toc-number">10.2.</span> <span class="toc-text">无异常及无论是否有异常都执行的操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Python%E4%B8%AD%E5%B8%B8%E8%A7%81%E5%BC%82%E5%B8%B8"><span class="toc-number">10.3.</span> <span class="toc-text">Python中常见异常</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%BB%E5%8A%A8%E6%8A%9B%E5%87%BA%E5%BC%82%E5%B8%B8"><span class="toc-number">10.4.</span> <span class="toc-text">主动抛出异常</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%A3%85%E9%A5%B0%E5%99%A8-1"><span class="toc-number">11.</span> <span class="toc-text">装饰器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%9F%BA%E7%A1%80%E8%A3%85%E9%A5%B0%E5%99%A8"><span class="toc-number">11.1.</span> <span class="toc-text">基础装饰器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%A3%85%E9%A5%B0%E5%99%A8%E5%A4%84%E7%90%86%E5%87%BD%E6%95%B0%E5%8F%82%E6%95%B0"><span class="toc-number">11.2.</span> <span class="toc-text">装饰器处理函数参数</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%B8%A6%E5%8F%82%E8%A3%85%E9%A5%B0%E5%99%A8"><span class="toc-number">11.3.</span> <span class="toc-text">带参装饰器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%99%A8%E5%92%8C%E8%BF%AD%E4%BB%A3%E5%99%A8"><span class="toc-number">12.</span> <span class="toc-text">生成器和迭代器</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8F%AF%E8%BF%AD%E4%BB%A3%E5%AF%B9%E8%B1%A1"><span class="toc-number">12.1.</span> <span class="toc-text">可迭代对象</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%BF%AD%E4%BB%A3%E5%99%A8"><span class="toc-number">12.2.</span> <span class="toc-text">迭代器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%99%A8"><span class="toc-number">12.3.</span> <span class="toc-text">生成器</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E6%8E%A8%E5%AF%BC%E5%BC%8F"><span class="toc-number">12.4.</span> <span class="toc-text">列表推导式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%AD%97%E5%85%B8%E6%8E%A8%E5%AF%BC%E5%BC%8F"><span class="toc-number">12.5.</span> <span class="toc-text">字典推导式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E7%94%9F%E6%88%90%E5%99%A8-1"><span class="toc-number">12.6.</span> <span class="toc-text">生成器</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%AD%94%E6%9C%AF%E6%96%B9%E6%B3%95"><span class="toc-number">13.</span> <span class="toc-text">魔术方法</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-slots"><span class="toc-number">14.</span> <span class="toc-text">面向对象 - __slots__</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2%E7%9B%B8%E5%AF%B9%E8%B1%A1-MixIn"><span class="toc-number">15.</span> <span class="toc-text">面相对象 - MixIn</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2%E7%9B%B8%E5%AF%B9%E8%B1%A1-%E8%AE%A2%E5%88%B6%E7%B1%BB"><span class="toc-number">16.</span> <span class="toc-text">面相对象 - 订制类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#str"><span class="toc-number">16.1.</span> <span class="toc-text">__str__</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#getitem"><span class="toc-number">16.2.</span> <span class="toc-text">__getitem__</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#getattr-%E5%92%8C-setattr"><span class="toc-number">16.3.</span> <span class="toc-text">__getattr__ 和 __setattr__</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#call"><span class="toc-number">16.4.</span> <span class="toc-text">__call__</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-%E6%9E%9A%E4%B8%BE%E7%B1%BB"><span class="toc-number">17.</span> <span class="toc-text">面向对象 - 枚举类</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%97%E8%A1%A8%E7%B1%BB%E5%9E%8B"><span class="toc-number">17.1.</span> <span class="toc-text">列表类型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E9%94%AE%E5%80%BC%E5%AF%B9%E7%B1%BB%E5%9E%8B"><span class="toc-number">17.2.</span> <span class="toc-text">键值对类型</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1-property"><span class="toc-number">18.</span> <span class="toc-text">面向对象 - @property</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E9%9D%A2%E7%9B%B8%E5%AF%B9%E8%B1%A1-%E5%85%83%E7%B1%BB-%E8%A1%A5%E5%85%85"><span class="toc-number">19.</span> <span class="toc-text">面相对象 - 元类 [补充]</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%83%E7%B1%BB%E6%98%AF%E4%BB%80%E4%B9%88"><span class="toc-number">19.1.</span> <span class="toc-text">元类是什么</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%83%E7%B1%BB%E7%9A%84%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF"><span class="toc-number">19.2.</span> <span class="toc-text">元类的使用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%85%83%E7%B1%BB%E4%BD%BF%E7%94%A8%E7%A4%BA%E4%BE%8B"><span class="toc-number">19.3.</span> <span class="toc-text">元类使用示例</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E4%B8%8D%E5%85%81%E8%AE%B8%E7%B1%BB%E5%AE%9E%E4%BE%8B%E5%8C%96"><span class="toc-number">19.3.1.</span> <span class="toc-text">不允许类实例化</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8D%95%E4%BE%8B%E6%A8%A1%E5%BC%8F"><span class="toc-number">19.3.2.</span> <span class="toc-text">单例模式</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%B9%E6%8D%AE%E5%B1%9E%E6%80%A7%E7%BC%93%E5%AD%98%E5%AF%B9%E8%B1%A1"><span class="toc-number">19.3.3.</span> <span class="toc-text">根据属性缓存对象</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E9%99%90%E5%88%B6%E7%B1%BB%E5%BF%85%E9%A1%BB%E5%8C%85%E5%90%AB%E7%89%B9%E5%AE%9A%E5%B1%9E%E6%80%A7"><span class="toc-number">19.3.4.</span> <span class="toc-text">限制类必须包含特定属性</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#ORM%E6%A1%86%E6%9E%B6"><span class="toc-number">19.3.5.</span> <span class="toc-text">ORM框架</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">20.</span> <span class="toc-text">正则表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%BB%80%E4%B9%88%E6%98%AF%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">20.1.</span> <span class="toc-text">什么是正则表达式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E5%8F%AF%E4%BB%A5%E5%B9%B2%E4%BB%80%E4%B9%88"><span class="toc-number">20.2.</span> <span class="toc-text">正则表达式可以干什么</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#re%E6%A8%A1%E5%9D%97"><span class="toc-number">20.3.</span> <span class="toc-text">re模块</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F%E6%A8%A1%E5%BC%8F"><span class="toc-number">20.4.</span> <span class="toc-text">正则表达式模式</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#re%E6%A8%A1%E5%B8%B8%E7%94%A8%E6%96%B9%E6%B3%95"><span class="toc-number">20.5.</span> <span class="toc-text">re模常用方法</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%AF%BC%E5%85%A5%E6%A8%A1%E5%9D%97"><span class="toc-number">20.5.1.</span> <span class="toc-text">导入模块</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E5%A4%9A%E7%A7%8D%E5%8F%AF%E8%83%BD"><span class="toc-number">20.5.2.</span> <span class="toc-text">匹配多种可能 - []</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E6%95%B0%E5%AD%97-d-or-D"><span class="toc-number">20.5.3.</span> <span class="toc-text">匹配数字 - \d or \D</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E7%A9%BA%E7%99%BD-s-or-S"><span class="toc-number">20.5.4.</span> <span class="toc-text">匹配空白 - \s or \S</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E6%89%80%E6%9C%89%E5%AD%97%E6%AF%8D%E5%92%8C%E6%95%B0%E5%AD%97%E4%BB%A5%E5%8F%8A-%E2%80%98-%E2%80%99-w-or-W"><span class="toc-number">20.5.5.</span> <span class="toc-text">匹配所有字母和数字以及 ‘_’ - \w or \W</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E7%A9%BA%E7%99%BD%E5%AD%97%E7%AC%A6%E4%B8%B2-b-or-B"><span class="toc-number">20.5.6.</span> <span class="toc-text">匹配空白字符串 - \b or \B</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E4%BB%BB%E6%84%8F%E5%AD%97%E7%AC%A6-%E7%89%B9%E6%AE%8A%E5%AD%97%E7%AC%A6-or"><span class="toc-number">20.5.7.</span> <span class="toc-text">匹配任意字符 特殊字符 - \ or .</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E5%8F%A5%E9%A6%96%E5%8F%A5%E5%B0%BE-or"><span class="toc-number">20.5.8.</span> <span class="toc-text">匹配句首句尾 - $ or ^</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%98%AF%E5%90%A6%E5%8C%B9%E9%85%8D"><span class="toc-number">20.5.9.</span> <span class="toc-text">是否匹配 - ?</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%A4%9A%E8%A1%8C%E5%8C%B9%E9%85%8D-re-M"><span class="toc-number">20.5.10.</span> <span class="toc-text">多行匹配 - re.M</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E9%9B%B6%E6%AC%A1%E6%88%96%E5%A4%9A%E6%AC%A1"><span class="toc-number">20.5.11.</span> <span class="toc-text">匹配零次或多次 - *</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8C%B9%E9%85%8D%E4%B8%80%E6%AC%A1%E6%88%96%E5%A4%9A%E6%AC%A1"><span class="toc-number">20.5.12.</span> <span class="toc-text">匹配一次或多次 - +</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8F%AF%E9%80%89%E5%8C%B9%E9%85%8D%E6%AC%A1%E6%95%B0-n-m"><span class="toc-number">20.5.13.</span> <span class="toc-text">可选匹配次数 - {n, m}</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%8E%BB%E9%99%A4%E6%83%B0%E6%80%A7%EF%BC%8C%E5%AF%BB%E6%89%BE%E6%89%80%E6%9C%89%E5%8C%B9%E9%85%8D-findall"><span class="toc-number">20.5.14.</span> <span class="toc-text">去除惰性，寻找所有匹配 - findall</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%9B%BF%E6%8D%A2%E5%8C%B9%E9%85%8D%E5%86%85%E5%AE%B9-sub"><span class="toc-number">20.5.15.</span> <span class="toc-text">替换匹配内容 - sub</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%88%86%E8%A3%82%E5%8C%B9%E9%85%8D%E5%86%85%E5%AE%B9-split"><span class="toc-number">20.5.16.</span> <span class="toc-text">分裂匹配内容 - split</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E5%B0%86%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D%E8%A7%84%E5%88%99%E8%BF%9B%E8%A1%8C%E5%8C%85%E8%A3%85-compile"><span class="toc-number">20.5.17.</span> <span class="toc-text">将正则匹配规则进行包装 - compile</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E4%B8%80%E4%BA%9B%E5%B8%B8%E8%A7%81%E7%9A%84%E6%AD%A3%E5%88%99%E8%A1%A8%E8%BE%BE%E5%BC%8F"><span class="toc-number">20.6.</span> <span class="toc-text">一些常见的正则表达式</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%A1%E9%AA%8C%E6%95%B0%E5%AD%97"><span class="toc-number">20.6.1.</span> <span class="toc-text">校验数字</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E6%A0%A1%E9%AA%8C%E5%AD%97%E7%AC%A6"><span class="toc-number">20.6.2.</span> <span class="toc-text">校验字符</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#%E7%89%B9%E6%AE%8A%E9%9C%80%E6%B1%82"><span class="toc-number">20.6.3.</span> <span class="toc-text">特殊需求</span></a></li></ol></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E8%BF%9B%E7%A8%8B%E5%92%8C%E7%BA%BF%E7%A8%8B"><span class="toc-number">21.</span> <span class="toc-text">进程和线程</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E8%BF%9B%E7%A8%8B"><span class="toc-number">21.1.</span> <span class="toc-text">多进程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%A4%9A%E7%BA%BF%E7%A8%8B"><span class="toc-number">21.2.</span> <span class="toc-text">多线程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E8%AE%A1%E7%AE%97%E5%AF%86%E9%9B%86%E5%9E%8B-vs-IO%E5%AF%86%E9%9B%86%E5%9E%8B"><span class="toc-number">21.3.</span> <span class="toc-text">计算密集型 vs. IO密集型</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%BC%82%E6%AD%A5IO"><span class="toc-number">21.4.</span> <span class="toc-text">异步IO</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%88%86%E5%B8%83%E5%BC%8F%E8%BF%9B%E7%A8%8B"><span class="toc-number">21.5.</span> <span class="toc-text">分布式进程</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E5%BC%82%E6%AD%A5IO-1"><span class="toc-number">22.</span> <span class="toc-text">异步IO</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#%E5%8D%8F%E7%A8%8B"><span class="toc-number">22.1.</span> <span class="toc-text">协程</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#asyncio"><span class="toc-number">22.2.</span> <span class="toc-text">asyncio</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#aiohttp"><span class="toc-number">22.3.</span> <span class="toc-text">aiohttp</span></a></li></ol></li><li class="toc-item toc-level-2"><a class="toc-link" href="#%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C"><span class="toc-number">23.</span> <span class="toc-text">数据库操作</span></a><ol class="toc-child"><li class="toc-item toc-level-3"><a class="toc-link" href="#SQLite"><span class="toc-number">23.1.</span> <span class="toc-text">SQLite</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#MySQL"><span class="toc-number">23.2.</span> <span class="toc-text">MySQL</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#SQLAlchemy"><span class="toc-number">23.3.</span> <span class="toc-text">SQLAlchemy</span></a></li></ol></li></ol></div></div><div class="card-widget card-recent-post"><div class="item-headline"><i class="fas fa-history"></i><span>最新文章</span></div><div class="aside-list"><div class="aside-list-item"><a class="thumbnail" href="/2024/08/11/react/" title="React Hocks"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="React Hocks"/></a><div class="content"><a class="title" href="/2024/08/11/react/" title="React Hocks">React Hocks</a><time datetime="2024-08-11T12:36:05.000Z" title="发表于 2024-08-11 20:36:05">2024-08-11</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/08/js+vue/" title="无题"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="无题"/></a><div class="content"><a class="title" href="/2024/08/08/js+vue/" title="无题">无题</a><time datetime="2024-08-08T01:53:25.450Z" title="发表于 2024-08-08 09:53:25">2024-08-08</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/05/python%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/" title="Python项目构建工具"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://i.loli.net/2020/05/01/gkihqEjXxJ5UZ1C.jpg" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Python项目构建工具"/></a><div class="content"><a class="title" href="/2024/08/05/python%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E5%B7%A5%E5%85%B7/" title="Python项目构建工具">Python项目构建工具</a><time datetime="2024-08-05T04:23:41.000Z" title="发表于 2024-08-05 12:23:41">2024-08-05</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/04/js%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86/" title="Js异步处理"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tse3-mm.cn.bing.net/th/id/OIP-C.kicojpcD6RPFCjEsEmD8ugHaHa?w=180&amp;h=180&amp;c=7&amp;r=0&amp;o=5&amp;dpr=1.3&amp;pid=1.7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="Js异步处理"/></a><div class="content"><a class="title" href="/2024/08/04/js%E5%BC%82%E6%AD%A5%E5%A4%84%E7%90%86/" title="Js异步处理">Js异步处理</a><time datetime="2024-08-04T15:21:25.000Z" title="发表于 2024-08-04 23:21:25">2024-08-04</time></div></div><div class="aside-list-item"><a class="thumbnail" href="/2024/08/04/%E6%89%8B%E5%86%99promise/" title="手写Promise"><img src= "data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7" data-lazy-src="https://tse3-mm.cn.bing.net/th/id/OIP-C.kicojpcD6RPFCjEsEmD8ugHaHa?w=180&amp;h=180&amp;c=7&amp;r=0&amp;o=5&amp;dpr=1.3&amp;pid=1.7" onerror="this.onerror=null;this.src='/img/404.jpg'" alt="手写Promise"/></a><div class="content"><a class="title" href="/2024/08/04/%E6%89%8B%E5%86%99promise/" title="手写Promise">手写Promise</a><time datetime="2024-08-03T16:59:04.000Z" title="发表于 2024-08-04 00:59:04">2024-08-04</time></div></div></div></div></div></div></main><footer id="footer" style="background-image: url('https://tse2-mm.cn.bing.net/th/id/OIP-C.dSMliGMR1gP-nfkwknp26QHaDt?w=314&amp;h=175&amp;c=7&amp;r=0&amp;o=5&amp;dpr=1.3&amp;pid=1.7')"><div id="footer-wrap"><div class="copyright">&copy;2022 - 2024 By fafafa</div></div></footer></div><div id="rightside"><div id="rightside-config-hide"><button id="readmode" type="button" title="阅读模式"><i class="fas fa-book-open"></i></button><button id="darkmode" type="button" title="浅色和深色模式转换"><i class="fas fa-adjust"></i></button><button id="hide-aside-btn" type="button" title="单栏和双栏切换"><i class="fas fa-arrows-alt-h"></i></button></div><div id="rightside-config-show"><button id="rightside-config" type="button" title="设置"><i class="fas fa-cog fa-spin"></i></button><button class="close" id="mobile-toc-button" type="button" title="目录"><i class="fas fa-list-ul"></i></button><button id="go-up" type="button" title="回到顶部"><span class="scroll-percent"></span><i class="fas fa-arrow-up"></i></button></div></div><div><script src="/js/utils.js?v=4.14.0-b3"></script><script src="/js/main.js?v=4.14.0-b3"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/ui@5.0.35/dist/fancybox/fancybox.umd.min.js"></script><script src="https://cdn.jsdelivr.net/npm/instant.page@5.2.0/instantpage.min.js" type="module"></script><script src="https://cdn.jsdelivr.net/npm/vanilla-lazyload@19.0.5/dist/lazyload.iife.min.js"></script><script>(() => {
  const panguFn = () => {
    if (typeof pangu === 'object') pangu.autoSpacingPage()
    else {
      btf.getScript('https://cdn.jsdelivr.net/npm/pangu@4.0.7/dist/browser/pangu.min.js')
        .then(() => {
          pangu.autoSpacingPage()
        })
    }
  }

  const panguInit = () => {
    if (false){
      GLOBAL_CONFIG_SITE.isPost && panguFn()
    } else {
      panguFn()
    }
  }

  btf.addGlobalFn('pjaxComplete', panguInit, 'pangu')
  document.addEventListener('DOMContentLoaded', panguInit)
})()</script><div class="js-pjax"><script>(() => {
  const runMermaid = (ele) => {
    window.loadMermaid = true
    const theme = document.documentElement.getAttribute('data-theme') === 'dark' ? 'dark' : 'default'

    Array.from(ele).forEach((item, index) => {
      const mermaidSrc = item.firstElementChild
      const mermaidThemeConfig = '%%{init:{ \'theme\':\'' + theme + '\'}}%%\n'
      const mermaidID = 'mermaid-' + index
      const mermaidDefinition = mermaidThemeConfig + mermaidSrc.textContent

      const renderFn = mermaid.render(mermaidID, mermaidDefinition)

      const renderV10 = () => {
        renderFn.then(({svg}) => {
          mermaidSrc.insertAdjacentHTML('afterend', svg)
        })
      }

      const renderV9 = svg => {
        mermaidSrc.insertAdjacentHTML('afterend', svg)
      }

      typeof renderFn === 'string' ? renderV9(renderFn) : renderV10()
    })
  }

  const codeToMermaid = () => {
    const codeMermaidEle = document.querySelectorAll('pre > code.mermaid')
    if (codeMermaidEle.length === 0) return
    
    codeMermaidEle.forEach(ele => {
      const newEle = document.createElement('div')
      newEle.className = 'mermaid-wrap'
      newEle.innerHTML = `<pre class="mermaid-src" hidden>${ele.textContent}</pre>`
      ele.parentNode.replaceWith(newEle)
    })
  }

  const loadMermaid = () => {
    if (false) codeToMermaid()
    const $mermaid = document.querySelectorAll('#article-container .mermaid-wrap')
    if ($mermaid.length === 0) return

    const runMermaidFn = () => runMermaid($mermaid)
    btf.addGlobalFn('themeChange', runMermaidFn, 'mermaid')
    window.loadMermaid ? runMermaidFn() : btf.getScript('https://cdn.jsdelivr.net/npm/mermaid@10.9.0/dist/mermaid.min.js').then(runMermaidFn)
  }
  
  btf.addGlobalFn('encrypt', loadMermaid, 'mermaid')
  window.pjax ? loadMermaid() : document.addEventListener('DOMContentLoaded', loadMermaid)
})()</script></div><script src="https://cdn.jsdelivr.net/npm/butterfly-extsrc@1.1.3/dist/activate-power-mode.min.js"></script><script>POWERMODE.colorful = true;
POWERMODE.shake = true;
POWERMODE.mobile = false;
document.body.addEventListener('input', POWERMODE);
</script><script async data-pjax src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><div id="local-search"><div class="search-dialog"><nav class="search-nav"><span class="search-dialog-title">搜索</span><span id="loading-status"></span><button class="search-close-button"><i class="fas fa-times"></i></button></nav><div class="is-center" id="loading-database"><i class="fas fa-spinner fa-pulse"></i><span>  数据库加载中</span></div><div class="search-wrap"><div id="local-search-input"><div class="local-search-box"><input class="local-search-box--input" placeholder="搜索文章" type="text"/></div></div><hr/><div id="local-search-results"></div><div id="local-search-stats-wrap"></div></div></div><div id="search-mask"></div><script src="/js/search/local-search.js?v=4.14.0-b3"></script></div></div></body></html>